# ************************************************************************************************
# Warning: YAML source code for Canvas Apps is in preview. The schema is being actively developed.
# Content may be incomplete and subject to change.
# This file is read-only and should only be used to review changes made within Power Apps Studio.
# This file isn't used when loading the app. External editing, merging and conflict resolution are
# not supported.
# 
# For more information, visit https://go.microsoft.com/fwlink/?linkid=2292623
# ************************************************************************************************
Screens:
  Nhapdieukien:
    Properties:
      LoadingSpinnerColor: =RGBA(56, 96, 178, 1)
      OnVisible: "=Set(varXoaSP, false);\nSet(varXoaKB, false);\nSet(varXoaKH, false);\nSet(varXoaPV, false);\n\nSelect(Icon2_1);\nClearCollect(\n    tmpApdungKH,\n    GroupBy(\n        Filter(\n            DL_DIEUKIEN_APDUNG_LOAI_CT,\n            MA_DIEU_KIEN = varMaDKien && THANH_PHAN = \"KH\" && AP_DUNG = \"1\"\n        ),\n        ID,\n        MA_DIEU_KIEN,\n        THANH_PHAN,\n        AP_DUNG,\n        MA_TIEU_CHI,\n        TEN_TIEU_CHI,\n        group_apdung_kh\n    )\n);\nClearCollect(\n    tmpLoaitruKH,\n    GroupBy(\n        Filter(\n            DL_DIEUKIEN_APDUNG_LOAI_CT,\n            MA_DIEU_KIEN = varMaDKien && THANH_PHAN = \"KH\" && AP_DUNG = \"2\"\n        ),\n        ID,\n        MA_DIEU_KIEN,\n        THANH_PHAN,\n        AP_DUNG,\n        MA_TIEU_CHI,\n        TEN_TIEU_CHI,\n        group_loaitru_kh\n    )\n);\nClearCollect(\n    tmpApdungPV,\n    GroupBy(\n        Filter(\n            DL_DIEUKIEN_APDUNG_LOAI_CT,\n            MA_DIEU_KIEN = varMaDKien && THANH_PHAN = \"PV\" && AP_DUNG = \"1\"\n        ),\n        ID,\n        MA_DIEU_KIEN,\n        THANH_PHAN,\n        AP_DUNG,\n        MA_TIEU_CHI,\n        TEN_TIEU_CHI,\n        group_apdung_pv\n    )\n);\nClearCollect(\n    tmpLoaitruPV,\n    GroupBy(\n        Filter(\n            DL_DIEUKIEN_APDUNG_LOAI_CT,\n            MA_DIEU_KIEN = varMaDKien && THANH_PHAN = \"PV\" && AP_DUNG = \"2\"\n        ),\n        ID,\n        MA_DIEU_KIEN,\n        THANH_PHAN,\n        AP_DUNG,\n        MA_TIEU_CHI,\n        TEN_TIEU_CHI,\n        group_loaitru_pv\n    )\n);\nClearCollect(\n    tmpDsGiatri,\n    [\n        {\n            Ma: \"\",\n            Ten: \"\",\n            Loai: \"\",\n            cr282_ten_gia_tri: \"\"\n        }\n    ]\n);\n// them chi tieu Nhom khach hang\nForAll(\n    DM_NHOM_KH As kh,\n    Patch(\n        tmpDsGiatri,\n        Defaults(tmpDsGiatri),\n        {\n            Ma: kh.MA_NHOM_KH,\n            Ten: kh.TEN_NHOM_KH,\n            Loai: \"MA_KH_NHOM\",\n            cr282_ten_gia_tri: kh.TEN_NHOM_KH\n        }\n    )\n);\n// them chi tieu LOAI khach hang\nCollect(\n    tmpDsGiatri,\n    {\n        Ma: \"0\",\n        Ten: \"Cá nhân\",\n        Loai: \"MA_KH_LOAI\",\n        cr282_ten_gia_tri: \"Cá nhân\"\n    },\n    {\n        Ma: \"1\",\n        Ten: \"Tổ chức\",\n        Loai: \"MA_KH_LOAI\",\n        cr282_ten_gia_tri: \"Tổ chức\"\n    }\n);\nForAll(\n    DM_KHACH_HANG As kh,\n    Patch(\n        tmpDsGiatri,\n        Defaults(tmpDsGiatri),\n        {\n            Ma: kh.MA_KHACH_HANG,\n            Ten: kh.TEN_KHACH_HANG,\n            Loai: \"MA_KH\",\n            cr282_ten_gia_tri: kh.TEN_KHACH_HANG\n        }\n    )\n);\n// them chi tieu Pham vi\nForAll(\n    DM_PHAMVI_DIALYS As pv,\n    Patch(\n        tmpDsGiatri,\n        Defaults(tmpDsGiatri),\n        {\n            Ma: pv.MA_PHAMVI,\n            Ten: pv.TEN_PHAMVI,\n            Loai: If(\n                pv.LOAI = \"KHU_VUC\",\n                \"MA_KHU_VUC\",\n                If(\n                    pv.LOAI = \"QUOC_GIA\",\n                    \"MA_QG\",\n                    If(\n                        pv.LOAI = \"VUNG_MIEN\",\n                        \"MA_VUNG_MIEN\",\n                        If(\n                            pv.LOAI = \"TINH_TP\",\n                            \"MA_TINH_TP\",\n                            If(\n                                pv.LOAI = \"QUAN_HUYEN\",\n                                \"MA_QUAN_HUYEN\",\n                                If(\n                                    pv.LOAI = \"DON_VI\",\n                                    \"MA_DON_VI\",\n                                    \"KHAC\"\n                                )\n                            )\n                        )\n                    )\n                )\n            ),\n            cr282_ten_gia_tri: pv.TEN_PHAMVI\n        }\n    )\n);\n// T.ANH xử lý sản phẩm\nIf(\n    CountRows(\n        Filter(\n            DL_DIEUKIEN_APDUNG_LOAI_CT,\n            MA_DIEU_KIEN = varMaDKien && THANH_PHAN = \"SP\" && AP_DUNG = \"1\" && KIEU = \"2\"\n        )\n    ) > 0,\n    ClearCollect(\n        tmpApdungSp,\n        GroupBy(\n            Filter(\n                DL_DIEUKIEN_APDUNG_LOAI_CT,\n                MA_DIEU_KIEN = varMaDKien && THANH_PHAN = \"SP\" && AP_DUNG = \"1\" && KIEU = \"2\"\n            ),\n            ID,\n            MA_DIEU_KIEN,\n            AP_DUNG,\n            MA_TIEU_CHI,\n            KIEU,\n            THANH_PHAN,\n            MA_PV_AD,\n            group\n        )\n    );\n    \n);\nIf(\n    CountRows(\n        Filter(\n            DL_DIEUKIEN_APDUNG_LOAI_CT,\n            MA_DIEU_KIEN = varMaDKien && THANH_PHAN = \"SP\" && AP_DUNG = \"2\" && KIEU = \"2\"\n        )\n    ) > 0,\n    ClearCollect(\n        tmpLoaitruSp,\n        GroupBy(\n            Filter(\n                DL_DIEUKIEN_APDUNG_LOAI_CT,\n                MA_DIEU_KIEN = varMaDKien && THANH_PHAN = \"SP\" && AP_DUNG = \"2\" && KIEU = \"2\"\n            ),\n            ID,\n            MA_DIEU_KIEN,\n            AP_DUNG,\n            MA_TIEU_CHI,\n            KIEU,\n            THANH_PHAN,\n            MA_PV_AD,\n            group\n        )\n    )\n);\n// them san pham\nForAll(\n    DL_SAN_PHAM As sp,\n    Patch(\n        tmpDsGiatri,\n        Defaults(tmpDsGiatri),\n        {\n            Ma: sp.MA_SAN_PHAM,\n            Loai: \"MA_SP\",\n            cr282_ten_gia_tri: sp.TEN_SAN_PHAM\n        }\n    )\n);\n// them combo san pham\nForAll(\n    DL_SAN_PHAM As sp,\n    Patch(\n        tmpDsGiatri,\n        Defaults(tmpDsGiatri),\n        {\n            Ma: sp.MA_SAN_PHAM,\n            Loai: \"MA_COMBO_SP\",\n            cr282_ten_gia_tri: sp.TEN_SAN_PHAM\n        }\n    )\n);\nPatch(\n    tmpDsGiatri,\n    Defaults(tmpDsGiatri),\n    {\n        Ma: \"Sức khoẻ\",\n        Loai: \"LHNV\",\n        cr282_ten_gia_tri: \"Sức khoẻ\"\n    }\n);\nPatch(\n    tmpDsGiatri,\n    Defaults(tmpDsGiatri),\n    {\n        Ma: \"Tai nạn\",\n        Loai: \"LHNV\",\n        cr282_ten_gia_tri: \"Tai nạn\"\n    }\n);\nPatch(\n    tmpDsGiatri,\n    Defaults(tmpDsGiatri),\n    {\n        Ma: \"Trách nhiệm dân sự\",\n        Loai: \"LHNV\",\n        cr282_ten_gia_tri: \"Trách nhiệm dân sự\"\n    }\n);\n// them chuong trinh\nForAll(\n    ' DL_SAN_PHAM_CT' As sp,\n    Patch(\n        tmpDsGiatri,\n        Defaults(tmpDsGiatri),\n        {\n            Ma: sp.MA_CHUONG_TRINH,\n            Loai: \"MA_CT\",\n            cr282_ten_gia_tri: Concatenate(sp.MA_CHUONG_TRINH,\" - \",sp.TEN_CHUONG_TRINH) \n        }\n    )\n);\n//Kenh ban\nClearCollect(\n    tmpApdungKB,\n    GroupBy(\n        Filter(\n            DL_DIEUKIEN_APDUNG_LOAI_CT,\n            MA_DIEU_KIEN = varMaDKien && THANH_PHAN = \"KB\" && AP_DUNG = \"1\"\n        ),\n        ID,\n        MA_DIEU_KIEN,\n        THANH_PHAN,\n        AP_DUNG,\n        MA_TIEU_CHI,\n        TEN_TIEU_CHI,\n        group_apdung_kb\n    )\n);\nClearCollect(\n    tmpLoaitruKB,\n    GroupBy(\n        Filter(\n            DL_DIEUKIEN_APDUNG_LOAI_CT,\n            MA_DIEU_KIEN = varMaDKien && THANH_PHAN = \"KB\" && AP_DUNG = \"2\"\n        ),\n        ID,\n        MA_DIEU_KIEN,\n        THANH_PHAN,\n        AP_DUNG,\n        MA_TIEU_CHI,\n        TEN_TIEU_CHI,\n        group_loaitru_kb\n    )\n);\n// them kenh ban\nForAll(\n    DM_KENH_BANS As kb,\n    Patch(\n        tmpDsGiatri,\n        Defaults(tmpDsGiatri),\n        {\n            Ma: kb.MA_KENH_BAN,\n            Ten: kb.TEN_KENH_BAN,\n            Loai: \"MA_KB_DM\",\n            cr282_ten_gia_tri: kb.TEN_KENH_BAN\n        }\n    )\n);\nForAll(\n    DM_LOAI_KENH_BANS As kb,\n    Patch(\n        tmpDsGiatri,\n        Defaults(tmpDsGiatri),\n        {\n            Ma: kb.MA_LOAI_KB,\n            Ten: kb.TEN_LOAI_KB,\n            Loai: \"MA_KB_LOAI\",\n            cr282_ten_gia_tri: kb.TEN_LOAI_KB\n        }\n    )\n);\nCollect(\n    tmpDsGiatri,\n    {\n        Ma: \"0\",\n        Ten: \"Cá nhân\",\n        Loai: \"MA_KB_NHOM\",\n        cr282_ten_gia_tri: \"Cá nhân\"\n    },\n    {\n        Ma: \"1\",\n        Ten: \"Tổ chức\",\n        Loai: \"MA_KB_NHOM\",\n        cr282_ten_gia_tri: \"Tổ chức\"\n    }\n);\n//End Kenh ban\n"
    Children:
      - CanvasDK:
          Control: FluidGrid@2.3.0
          Properties:
            BorderThickness: =0
            Height: =Parent.Height - Self.Y
            Width: =Parent.Width
            Y: =
          Children:
            - DataCardChung:
                Control: DataCard@1.0.2
                Properties:
                  Height: =2291
                  Width: =Parent.Width
                Children:
                  - ContainerChung:
                      Control: GroupContainer@1.3.0
                      Variant: ManualLayout
                      Properties:
                        BorderStyle: =BorderStyle.None
                        Fill: =RGBA(255, 255, 255, 1)
                        Height: =342
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =0
                        RadiusTopLeft: =0
                        RadiusTopRight: =0
                        Width: =Parent.Width-130
                        X: =130
                      Children:
                        - Label1_22:
                            Control: Label@2.5.1
                            Properties:
                              Align: =Align.Justify
                              BorderColor: =RGBA(0, 0, 0, 0)
                              BorderStyle: =BorderStyle.None
                              BorderThickness: =2
                              Color: =RGBA(50, 49, 48, 1)
                              DisabledBorderColor: =RGBA(0, 0, 0, 0)
                              DisabledColor: =RGBA(161, 159, 157, 1)
                              FocusedBorderThickness: =4
                              Font: =Font.'Segoe UI'
                              FontWeight: =FontWeight.Bold
                              Height: =30
                              Size: =11
                              Text: ="1. Thông tin chung"
                              Width: =Parent.Width
                        - FormDKChung:
                            Control: Form@2.4.2
                            Variant: Classic
                            Layout: Horizontal
                            Properties:
                              BorderColor: =RGBA(255, 255, 255, 1)
                              BorderStyle: =BorderStyle.None
                              DataSource: =DL_DIEUKIEN_APDUNG
                              DefaultMode: =FormMode.New
                              Height: =315
                              Item: |-
                                =If(
                                    !VarEditCS,
                                    LookUp(
                                        DL_DIEUKIEN_APDUNG,
                                        MA_DIEU_KIEN = newMaDK
                                    ),
                                    LookUp(
                                        DL_DIEUKIEN_APDUNG,
                                        MA_DIEU_KIEN = varMaDKien
                                    )
                                )
                              Width: =Parent.Width
                              Y: =27
                            Children:
                              - MA_DIEU_KIEN_DataCard1:
                                  Control: TypedDataCard@1.0.6
                                  Variant: ClassicTextualEdit
                                  Properties:
                                    BorderColor: =RGBA(245, 245, 245, 1)
                                    DataField: ="cr282_ma_dieu_kien"
                                    Default: =ThisItem.MA_DIEU_KIEN
                                    DisplayName: =DataSourceInfo([@DL_DIEUKIEN_APDUNG],DataSourceInfo.DisplayName,cr282_ma_dieu_kien)
                                    Height: =60
                                    MaxLength: =DataSourceInfo([@DL_DIEUKIEN_APDUNG], DataSourceInfo.MaxLength, cr282_ma_dieu_kien)
                                    Required: =true
                                    Update: =newMaDK
                                    Width: =618
                                    Y: =0
                                  Children:
                                    - DataCardKey2_1:
                                        Control: Label@2.5.1
                                        Properties:
                                          AutoHeight: =true
                                          BorderColor: =RGBA(0, 0, 0, 0)
                                          BorderStyle: =BorderStyle.None
                                          BorderThickness: =2
                                          Color: =RGBA(50, 49, 48, 1)
                                          DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                          DisabledColor: =RGBA(161, 159, 157, 1)
                                          FocusedBorderThickness: =4
                                          Font: =Font.'Open Sans'
                                          FontWeight: =FontWeight.Semibold
                                          Height: =34
                                          PaddingLeft: =0
                                          Size: =11
                                          Text: ="Mã điều kiện"
                                          Width: =(Parent.Width - 60) * 0.4
                                          Wrap: =false
                                          X: =30
                                          Y: =10 + (DataCardValueMaDK.Height / 2) - (Self.Height / 2)
                                    - DataCardValueMaDK:
                                        Control: Classic/TextInput@2.3.2
                                        Properties:
                                          BorderColor: =RGBA(45, 128, 40, 1)
                                          Color: =RGBA(50, 49, 48, 1)
                                          Default: =Parent.Default
                                          DelayOutput: =true
                                          DisabledBorderColor: =RGBA(180, 214, 250, 1)
                                          DisabledColor: =RGBA(161, 159, 157, 1)
                                          DisabledFill: =RGBA(214, 221, 224, 1)
                                          DisplayMode: =DisplayMode.Disabled
                                          Font: =Font.'Open Sans'
                                          HintText: ="Hệ thống tự sinh"
                                          HoverBorderColor: =RGBA(9, 33, 98, 1)
                                          HoverColor: =RGBA(50, 49, 48, 1)
                                          HoverFill: =RGBA(255, 255, 255, 1)
                                          MaxLength: =Parent.MaxLength
                                          PaddingLeft: =5
                                          PressedBorderColor: =RGBA(127, 178, 57, 1)
                                          PressedColor: =RGBA(50, 49, 48, 1)
                                          PressedFill: =RGBA(255, 255, 255, 1)
                                          RadiusBottomLeft: =0
                                          RadiusBottomRight: =0
                                          RadiusTopLeft: =0
                                          RadiusTopRight: =0
                                          Size: =11
                                          Tooltip: =Parent.DisplayName
                                          Width: =(Parent.Width - 60) * 0.6
                                          X: =250
                                          Y: =5
                              - TRANG_THAI_DataCard1_1:
                                  Control: TypedDataCard@1.0.6
                                  Variant: ClassicTextualEdit
                                  Properties:
                                    BorderColor: =RGBA(245, 245, 245, 1)
                                    DataField: ="cr282_trang_thai"
                                    Default: =ThisItem.TRANG_THAI
                                    DisplayName: =DataSourceInfo([@DL_DIEUKIEN_APDUNG],DataSourceInfo.DisplayName,cr282_trang_thai)
                                    MaxLength: =DataSourceInfo([@DL_DIEUKIEN_APDUNG], DataSourceInfo.MaxLength, cr282_trang_thai)
                                    Required: =false
                                    Update: =DataCardValueHoatDong.Value
                                    Width: =618
                                    X: =1
                                    Y: =0
                                  Children:
                                    - DataCardKey11:
                                        Control: Label@2.5.1
                                        Properties:
                                          AutoHeight: =true
                                          BorderColor: =RGBA(0, 0, 0, 0)
                                          BorderStyle: =BorderStyle.None
                                          BorderThickness: =2
                                          Color: =RGBA(50, 49, 48, 1)
                                          DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                          DisabledColor: =RGBA(161, 159, 157, 1)
                                          FocusedBorderThickness: =4
                                          Font: =Font.'Open Sans'
                                          FontWeight: =FontWeight.Semibold
                                          Height: =34
                                          PaddingLeft: =0
                                          Size: =11
                                          Text: ="Hoạt động"
                                          Width: =(Parent.Width - 60) * 0.4
                                          Wrap: =false
                                          X: =30
                                          Y: =10 + (DataCardValueHoatDong.Height / 2) - (Self.Height / 2)
                                    - StarVisible11:
                                        Control: Label@2.5.1
                                        Properties:
                                          Align: =Align.Center
                                          BorderColor: =RGBA(0, 0, 0, 0)
                                          BorderStyle: =BorderStyle.None
                                          BorderThickness: =2
                                          Color: =RGBA(50, 49, 48, 1)
                                          DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                          DisabledColor: =RGBA(161, 159, 157, 1)
                                          FocusedBorderThickness: =4
                                          Font: =Font.'Segoe UI'
                                          FontWeight: =FontWeight.Semibold
                                          Height: =DataCardKey11.Height
                                          PaddingLeft: =0
                                          Text: ="*"
                                          Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                                          Width: =30
                                          Wrap: =false
                                          Y: =DataCardKey11.Y
                                    - DataCardValueHoatDong:
                                        Control: Classic/CheckBox@2.1.0
                                        Properties:
                                          BorderColor: =RGBA(9, 33, 98, 1)
                                          BorderStyle: =BorderStyle.None
                                          BorderThickness: =2
                                          CheckboxBorderColor: =RGBA(9, 33, 98, 1)
                                          CheckmarkFill: =RGBA(0, 0, 0, 1)
                                          Color: =RGBA(50, 49, 48, 1)
                                          Default: =Parent.Default
                                          DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                          DisabledColor: =RGBA(161, 159, 157, 1)
                                          Fill: =RGBA(255, 255, 255, 1)
                                          FocusedBorderThickness: =4
                                          Font: =Font.'Open Sans'
                                          Height: =40
                                          HoverBorderColor: =RGBA(0, 0, 0, 0)
                                          HoverColor: =RGBA(50, 49, 48, 1)
                                          HoverFill: =RGBA(0, 0, 0, 0)
                                          PressedBorderColor: =RGBA(0, 0, 0, 0)
                                          PressedColor: =RGBA(50, 49, 48, 1)
                                          PressedFill: =RGBA(0, 0, 0, 0)
                                          Size: =11
                                          Text: =""
                                          Width: =40
                                          X: =253
                                          Y: =10
                              - SO_VB_DataCard1:
                                  Control: TypedDataCard@1.0.6
                                  Variant: ClassicTextualEdit
                                  Properties:
                                    BorderColor: =RGBA(245, 245, 245, 1)
                                    DataField: ="cr282_so_vb"
                                    Default: =ThisItem.SO_VB
                                    DisplayName: =DataSourceInfo([@DL_DIEUKIEN_APDUNG],DataSourceInfo.DisplayName,cr282_so_vb)
                                    MaxLength: =DataSourceInfo([@DL_DIEUKIEN_APDUNG], DataSourceInfo.MaxLength, cr282_so_vb)
                                    Required: =false
                                    Update: =DataCardValueSoVB.Text
                                    Width: =618
                                    Y: =1
                                  Children:
                                    - DataCardKey9_2:
                                        Control: Label@2.5.1
                                        Properties:
                                          AutoHeight: =true
                                          BorderColor: =RGBA(0, 0, 0, 0)
                                          BorderStyle: =BorderStyle.None
                                          BorderThickness: =2
                                          Color: =RGBA(50, 49, 48, 1)
                                          DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                          DisabledColor: =RGBA(161, 159, 157, 1)
                                          FocusedBorderThickness: =4
                                          Font: =Font.'Open Sans'
                                          FontWeight: =FontWeight.Semibold
                                          Height: =34
                                          PaddingLeft: =0
                                          Size: =11
                                          Text: ="Số văn bản"
                                          Width: =(Parent.Width - 60) * 0.4
                                          Wrap: =false
                                          X: =30
                                          Y: =10 + (DataCardValueSoVB.Height / 2) - (Self.Height / 2)
                                    - DataCardValueSoVB:
                                        Control: Classic/TextInput@2.3.2
                                        Properties:
                                          BorderColor: =RGBA(180, 214, 250, 1)
                                          Color: =RGBA(50, 49, 48, 1)
                                          Default: =Parent.Default
                                          DelayOutput: =true
                                          DisabledBorderColor: =RGBA(180, 214, 250, 1)
                                          DisabledColor: =RGBA(161, 159, 157, 1)
                                          DisabledFill: =RGBA(214, 221, 224, 1)
                                          DisplayMode: =If(varDaGhi,DisplayMode.Disabled,DisplayMode.Edit)
                                          Font: =Font.'Open Sans'
                                          HoverBorderColor: =RGBA(9, 33, 98, 1)
                                          HoverColor: =RGBA(50, 49, 48, 1)
                                          HoverFill: =RGBA(255, 255, 255, 1)
                                          MaxLength: =Parent.MaxLength
                                          PaddingLeft: =5
                                          PressedBorderColor: =RGBA(9, 33, 98, 1)
                                          PressedColor: =RGBA(50, 49, 48, 1)
                                          PressedFill: =RGBA(255, 255, 255, 1)
                                          RadiusBottomLeft: =0
                                          RadiusBottomRight: =0
                                          RadiusTopLeft: =0
                                          RadiusTopRight: =0
                                          Size: =11
                                          Tooltip: =Parent.DisplayName
                                          Width: =(Parent.Width - 60) * 0.6
                                          X: =DataCardKey9_2.X + DataCardKey9_2.Width
                                          Y: =10
                                    - StarVisible9_2:
                                        Control: Label@2.5.1
                                        Properties:
                                          Align: =Align.Center
                                          BorderColor: =RGBA(0, 0, 0, 0)
                                          BorderStyle: =BorderStyle.None
                                          BorderThickness: =2
                                          Color: =RGBA(50, 49, 48, 1)
                                          DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                          DisabledColor: =RGBA(161, 159, 157, 1)
                                          FocusedBorderThickness: =4
                                          Font: =Font.'Segoe UI'
                                          FontWeight: =FontWeight.Semibold
                                          Height: =DataCardKey9_2.Height
                                          PaddingLeft: =0
                                          Text: ="*"
                                          Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                                          Width: =30
                                          Wrap: =false
                                          Y: =DataCardKey9_2.Y
                              - NGAY_VB_DataCard1:
                                  Control: TypedDataCard@1.0.6
                                  Variant: ClassicDateTimeEdit
                                  Properties:
                                    BorderColor: =RGBA(0, 0, 0, 1)
                                    DataField: ="cr282_ngay_vb"
                                    Default: =ThisItem.NGAY_VB
                                    DisplayName: =DataSourceInfo([@DL_DIEUKIEN_APDUNG],DataSourceInfo.DisplayName,cr282_ngay_vb)
                                    Required: =false
                                    Update: =If(Not IsBlank(DateValueVB.SelectedDate), DateValueVB.SelectedDate, Blank())
                                    Width: =618
                                    X: =1
                                    Y: =1
                                  Children:
                                    - DataCardKey10_1:
                                        Control: Label@2.5.1
                                        Properties:
                                          AutoHeight: =true
                                          BorderColor: =RGBA(0, 0, 0, 0)
                                          BorderStyle: =BorderStyle.None
                                          BorderThickness: =2
                                          Color: =RGBA(50, 49, 48, 1)
                                          DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                          DisabledColor: =RGBA(161, 159, 157, 1)
                                          FocusedBorderThickness: =4
                                          Font: =Font.'Open Sans'
                                          FontWeight: =FontWeight.Semibold
                                          Height: =34
                                          PaddingLeft: =0
                                          Size: =11
                                          Text: ="Ngày văn bản"
                                          Width: =(Parent.Width - 60) * 0.4
                                          Wrap: =false
                                          X: =30
                                          Y: =10
                                    - DateValueVB:
                                        Control: Classic/DatePicker@2.6.0
                                        Properties:
                                          BorderColor: =RGBA(180, 214, 250, 1)
                                          Color: =RGBA(50, 49, 48, 1)
                                          DefaultDate: =Parent.Default
                                          DisabledBorderColor: =RGBA(180, 214, 250, 1)
                                          DisabledColor: =RGBA(161, 159, 157, 1)
                                          DisabledFill: =RGBA(214, 221, 224, 1)
                                          DisplayMode: =If(varDaGhi,DisplayMode.Disabled,DisplayMode.Edit)
                                          EndYear: =Year(Today())+100
                                          Font: =Font.'Open Sans'
                                          Format: ="dd/mm/yyyy"
                                          IconBackground: =RGBA(56, 96, 178, 1)
                                          IconFill: =RGBA(255, 255, 255, 1)
                                          InputTextPlaceholder: =
                                          IsEditable: =true
                                          PaddingBottom: =0
                                          PaddingLeft: =If(Self.DisplayMode = DisplayMode.Edit, 5, 0)
                                          Size: =11
                                          StartYear: =1899
                                          Tooltip: =Parent.DisplayName
                                          Width: =(Parent.Width - 60) * 0.6
                                          X: =253
                                          Y: =10
                                    - StarVisible10_1:
                                        Control: Label@2.5.1
                                        Properties:
                                          Align: =Align.Center
                                          BorderColor: =RGBA(0, 0, 0, 0)
                                          BorderStyle: =BorderStyle.None
                                          BorderThickness: =2
                                          Color: =RGBA(50, 49, 48, 1)
                                          DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                          DisabledColor: =RGBA(161, 159, 157, 1)
                                          FocusedBorderThickness: =4
                                          Font: =Font.'Segoe UI'
                                          FontWeight: =FontWeight.Semibold
                                          Height: =DataCardKey10_1.Height
                                          PaddingLeft: =0
                                          Text: ="*"
                                          Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                                          Width: =30
                                          Wrap: =false
                                          Y: =DataCardKey10_1.Y
                              - HIEU_LUC_TU_DataCard1:
                                  Control: TypedDataCard@1.0.6
                                  Variant: ClassicDateTimeEdit
                                  Properties:
                                    BorderColor: =RGBA(245, 245, 245, 1)
                                    DataField: ="cr282_hieu_luc_tu"
                                    Default: =ThisItem.HIEU_LUC_TU
                                    DisplayName: =DataSourceInfo([@DL_DIEUKIEN_APDUNG],DataSourceInfo.DisplayName,cr282_hieu_luc_tu)
                                    Required: =false
                                    Update: =If(Not IsBlank(DateValueTU.SelectedDate), DateValueTU.SelectedDate)
                                    Width: =618
                                    Y: =2
                                  Children:
                                    - DataCardKey14:
                                        Control: Label@2.5.1
                                        Properties:
                                          AutoHeight: =true
                                          BorderColor: =RGBA(0, 0, 0, 0)
                                          BorderStyle: =BorderStyle.None
                                          BorderThickness: =2
                                          Color: =RGBA(50, 49, 48, 1)
                                          DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                          DisabledColor: =RGBA(161, 159, 157, 1)
                                          FocusedBorderThickness: =4
                                          Font: =Font.'Open Sans'
                                          FontWeight: =FontWeight.Semibold
                                          Height: =34
                                          PaddingLeft: =0
                                          Size: =11
                                          Text: ="Hiệu lực từ (*)"
                                          Width: =(Parent.Width - 60) * 0.4
                                          Wrap: =false
                                          X: =30
                                          Y: =10
                                    - DateValueTU:
                                        Control: Classic/DatePicker@2.6.0
                                        Properties:
                                          BorderColor: =RGBA(180, 214, 250, 1)
                                          Color: =RGBA(50, 49, 48, 1)
                                          DefaultDate: =Parent.Default
                                          DisabledBorderColor: =RGBA(180, 214, 250, 1)
                                          DisabledColor: =RGBA(161, 159, 157, 1)
                                          DisabledFill: =RGBA(214, 221, 224, 1)
                                          DisplayMode: =If(varDaGhi,DisplayMode.Disabled,DisplayMode.Edit)
                                          EndYear: =Year(Today())+100
                                          Font: =Font.'Open Sans'
                                          Format: ="dd/mm/yyyy"
                                          IconBackground: =RGBA(56, 96, 178, 1)
                                          IconFill: =RGBA(255, 255, 255, 1)
                                          InputTextPlaceholder: =
                                          IsEditable: =true
                                          PaddingBottom: =0
                                          PaddingLeft: =If(Self.DisplayMode = DisplayMode.Edit, 5, 0)
                                          Size: =11
                                          StartYear: =1899
                                          Tooltip: =Parent.DisplayName
                                          Width: =(Parent.Width - 60) * 0.6
                                          X: =DataCardKey14.X + DataCardKey14.Width
                                          Y: =10
                                    - StarVisible14:
                                        Control: Label@2.5.1
                                        Properties:
                                          Align: =Align.Center
                                          BorderColor: =RGBA(0, 0, 0, 0)
                                          BorderStyle: =BorderStyle.None
                                          BorderThickness: =2
                                          Color: =RGBA(50, 49, 48, 1)
                                          DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                          DisabledColor: =RGBA(161, 159, 157, 1)
                                          FocusedBorderThickness: =4
                                          Font: =Font.'Segoe UI'
                                          FontWeight: =FontWeight.Semibold
                                          Height: =DataCardKey14.Height
                                          PaddingLeft: =0
                                          Text: ="*"
                                          Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                                          Width: =30
                                          Wrap: =false
                                          Y: =DataCardKey14.Y
                              - HIEU_LUC_DEN_DataCard1:
                                  Control: TypedDataCard@1.0.6
                                  Variant: ClassicDateTimeEdit
                                  Properties:
                                    BorderColor: =RGBA(245, 245, 245, 1)
                                    DataField: ="cr282_hieu_luc_den"
                                    Default: =ThisItem.HIEU_LUC_DEN
                                    DisplayName: =DataSourceInfo([@DL_DIEUKIEN_APDUNG],DataSourceInfo.DisplayName,cr282_hieu_luc_den)
                                    Height: =60
                                    Required: =false
                                    Update: =If(Not IsBlank(DateValueDen.SelectedDate), DateValueDen.SelectedDate,Blank())
                                    Width: =618
                                    X: =1
                                    Y: =2
                                  Children:
                                    - DataCardKey17:
                                        Control: Label@2.5.1
                                        Properties:
                                          AutoHeight: =true
                                          BorderColor: =RGBA(0, 0, 0, 0)
                                          BorderStyle: =BorderStyle.None
                                          BorderThickness: =2
                                          Color: =RGBA(50, 49, 48, 1)
                                          DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                          DisabledColor: =RGBA(161, 159, 157, 1)
                                          FocusedBorderThickness: =4
                                          Font: =Font.'Open Sans'
                                          FontWeight: =FontWeight.Semibold
                                          Height: =34
                                          PaddingLeft: =0
                                          Size: =11
                                          Text: ="Hiệu lực đến"
                                          Width: =(Parent.Width - 60) * 0.4
                                          Wrap: =false
                                          X: =30
                                          Y: =10
                                    - DateValueDen:
                                        Control: Classic/DatePicker@2.6.0
                                        Properties:
                                          BorderColor: =RGBA(180, 214, 250, 1)
                                          Color: =RGBA(50, 49, 48, 1)
                                          DefaultDate: =Parent.Default
                                          DisabledBorderColor: =RGBA(180, 214, 250, 1)
                                          DisabledColor: =RGBA(161, 159, 157, 1)
                                          DisabledFill: =RGBA(214, 221, 224, 1)
                                          DisplayMode: =If(varDaGhi,DisplayMode.Disabled,DisplayMode.Edit)
                                          EndYear: =Year(Today())+100
                                          Font: =Font.'Open Sans'
                                          Format: ="dd/mm/yyyy"
                                          IconBackground: =RGBA(56, 96, 178, 1)
                                          IconFill: =RGBA(255, 255, 255, 1)
                                          InputTextPlaceholder: =
                                          IsEditable: =true
                                          PaddingBottom: =0
                                          PaddingLeft: =If(Self.DisplayMode = DisplayMode.Edit, 5, 0)
                                          Size: =11
                                          StartYear: =1899
                                          Tooltip: =Parent.DisplayName
                                          Width: =(Parent.Width - 60) * 0.6
                                          X: =DataCardKey17.X + DataCardKey17.Width
                                          Y: =10
                                    - StarVisible17:
                                        Control: Label@2.5.1
                                        Properties:
                                          Align: =Align.Center
                                          BorderColor: =RGBA(0, 0, 0, 0)
                                          BorderStyle: =BorderStyle.None
                                          BorderThickness: =2
                                          Color: =RGBA(50, 49, 48, 1)
                                          DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                          DisabledColor: =RGBA(161, 159, 157, 1)
                                          FocusedBorderThickness: =4
                                          Font: =Font.'Segoe UI'
                                          FontWeight: =FontWeight.Semibold
                                          Height: =DataCardKey17.Height
                                          PaddingLeft: =0
                                          Text: ="*"
                                          Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                                          Width: =30
                                          Wrap: =false
                                          Y: =DataCardKey17.Y
                              - FILE_DataCard1:
                                  Control: TypedDataCard@1.0.6
                                  Variant: ClassicFileEdit
                                  Properties:
                                    BorderColor: =RGBA(245, 245, 245, 1)
                                    DataField: ="cr282_file"
                                    Default: |-
                                      =If(!IsBlank(ThisItem.FILE.FileName), Table({DisplayName: ThisItem.FILE.FileName, Value: ThisItem.FILE.Value}), Blank())
                                    DisplayName: =DataSourceInfo([@DL_DIEUKIEN_APDUNG],DataSourceInfo.DisplayName,cr282_file)
                                    Height: =120
                                    Required: =false
                                    Update: =DataCardValueFile.Attachments
                                    Width: =618
                                    Y: =3
                                  Children:
                                    - DataCardKey6_2:
                                        Control: Label@2.5.1
                                        Properties:
                                          AutoHeight: =true
                                          BorderColor: =RGBA(0, 0, 0, 0)
                                          BorderStyle: =BorderStyle.None
                                          BorderThickness: =2
                                          Color: =RGBA(50, 49, 48, 1)
                                          DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                          DisabledColor: =RGBA(161, 159, 157, 1)
                                          FocusedBorderThickness: =4
                                          Font: =Font.'Open Sans'
                                          FontWeight: =FontWeight.Semibold
                                          Height: =34
                                          PaddingLeft: =0
                                          Size: =11
                                          Text: ="Tên file"
                                          Width: =(Parent.Width - 60) * 0.4
                                          Wrap: =false
                                          X: =30
                                          Y: =10
                                    - DataCardValueFile:
                                        Control: Attachments@2.3.0
                                        Properties:
                                          AddAttachmentText: ="Chọn file"
                                          BorderColor: =RGBA(230, 230, 230, 1)
                                          Color: =RGBA(50, 49, 48, 1)
                                          DisabledBorderColor: =RGBA(180, 214, 250, 1)
                                          DisabledColor: =RGBA(161, 159, 157, 1)
                                          DisabledFill: =RGBA(214, 221, 224, 1)
                                          DisplayMode: =If(varDaGhi,DisplayMode.Disabled,DisplayMode.Edit)
                                          Font: =Font.'Open Sans'
                                          Height: =101
                                          HoverColor: =RGBA(50, 49, 48, 1)
                                          HoverFill: =RGBA(245, 245, 245, 1)
                                          ItemColor: =RGBA(0, 0, 0, 1)
                                          ItemFill: =RGBA(0, 120, 212, 1)
                                          ItemHoverColor: =RGBA(50, 49, 48, 1)
                                          ItemHoverFill: =RGBA(245, 245, 245, 1)
                                          ItemSpacing: =12
                                          Items: =Parent.Default
                                          MaxAttachments: =1
                                          MaxAttachmentsText: =""
                                          NoAttachmentsColor: =RGBA(161, 159, 157, 1)
                                          NoAttachmentsText: =""
                                          PaddingBottom: =5
                                          PaddingLeft: =If(Self.DisplayMode = DisplayMode.Edit, 5, 0)
                                          PaddingRight: =5
                                          PaddingTop: =5
                                          PressedColor: =RGBA(255, 255, 255, 1)
                                          PressedFill: =RGBA(0, 120, 212, 1)
                                          Size: =11
                                          Tooltip: =Parent.DisplayName
                                          Width: =(Parent.Width - 60) * 0.6
                                          X: =DataCardKey6_2.X + DataCardKey6_2.Width
                                          Y: =10
                                    - StarVisible6_2:
                                        Control: Label@2.5.1
                                        Properties:
                                          Align: =Align.Center
                                          BorderColor: =RGBA(0, 0, 0, 0)
                                          BorderStyle: =BorderStyle.None
                                          BorderThickness: =2
                                          Color: =RGBA(50, 49, 48, 1)
                                          DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                          DisabledColor: =RGBA(161, 159, 157, 1)
                                          FocusedBorderThickness: =4
                                          Font: =Font.'Segoe UI'
                                          FontWeight: =FontWeight.Semibold
                                          Height: =DataCardKey6_2.Height
                                          PaddingLeft: =0
                                          Text: ="*"
                                          Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                                          Width: =30
                                          Wrap: =false
                                          Y: =DataCardKey6_2.Y
                              - ID_DataCard1:
                                  Control: TypedDataCard@1.0.6
                                  Variant: ClassicNumberEdit
                                  Properties:
                                    BorderColor: =RGBA(245, 245, 245, 1)
                                    DataField: ="cr282_id"
                                    Default: =ThisItem.ID
                                    DisplayName: =DataSourceInfo([@DL_DIEUKIEN_APDUNG],DataSourceInfo.DisplayName,cr282_id)
                                    Fill: =RGBA(0, 0, 0, 1)
                                    Required: =true
                                    Update: =newIDMaDD
                                    Visible: =false
                                    Width: =618
                                    X: =605
                                    Y: =3
                                  Children:
                                    - DataCardKey8_2:
                                        Control: Label@2.5.1
                                        Properties:
                                          AutoHeight: =true
                                          BorderColor: =RGBA(0, 0, 0, 0)
                                          BorderStyle: =BorderStyle.None
                                          BorderThickness: =2
                                          Color: =RGBA(50, 49, 48, 1)
                                          DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                          DisabledColor: =RGBA(161, 159, 157, 1)
                                          FocusedBorderThickness: =4
                                          Font: =Font.'Segoe UI'
                                          FontWeight: =FontWeight.Semibold
                                          Height: =34
                                          PaddingLeft: =0
                                          Text: =Parent.DisplayName
                                          Width: =(Parent.Width - 60) * 0.4
                                          Wrap: =false
                                          X: =30
                                          Y: =10 + (DataCardID.Height / 2) - (Self.Height / 2)
                                    - DataCardID:
                                        Control: Classic/TextInput@2.3.2
                                        Properties:
                                          BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                                          Color: =RGBA(50, 49, 48, 1)
                                          Default: =Parent.Default
                                          DelayOutput: =true
                                          DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                          DisabledColor: =RGBA(161, 159, 157, 1)
                                          DisabledFill: =RGBA(242, 242, 241, 0)
                                          DisplayMode: =Parent.DisplayMode
                                          Font: =Font.'Segoe UI'
                                          Format: =TextFormat.Number
                                          HoverBorderColor: =RGBA(16, 110, 190, 1)
                                          HoverColor: =RGBA(50, 49, 48, 1)
                                          HoverFill: =RGBA(255, 255, 255, 1)
                                          PaddingLeft: =5
                                          PressedBorderColor: =RGBA(0, 120, 212, 1)
                                          PressedColor: =RGBA(50, 49, 48, 1)
                                          PressedFill: =RGBA(255, 255, 255, 1)
                                          RadiusBottomLeft: =0
                                          RadiusBottomRight: =0
                                          RadiusTopLeft: =0
                                          RadiusTopRight: =0
                                          Tooltip: =Parent.DisplayName
                                          Width: =(Parent.Width - 60) * 0.6
                                          X: =DataCardKey8_2.X + DataCardKey8_2.Width
                                          Y: =10
                                    - ErrorMessage8_2:
                                        Control: Label@2.5.1
                                        Properties:
                                          AutoHeight: =true
                                          BorderColor: =RGBA(0, 0, 0, 0)
                                          BorderStyle: =BorderStyle.None
                                          BorderThickness: =2
                                          Color: =RGBA(168, 0, 0, 1)
                                          DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                          DisabledColor: =RGBA(168, 0, 0, 1)
                                          FocusedBorderThickness: =4
                                          Font: =Font.'Segoe UI'
                                          FontWeight: =FontWeight.Semibold
                                          Height: =10
                                          Live: =Live.Assertive
                                          PaddingBottom: =0
                                          PaddingLeft: =0
                                          PaddingRight: =0
                                          PaddingTop: =0
                                          Text: =Parent.Error
                                          Visible: =Parent.DisplayMode=DisplayMode.Edit
                                          Width: =Parent.Width - 60
                                          X: =30
                                          Y: =DataCardID.Y + DataCardID.Height
                  - Container2_3:
                      Control: GroupContainer@1.3.0
                      Variant: ManualLayout
                      Properties:
                        DropShadow: =DropShadow.None
                        Height: =521
                        Width: =Parent.Width-Self.X-14
                        X: =130
                        Y: =1294
                      Children:
                        - Label6_1:
                            Control: Label@2.5.1
                            Properties:
                              BorderColor: =RGBA(0, 18, 107, 1)
                              Font: =Font.'Open Sans'
                              FontWeight: =FontWeight.Bold
                              Height: =46
                              Size: =11
                              Text: ="2.3 Khách hàng"
                              Width: =Parent.Width
                        - RadioKH:
                            Control: Classic/Radio@2.3.0
                            Properties:
                              BorderColor: =RGBA(255, 255, 255, 1)
                              Default: |-
                                =//If(CountRows(Filter(DL_DIEUKIEN_APDUNG_LOAI, MA_DIEU_KIEN =varMaDKien  && THANH_PHAN = "KH" && AP_DUNG = "1")) > 0, LookUp(DL_DIEUKIEN_APDUNG_LOAI, MA_DIEU_KIEN =varMaDKien  && THANH_PHAN = "SP" && AP_DUNG = "1" ).TEN_KIEU, "Tất cả" )
                                If(IsBlank(varMaDKien), "Tất cả",LookUp(DL_DIEUKIEN_APDUNG_LOAI, MA_DIEU_KIEN =varMaDKien  && THANH_PHAN = "KH" && AP_DUNG = "1" ).TEN_KIEU)
                              DisabledBorderColor: =RGBA(255, 255, 255, 1)
                              DisabledFill: =RGBA(255, 255, 255, 1)
                              DisplayMode: =If(varDaGhi,DisplayMode.Disabled,DisplayMode.Edit)
                              Font: =Font.'Open Sans'
                              HoverColor: =RGBA(0, 0, 0, 1)
                              Items: |-
                                =[{Text:"Tất cả", ID: 1 },{Text:"Một phần", ID: 2}]
                              Items.Value: =Text
                              OnSelect: =true
                              RadioBorderColor: =RGBA(0, 84, 148, 1)
                              RadioSelectionFill: =RGBA(0, 0, 0, 1)
                              Size: =11
                              X: =40
                              Y: =76
                        - GalleryKH_1:
                            Control: Gallery@2.15.0
                            Variant: Vertical
                            Properties:
                              BorderColor: =RGBA(180, 214, 250, 1)
                              BorderThickness: =1
                              Height: =156
                              Items: =tmpApdungKH
                              TemplateSize: =46
                              Visible: =If(RadioKH.Selected.ID = 2 , true)
                              Width: =962
                              X: =252
                              Y: =77
                            Children:
                              - DropKH:
                                  Control: Classic/DropDown@2.3.1
                                  Properties:
                                    BorderColor: =RGBA(180, 214, 250, 1)
                                    ChevronBackground: =RGBA(255, 255, 255, 1)
                                    ChevronFill: =RGBA(180, 214, 250, 1)
                                    ChevronHoverBackground: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                                    ChevronHoverFill: =RGBA(255, 255, 255, 1)
                                    Default: =ThisItem.cr282_ten_tieu_chi
                                    DisabledBorderColor: =RGBA(204, 228, 246, 1)
                                    DisabledFill: =RGBA(230, 230, 230, 1)
                                    DisplayMode: =If(varDaGhi,DisplayMode.Disabled,DisplayMode.Edit)
                                    Font: =Font.'Open Sans'
                                    HoverFill: =RGBA(186, 202, 226, 1)
                                    Items: =Filter(DM_TIEU_CHI_APDUNGS, LOAI = "KH")
                                    Items.Value: =cr282_ten_chi_tieu
                                    OnChange: =Reset(ComboBoxGTKH)
                                    OnSelect: =
                                    PressedColor: =RGBA(255, 255, 255, 1)
                                    PressedFill: =RGBA(0, 18, 107, 1)
                                    SelectionColor: =RGBA(255, 255, 255, 1)
                                    SelectionFill: =RGBA(56, 96, 178, 1)
                                    Size: =11
                                    Width: =200
                              - ComboBoxGTKH:
                                  Control: Classic/ComboBox@2.4.0
                                  Properties:
                                    BorderColor: =RGBA(180, 214, 250, 1)
                                    ChevronBackground: =RGBA(255, 255, 255, 1)
                                    ChevronFill: =RGBA(180, 214, 250, 1)
                                    ChevronHoverBackground: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                                    ChevronHoverFill: =RGBA(255, 255, 255, 1)
                                    DefaultSelectedItems: =ThisItem.group_apdung_kh
                                    DisabledBorderColor: =RGBA(204, 228, 246, 1)
                                    DisabledFill: =RGBA(230, 230, 230, 1)
                                    DisplayFields: =["cr282_ten_gia_tri"]
                                    DisplayMode: =If(varDaGhi,DisplayMode.Disabled,DisplayMode.Edit)
                                    Font: =Font.'Open Sans'
                                    HoverFill: =RGBA(186, 202, 226, 1)
                                    IsSearchable: =false
                                    Items: =Filter( tmpDsGiatri, Loai = DropKH.Selected.MA_CHI_TIEU)
                                    OnSelect: =Select(Parent)
                                    PressedColor: =RGBA(255, 255, 255, 1)
                                    PressedFill: =RGBA(0, 18, 107, 1)
                                    SearchFields: =["cr282_ten_gia_tri"]
                                    SelectionColor: =RGBA(255, 255, 255, 1)
                                    SelectionFill: =RGBA(56, 96, 178, 1)
                                    Size: =11
                                    Width: =643
                                    X: =212
                              - Button5_9:
                                  Control: Classic/Button@2.2.0
                                  Properties:
                                    BorderColor: =ColorFade(Self.Fill, -15%)
                                    Color: =RGBA(255, 255, 255, 1)
                                    DisabledBorderColor: =RGBA(166, 166, 166, 1)
                                    DisplayMode: =If(varDaGhi,DisplayMode.Disabled,DisplayMode.Edit)
                                    Fill: =RGBA(56, 96, 178, 1)
                                    Font: =Font.'Open Sans'
                                    Height: =28
                                    HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                                    HoverColor: =RGBA(255, 255, 255, 1)
                                    HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                                    OnSelect: =RemoveIf(tmpApdungKH, cr282_id= ThisItem.cr282_id)
                                    PressedBorderColor: =Self.Fill
                                    PressedColor: =Self.Fill
                                    PressedFill: =Self.Color
                                    Size: =11
                                    Text: ="Xoá"
                                    Width: =73
                                    X: =877
                                    Y: =3
                              - TextInput5:
                                  Control: Classic/TextInput@2.3.2
                                  Properties:
                                    BorderColor: =RGBA(0, 18, 107, 1)
                                    Default: =ThisItem.cr282_id
                                    Font: =Font.'Open Sans'
                                    HoverBorderColor: =RGBA(0, 18, 107, 1)
                                    HoverFill: =RGBA(186, 202, 226, 1)
                                    OnSelect: =Select(Parent)
                                    Visible: =false
                                    X: =246
                                    Y: =6
                        - Label7:
                            Control: Label@2.5.1
                            Properties:
                              BorderColor: =RGBA(0, 18, 107, 1)
                              Font: =Font.'Open Sans'
                              FontWeight: =FontWeight.Bold
                              Size: =11
                              Text: ="Áp dụng"
                              X: =25
                              Y: =36
                        - RadioKH_LoaiTru:
                            Control: Classic/Radio@2.3.0
                            Properties:
                              BorderColor: =RGBA(0, 0, 0, 0)
                              Default: |-
                                =

                                If(IsBlank(varMaDKien) Or varXoaKH, "",LookUp(DL_DIEUKIEN_APDUNG_LOAI, MA_DIEU_KIEN =varMaDKien  && THANH_PHAN = "KH" && AP_DUNG = "2" ).TEN_KIEU
                                )
                              DisplayMode: =If(varDaGhi,DisplayMode.Disabled,DisplayMode.Edit)
                              Font: =Font.'Open Sans'
                              Height: =101
                              HoverColor: =RGBA(0, 0, 0, 1)
                              Items: |-
                                =[{Text:"Một phần", ID: 2}]
                              Items.Value: =Text
                              OnSelect: =true
                              RadioBorderColor: =RGBA(0, 84, 148, 1)
                              RadioSelectionFill: =RGBA(0, 0, 0, 1)
                              Size: =11
                              X: =41
                              Y: =333
                        - GalleryKH_LoaiTru:
                            Control: Gallery@2.15.0
                            Variant: Vertical
                            Properties:
                              BorderColor: =RGBA(180, 214, 250, 1)
                              BorderThickness: =1
                              Height: =156
                              Items: =tmpLoaitruKH
                              TemplateSize: =46
                              Visible: =If(RadioKH_LoaiTru.Selected.ID = 2 , true)
                              Width: =962
                              X: =252
                              Y: =333
                            Children:
                              - DropKH_LoaiTru:
                                  Control: Classic/DropDown@2.3.1
                                  Properties:
                                    BorderColor: =RGBA(180, 214, 250, 1)
                                    ChevronBackground: =RGBA(255, 255, 255, 1)
                                    ChevronFill: =RGBA(180, 214, 250, 1)
                                    ChevronHoverBackground: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                                    ChevronHoverFill: =RGBA(255, 255, 255, 1)
                                    Default: =ThisItem.cr282_ten_tieu_chi
                                    DisabledBorderColor: =RGBA(204, 228, 246, 1)
                                    DisabledFill: =RGBA(230, 230, 230, 1)
                                    DisplayMode: =If(varDaGhi,DisplayMode.Disabled,DisplayMode.Edit)
                                    Font: =Font.'Open Sans'
                                    HoverFill: =RGBA(186, 202, 226, 1)
                                    Items: =Filter(DM_TIEU_CHI_APDUNGS, LOAI = "KH")
                                    Items.Value: =cr282_ten_chi_tieu
                                    OnChange: =Reset(ComboBoxGTKH_LT)
                                    OnSelect: =
                                    PressedColor: =RGBA(255, 255, 255, 1)
                                    PressedFill: =RGBA(0, 18, 107, 1)
                                    SelectionColor: =RGBA(255, 255, 255, 1)
                                    SelectionFill: =RGBA(56, 96, 178, 1)
                                    Size: =11
                                    Width: =200
                              - ComboBoxGTKH_LT:
                                  Control: Classic/ComboBox@2.4.0
                                  Properties:
                                    BorderColor: =RGBA(180, 214, 250, 1)
                                    ChevronBackground: =RGBA(255, 255, 255, 1)
                                    ChevronFill: =RGBA(180, 214, 250, 1)
                                    ChevronHoverBackground: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                                    ChevronHoverFill: =RGBA(255, 255, 255, 1)
                                    DefaultSelectedItems: =ThisItem.group_loaitru_kh
                                    DisabledBorderColor: =RGBA(204, 228, 246, 1)
                                    DisabledFill: =RGBA(230, 230, 230, 1)
                                    DisplayFields: =["cr282_ten_gia_tri"]
                                    DisplayMode: =If(varDaGhi,DisplayMode.Disabled,DisplayMode.Edit)
                                    Font: =Font.'Open Sans'
                                    HoverFill: =RGBA(186, 202, 226, 1)
                                    IsSearchable: =false
                                    Items: =Filter( tmpDsGiatri, Loai = DropKH_LoaiTru.Selected.MA_CHI_TIEU)
                                    OnSelect: =Select(Parent)
                                    PressedColor: =RGBA(255, 255, 255, 1)
                                    PressedFill: =RGBA(0, 18, 107, 1)
                                    SearchFields: =["cr282_ten_gia_tri"]
                                    SelectionColor: =RGBA(255, 255, 255, 1)
                                    SelectionFill: =RGBA(56, 96, 178, 1)
                                    Size: =11
                                    Width: =643
                                    X: =212
                              - Button5_10:
                                  Control: Classic/Button@2.2.0
                                  Properties:
                                    BorderColor: =ColorFade(Self.Fill, -15%)
                                    Color: =RGBA(255, 255, 255, 1)
                                    DisabledBorderColor: =RGBA(166, 166, 166, 1)
                                    DisplayMode: =If(varDaGhi,DisplayMode.Disabled,DisplayMode.Edit)
                                    Fill: =RGBA(56, 96, 178, 1)
                                    Font: =Font.'Open Sans'
                                    Height: =28
                                    HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                                    HoverColor: =RGBA(255, 255, 255, 1)
                                    HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                                    OnSelect: =RemoveIf(tmpLoaitruKH, cr282_id = ThisItem.cr282_id)
                                    PressedBorderColor: =Self.Fill
                                    PressedColor: =Self.Fill
                                    PressedFill: =Self.Color
                                    Size: =11
                                    Text: ="Xoá"
                                    Width: =73
                                    X: =877
                                    Y: =3
                              - TextInput6:
                                  Control: Classic/TextInput@2.3.2
                                  Properties:
                                    BorderColor: =RGBA(0, 18, 107, 1)
                                    Default: =ThisItem.cr282_id
                                    Font: =Font.'Open Sans'
                                    HoverBorderColor: =RGBA(0, 18, 107, 1)
                                    HoverFill: =RGBA(186, 202, 226, 1)
                                    OnSelect: =Select(Parent)
                                    Visible: =false
                                    X: =190
                                    Y: =5
                        - Label7_1:
                            Control: Label@2.5.1
                            Properties:
                              BorderColor: =RGBA(0, 18, 107, 1)
                              Font: =Font.'Open Sans'
                              FontWeight: =FontWeight.Bold
                              Size: =11
                              Text: ="Loại trừ"
                              Width: =69
                              X: =25
                              Y: =293
                        - Button3_1:
                            Control: Classic/Button@2.2.0
                            Properties:
                              BorderColor: =ColorFade(Self.Fill, -15%)
                              Color: =RGBA(255, 255, 255, 1)
                              DisabledBorderColor: =RGBA(166, 166, 166, 1)
                              DisplayMode: =If(varDaGhi,DisplayMode.Disabled,DisplayMode.Edit)
                              Fill: =RGBA(56, 96, 178, 1)
                              Font: =Font.'Open Sans'
                              Height: =25
                              HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                              HoverColor: =RGBA(255, 255, 255, 1)
                              HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                              OnSelect: |-
                                =



                                Collect(
                                    tmpApdungKH,
                                    [{cr282_id:Value( Max (tmpApdungKH, cr282_id) + 1)}]
                                );
                              PressedBorderColor: =Self.Fill
                              PressedColor: =Self.Fill
                              PressedFill: =Self.Color
                              Size: =11
                              Text: ="Thêm mới"
                              Visible: =If(RadioKH.Selected.ID = 2 , true)
                              Width: =91
                              X: =254
                              Y: =11
                        - Button3_2:
                            Control: Classic/Button@2.2.0
                            Properties:
                              BorderColor: =ColorFade(Self.Fill, -15%)
                              Color: =RGBA(255, 255, 255, 1)
                              DisabledBorderColor: =RGBA(166, 166, 166, 1)
                              DisplayMode: =If(varDaGhi,DisplayMode.Disabled,DisplayMode.Edit)
                              Fill: =RGBA(56, 96, 178, 1)
                              Font: =Font.'Open Sans'
                              Height: =25
                              HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                              HoverColor: =RGBA(255, 255, 255, 1)
                              HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                              OnSelect: |-
                                =

                                Collect(
                                    tmpLoaitruKH,
                                    [{cr282_id:Value( Max (tmpLoaitruKH, cr282_id) + 1)}]
                                );
                              PressedBorderColor: =Self.Fill
                              PressedColor: =Self.Fill
                              PressedFill: =Self.Color
                              Size: =11
                              Text: ="Thêm mới"
                              Visible: =If(RadioKH_LoaiTru.Selected.ID = 2 , true)
                              Width: =91
                              X: =252
                              Y: =263
                        - BadgeCanvas1_41:
                            Control: Badge@0.0.24
                            Properties:
                              Content: =""
                              Height: =27
                              Visible: =If(RadioKH.Selected.ID = 2 , true)
                              Width: =962
                              X: =252
                              Y: =50
                        - Label11_7:
                            Control: Label@2.5.1
                            Properties:
                              Align: =Align.Center
                              BorderColor: =RGBA(0, 18, 107, 1)
                              Font: =Font.'Open Sans'
                              FontWeight: =FontWeight.Bold
                              Height: =27
                              Size: =11
                              Text: ="Giá trị"
                              Visible: =If(RadioKH.Selected.ID = 2 , true)
                              Width: =642
                              X: =472
                              Y: =50
                        - Label11_8:
                            Control: Label@2.5.1
                            Properties:
                              Align: =Align.Center
                              BorderColor: =RGBA(0, 18, 107, 1)
                              Font: =Font.'Open Sans'
                              FontWeight: =FontWeight.Bold
                              Height: =27
                              Size: =11
                              Text: ="Tiêu chí"
                              Visible: =If(RadioKH.Selected.ID = 2 , true)
                              Width: =203
                              X: =254
                              Y: =50
                        - BadgeCanvas1_42:
                            Control: Badge@0.0.24
                            Properties:
                              Content: =""
                              Height: =27
                              Visible: =If(RadioKH_LoaiTru.Selected.ID = 2 , true)
                              Width: =962
                              X: =252
                              Y: =306
                        - Label11_9:
                            Control: Label@2.5.1
                            Properties:
                              Align: =Align.Center
                              BorderColor: =RGBA(0, 18, 107, 1)
                              Font: =Font.'Open Sans'
                              FontWeight: =FontWeight.Bold
                              Height: =27
                              Size: =11
                              Text: ="Giá trị"
                              Visible: =If(RadioKH_LoaiTru.Selected.ID = 2 , true)
                              Width: =642
                              X: =472
                              Y: =306
                        - Label11_10:
                            Control: Label@2.5.1
                            Properties:
                              Align: =Align.Center
                              BorderColor: =RGBA(0, 18, 107, 1)
                              Font: =Font.'Open Sans'
                              FontWeight: =FontWeight.Bold
                              Height: =27
                              Size: =11
                              Text: ="Tiêu chí"
                              Visible: =If(RadioKH_LoaiTru.Selected.ID = 2 , true)
                              Width: =203
                              X: =254
                              Y: =306
                        - Icon2_3:
                            Control: Classic/Icon@2.5.0
                            Properties:
                              BorderColor: =RGBA(0, 0, 0, 1)
                              Color: =RGBA(0, 0, 0, 1)
                              Height: =20
                              Icon: =Icon.Cancel
                              OnSelect: |-
                                =Reset(RadioKH_LoaiTru);
                                Set(varXoaKH, true);
                              Width: =20
                              X: =99
                              Y: =303
                  - Container2_4:
                      Control: GroupContainer@1.3.0
                      Variant: ManualLayout
                      Properties:
                        DropShadow: =DropShadow.None
                        Height: =493
                        Width: =Parent.Width-Self.X-14
                        X: =137
                        Y: =1787
                      Children:
                        - Label6_2:
                            Control: Label@2.5.1
                            Properties:
                              BorderColor: =RGBA(0, 18, 107, 1)
                              Font: =Font.'Open Sans'
                              FontWeight: =FontWeight.Bold
                              Height: =46
                              Size: =11
                              Text: ="2.4 Phạm vi"
                              Width: =Parent.Width
                        - RadioPV:
                            Control: Classic/Radio@2.3.0
                            Properties:
                              BorderColor: =RGBA(0, 0, 0, 0)
                              Default: |-
                                =//If(CountRows(Filter(DL_DIEUKIEN_APDUNG_LOAI, MA_DIEU_KIEN =varMaDKien  && THANH_PHAN = "PV" && AP_DUNG = "1")) > 0, LookUp(DL_DIEUKIEN_APDUNG_LOAI, MA_DIEU_KIEN =varMaDKien  && THANH_PHAN = "SP" && AP_DUNG = "1" ).TEN_KIEU, "Tất cả" )
                                If(IsBlank(varMaDKien), "Tất cả",LookUp(DL_DIEUKIEN_APDUNG_LOAI, MA_DIEU_KIEN =varMaDKien  && THANH_PHAN = "PV" && AP_DUNG = "1" ).TEN_KIEU)
                              DisplayMode: =If(varDaGhi,DisplayMode.Disabled,DisplayMode.Edit)
                              Font: =Font.'Open Sans'
                              HoverColor: =RGBA(0, 0, 0, 1)
                              Items: |-
                                =[{Text:"Tất cả", ID: 1 },{Text:"Một phần", ID: 2}]
                              Items.Value: =Text
                              OnSelect: =true
                              RadioBorderColor: =RGBA(0, 84, 148, 1)
                              RadioSelectionFill: =RGBA(0, 0, 0, 1)
                              Size: =11
                              X: =40
                              Y: =76
                        - GalleryPV_1:
                            Control: Gallery@2.15.0
                            Variant: Vertical
                            Properties:
                              BorderColor: =RGBA(180, 214, 250, 1)
                              BorderThickness: =1
                              Height: =156
                              Items: =tmpApdungPV
                              TemplateSize: =46
                              Visible: =If(RadioPV.Selected.ID = 2 , true)
                              Width: =962
                              X: =252
                              Y: =76
                            Children:
                              - DropPV:
                                  Control: Classic/DropDown@2.3.1
                                  Properties:
                                    BorderColor: =RGBA(180, 214, 250, 1)
                                    ChevronBackground: =RGBA(255, 255, 255, 1)
                                    ChevronFill: =RGBA(180, 214, 250, 1)
                                    ChevronHoverBackground: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                                    ChevronHoverFill: =RGBA(255, 255, 255, 1)
                                    Default: =ThisItem.cr282_ten_tieu_chi
                                    DisabledBorderColor: =RGBA(204, 228, 246, 1)
                                    DisabledFill: =RGBA(230, 230, 230, 1)
                                    DisplayMode: =If(varDaGhi,DisplayMode.Disabled,DisplayMode.Edit)
                                    Font: =Font.'Open Sans'
                                    HoverFill: =RGBA(186, 202, 226, 1)
                                    Items: =Filter(DM_TIEU_CHI_APDUNGS, LOAI = "PV")
                                    Items.Value: =cr282_ten_chi_tieu
                                    OnChange: =Reset(ComboBoxGTPV)
                                    OnSelect: =
                                    PressedColor: =RGBA(255, 255, 255, 1)
                                    PressedFill: =RGBA(0, 18, 107, 1)
                                    SelectionColor: =RGBA(255, 255, 255, 1)
                                    SelectionFill: =RGBA(56, 96, 178, 1)
                                    Size: =11
                                    Width: =200
                              - ComboBoxGTPV:
                                  Control: Classic/ComboBox@2.4.0
                                  Properties:
                                    BorderColor: =RGBA(180, 214, 250, 1)
                                    ChevronBackground: =RGBA(255, 255, 255, 1)
                                    ChevronFill: =RGBA(180, 214, 250, 1)
                                    ChevronHoverBackground: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                                    ChevronHoverFill: =RGBA(255, 255, 255, 1)
                                    DefaultSelectedItems: =ThisItem.group_apdung_pv
                                    DisabledBorderColor: =RGBA(204, 228, 246, 1)
                                    DisabledFill: =RGBA(230, 230, 230, 1)
                                    DisplayFields: =["cr282_ten_gia_tri"]
                                    DisplayMode: =If(varDaGhi,DisplayMode.Disabled,DisplayMode.Edit)
                                    Font: =Font.'Open Sans'
                                    HoverFill: =RGBA(186, 202, 226, 1)
                                    IsSearchable: =false
                                    Items: =Filter( tmpDsGiatri, Loai = DropPV.Selected.MA_CHI_TIEU)
                                    OnSelect: =Select(Parent)
                                    PressedColor: =RGBA(255, 255, 255, 1)
                                    PressedFill: =RGBA(0, 18, 107, 1)
                                    SearchFields: =["cr282_ten_gia_tri"]
                                    SelectionColor: =RGBA(255, 255, 255, 1)
                                    SelectionFill: =RGBA(56, 96, 178, 1)
                                    Size: =11
                                    Width: =643
                                    X: =212
                              - Button5_11:
                                  Control: Classic/Button@2.2.0
                                  Properties:
                                    BorderColor: =ColorFade(Self.Fill, -15%)
                                    Color: =RGBA(255, 255, 255, 1)
                                    DisabledBorderColor: =RGBA(166, 166, 166, 1)
                                    DisplayMode: =If(varDaGhi,DisplayMode.Disabled,DisplayMode.Edit)
                                    Fill: =RGBA(56, 96, 178, 1)
                                    Font: =Font.'Open Sans'
                                    Height: =28
                                    HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                                    HoverColor: =RGBA(255, 255, 255, 1)
                                    HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                                    OnSelect: =RemoveIf(tmpApdungPV, ThisItem.cr282_id=cr282_id)
                                    PressedBorderColor: =Self.Fill
                                    PressedColor: =Self.Fill
                                    PressedFill: =Self.Color
                                    Size: =11
                                    Text: ="Xoá"
                                    Width: =73
                                    X: =877
                                    Y: =3
                              - TextInput7:
                                  Control: Classic/TextInput@2.3.2
                                  Properties:
                                    BorderColor: =RGBA(0, 18, 107, 1)
                                    Default: =ThisItem.cr282_id
                                    Font: =Font.'Open Sans'
                                    HoverBorderColor: =RGBA(0, 18, 107, 1)
                                    HoverFill: =RGBA(186, 202, 226, 1)
                                    OnSelect: =Select(Parent)
                                    Visible: =false
                                    X: =211
                                    Y: =6
                        - Label7_2:
                            Control: Label@2.5.1
                            Properties:
                              BorderColor: =RGBA(0, 18, 107, 1)
                              Font: =Font.'Open Sans'
                              FontWeight: =FontWeight.Bold
                              Size: =11
                              Text: ="Áp dụng"
                              X: =25
                              Y: =36
                        - RadioPV_LoaiTru:
                            Control: Classic/Radio@2.3.0
                            Properties:
                              BorderColor: =RGBA(0, 0, 0, 0)
                              Default: |-
                                =
                                If(IsBlank(varMaDKien) Or varXoaPV, "",LookUp(DL_DIEUKIEN_APDUNG_LOAI, MA_DIEU_KIEN =varMaDKien  && THANH_PHAN = "PV" && AP_DUNG = "2" ).TEN_KIEU)
                              DisplayMode: =If(varDaGhi,DisplayMode.Disabled,DisplayMode.Edit)
                              Font: =Font.'Open Sans'
                              HoverColor: =RGBA(0, 0, 0, 1)
                              Items: |-
                                =[{Text:"Một phần", ID: 2}]
                              Items.Value: =Text
                              OnSelect: =true
                              RadioBorderColor: =RGBA(0, 84, 148, 1)
                              RadioSelectionFill: =RGBA(0, 0, 0, 1)
                              Size: =11
                              X: =41
                              Y: =304
                        - GalleryPV_LoaiTru:
                            Control: Gallery@2.15.0
                            Variant: Vertical
                            Properties:
                              BorderColor: =RGBA(180, 214, 250, 1)
                              BorderThickness: =1
                              Height: =156
                              Items: =tmpLoaitruPV
                              TemplateSize: =46
                              Visible: =If(RadioPV_LoaiTru.Selected.ID = 2 ,true)
                              Width: =962
                              X: =252
                              Y: =304
                            Children:
                              - DropPV_LoaiTru:
                                  Control: Classic/DropDown@2.3.1
                                  Properties:
                                    BorderColor: =RGBA(180, 214, 250, 1)
                                    ChevronBackground: =RGBA(255, 255, 255, 1)
                                    ChevronFill: =RGBA(180, 214, 250, 1)
                                    ChevronHoverBackground: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                                    ChevronHoverFill: =RGBA(255, 255, 255, 1)
                                    Default: =ThisItem.cr282_ten_tieu_chi
                                    DisabledBorderColor: =RGBA(204, 228, 246, 1)
                                    DisabledFill: =RGBA(230, 230, 230, 1)
                                    DisplayMode: =If(varDaGhi,DisplayMode.Disabled,DisplayMode.Edit)
                                    Font: =Font.'Open Sans'
                                    HoverFill: =RGBA(186, 202, 226, 1)
                                    Items: =Filter(DM_TIEU_CHI_APDUNGS, LOAI = "PV")
                                    Items.Value: =cr282_ten_chi_tieu
                                    OnChange: =Reset(ComboBoxGTPV_LT)
                                    OnSelect: =
                                    PressedColor: =RGBA(255, 255, 255, 1)
                                    PressedFill: =RGBA(0, 18, 107, 1)
                                    SelectionColor: =RGBA(255, 255, 255, 1)
                                    SelectionFill: =RGBA(56, 96, 178, 1)
                                    Size: =11
                                    Width: =200
                              - ComboBoxGTPV_LT:
                                  Control: Classic/ComboBox@2.4.0
                                  Properties:
                                    BorderColor: =RGBA(180, 214, 250, 1)
                                    ChevronBackground: =RGBA(255, 255, 255, 1)
                                    ChevronFill: =RGBA(9, 33, 98, 1)
                                    ChevronHoverBackground: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                                    ChevronHoverFill: =RGBA(255, 255, 255, 1)
                                    DefaultSelectedItems: =ThisItem.group_loaitru_pv
                                    DisabledBorderColor: =RGBA(204, 228, 246, 1)
                                    DisabledFill: =RGBA(230, 230, 230, 1)
                                    DisplayFields: =["cr282_ten_gia_tri"]
                                    DisplayMode: =If(varDaGhi,DisplayMode.Disabled,DisplayMode.Edit)
                                    Font: =Font.'Open Sans'
                                    HoverFill: =RGBA(186, 202, 226, 1)
                                    IsSearchable: =false
                                    Items: =Filter( tmpDsGiatri, Loai = DropPV_LoaiTru.Selected.MA_CHI_TIEU)
                                    OnSelect: =Select(Parent)
                                    PressedColor: =RGBA(255, 255, 255, 1)
                                    PressedFill: =RGBA(0, 18, 107, 1)
                                    SearchFields: =["cr282_ten_gia_tri"]
                                    SelectionColor: =RGBA(255, 255, 255, 1)
                                    SelectionFill: =RGBA(56, 96, 178, 1)
                                    Size: =11
                                    Width: =643
                                    X: =212
                              - Button5_12:
                                  Control: Classic/Button@2.2.0
                                  Properties:
                                    BorderColor: =ColorFade(Self.Fill, -15%)
                                    Color: =RGBA(255, 255, 255, 1)
                                    DisabledBorderColor: =RGBA(166, 166, 166, 1)
                                    DisplayMode: =If(varDaGhi,DisplayMode.Disabled,DisplayMode.Edit)
                                    Fill: =RGBA(56, 96, 178, 1)
                                    Font: =Font.'Open Sans'
                                    Height: =28
                                    HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                                    HoverColor: =RGBA(255, 255, 255, 1)
                                    HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                                    OnSelect: =RemoveIf(tmpLoaitruPV, ThisItem.cr282_id=cr282_id)
                                    PressedBorderColor: =Self.Fill
                                    PressedColor: =Self.Fill
                                    PressedFill: =Self.Color
                                    Size: =11
                                    Text: ="Xoá"
                                    Width: =73
                                    X: =880
                                    Y: =9
                              - TextInput8:
                                  Control: Classic/TextInput@2.3.2
                                  Properties:
                                    BorderColor: =RGBA(0, 18, 107, 1)
                                    Default: =ThisItem.cr282_id
                                    Font: =Font.'Open Sans'
                                    Height: =41
                                    HoverBorderColor: =RGBA(0, 18, 107, 1)
                                    HoverFill: =RGBA(186, 202, 226, 1)
                                    OnSelect: =Select(Parent)
                                    Visible: =false
                                    X: =270
                                    Y: =5
                        - Label7_3:
                            Control: Label@2.5.1
                            Properties:
                              BorderColor: =RGBA(0, 18, 107, 1)
                              Font: =Font.'Open Sans'
                              FontWeight: =FontWeight.Bold
                              Size: =11
                              Text: ="Loại trừ"
                              Width: =71
                              X: =25
                              Y: =264
                        - Button3_3:
                            Control: Classic/Button@2.2.0
                            Properties:
                              BorderColor: =ColorFade(Self.Fill, -15%)
                              Color: =RGBA(255, 255, 255, 1)
                              DisabledBorderColor: =RGBA(166, 166, 166, 1)
                              DisplayMode: =If(varDaGhi,DisplayMode.Disabled,DisplayMode.Edit)
                              Fill: =RGBA(56, 96, 178, 1)
                              Font: =Font.'Open Sans'
                              Height: =25
                              HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                              HoverColor: =RGBA(255, 255, 255, 1)
                              HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                              OnSelect: |-
                                =


                                Collect(
                                    tmpApdungPV,
                                    [{cr282_id:Value( Max (tmpApdungPV, cr282_id) + 1)}]
                                );
                              PressedBorderColor: =Self.Fill
                              PressedColor: =Self.Fill
                              PressedFill: =Self.Color
                              Size: =11
                              Text: ="Thêm mới"
                              Visible: =If(RadioPV.Selected.ID = 2 , true)
                              Width: =91
                              X: =252
                              Y: =15
                        - Button3_4:
                            Control: Classic/Button@2.2.0
                            Properties:
                              BorderColor: =ColorFade(Self.Fill, -15%)
                              Color: =RGBA(255, 255, 255, 1)
                              DisabledBorderColor: =RGBA(166, 166, 166, 1)
                              DisplayMode: =If(varDaGhi,DisplayMode.Disabled,DisplayMode.Edit)
                              Fill: =RGBA(56, 96, 178, 1)
                              Font: =Font.'Open Sans'
                              Height: =25
                              HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                              HoverColor: =RGBA(255, 255, 255, 1)
                              HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                              OnSelect: |-
                                =




                                Collect(
                                    tmpLoaitruPV,
                                    [{cr282_id:Value( Max (tmpLoaitruPV, cr282_id) + 1)}]
                                );
                              PressedBorderColor: =Self.Fill
                              PressedColor: =Self.Fill
                              PressedFill: =Self.Color
                              Size: =11
                              Text: ="Thêm mới"
                              Visible: =If(RadioPV_LoaiTru.Selected.ID = 2 ,true)
                              Width: =91
                              X: =253.2
                              Y: =245
                        - BadgeCanvas1_43:
                            Control: Badge@0.0.24
                            Properties:
                              Content: =""
                              Height: =27
                              Visible: =If(RadioPV.Selected.ID = 2 , true)
                              Width: =962
                              X: =252
                              Y: =47
                        - Label11_11:
                            Control: Label@2.5.1
                            Properties:
                              Align: =Align.Center
                              BorderColor: =RGBA(0, 18, 107, 1)
                              Font: =Font.'Open Sans'
                              FontWeight: =FontWeight.Bold
                              Height: =27
                              Size: =11
                              Text: ="Giá trị"
                              Visible: =If(RadioPV.Selected.ID = 2 , true)
                              Width: =642
                              X: =471
                              Y: =47
                        - Label11_12:
                            Control: Label@2.5.1
                            Properties:
                              Align: =Align.Center
                              BorderColor: =RGBA(0, 18, 107, 1)
                              Font: =Font.'Open Sans'
                              FontWeight: =FontWeight.Bold
                              Height: =27
                              Size: =11
                              Text: ="Tiêu chí"
                              Visible: =If(RadioPV.Selected.ID = 2 , true)
                              Width: =203
                              X: =253
                              Y: =47
                        - BadgeCanvas1_44:
                            Control: Badge@0.0.24
                            Properties:
                              Content: =""
                              Height: =27
                              Visible: =If(RadioPV_LoaiTru.Selected.ID = 2 ,true)
                              Width: =962
                              X: =252
                              Y: =277
                        - Label11_13:
                            Control: Label@2.5.1
                            Properties:
                              Align: =Align.Center
                              BorderColor: =RGBA(0, 18, 107, 1)
                              Font: =Font.'Open Sans'
                              FontWeight: =FontWeight.Bold
                              Height: =27
                              Size: =11
                              Text: ="Giá trị"
                              Visible: =If(RadioPV_LoaiTru.Selected.ID = 2 ,true)
                              Width: =642
                              X: =472
                              Y: =277
                        - Label11_14:
                            Control: Label@2.5.1
                            Properties:
                              Align: =Align.Center
                              BorderColor: =RGBA(0, 18, 107, 1)
                              Font: =Font.'Open Sans'
                              FontWeight: =FontWeight.Bold
                              Height: =27
                              Size: =11
                              Text: ="Tiêu chí"
                              Visible: =If(RadioPV_LoaiTru.Selected.ID = 2 ,true)
                              Width: =203
                              X: =254
                              Y: =277
                        - Icon2_4:
                            Control: Classic/Icon@2.5.0
                            Properties:
                              BorderColor: =RGBA(0, 0, 0, 1)
                              Color: =RGBA(0, 0, 0, 1)
                              Height: =20
                              Icon: =Icon.Cancel
                              OnSelect: |-
                                =Reset(RadioPV_LoaiTru);
                                Set(varXoaPV, true)
                              Width: =20
                              X: =99
                              Y: =274
                  - SPApdung:
                      Control: GroupContainer@1.3.0
                      Variant: ManualLayout
                      Properties:
                        BorderStyle: =BorderStyle.None
                        DropShadow: =DropShadow.None
                        Height: =273
                        Width: =1222
                        X: =130
                        Y: =342
                      Children:
                        - Label6_4:
                            Control: Label@2.5.1
                            Properties:
                              BorderColor: =RGBA(0, 18, 107, 1)
                              Font: =Font.'Open Sans'
                              FontWeight: =FontWeight.Bold
                              Height: =46
                              Size: =11
                              Text: ="2. Điều kiện áp dụng"
                              Width: =Parent.Width
                        - Label6_5:
                            Control: Label@2.5.1
                            Properties:
                              BorderColor: =RGBA(0, 18, 107, 1)
                              Font: =Font.'Open Sans'
                              FontWeight: =FontWeight.Bold
                              Height: =46
                              Size: =11
                              Text: ="2.1 Sản phẩm"
                              Width: =222
                              Y: =40
                        - Radio2:
                            Control: Classic/Radio@2.3.0
                            Properties:
                              BorderColor: =RGBA(0, 0, 0, 0)
                              Default: |-
                                =//LookUp(DL_DIEUKIEN_APDUNG_LOAI, MA_DIEU_KIEN =varMaDKien  && THANH_PHAN = "SP" && AP_DUNG = "1" ).TEN_KIEU
                                //If(CountRows(Filter(DL_DIEUKIEN_APDUNG_LOAI, MA_DIEU_KIEN =varMaDKien  && THANH_PHAN = "SP" && AP_DUNG = "1")) > 0, LookUp(DL_DIEUKIEN_APDUNG_LOAI, MA_DIEU_KIEN =varMaDKien  && THANH_PHAN = "SP" && AP_DUNG = "1" ).TEN_KIEU, "Tất cả" )
                                If(IsBlank(varMaDKien), "Tất cả",LookUp(DL_DIEUKIEN_APDUNG_LOAI, MA_DIEU_KIEN =varMaDKien  && THANH_PHAN = "SP" && AP_DUNG = "1" ).TEN_KIEU)
                              DisplayMode: =If(varDaGhi,DisplayMode.Disabled,DisplayMode.Edit)
                              Font: =Font.'Open Sans'
                              HoverColor: =RGBA(0, 0, 0, 1)
                              Items: |-
                                =[{Text:"Tất cả", ID: 1 },{Text:"Một phần", ID: 2}]
                              Items.Value: =Text
                              OnSelect: =true
                              RadioBorderColor: =RGBA(15, 84, 140, 1)
                              RadioSelectionFill: =RGBA(0, 0, 0, 1)
                              Size: =11
                              X: =48
                              Y: =116
                        - Gallery5:
                            Control: Gallery@2.15.0
                            Variant: Vertical
                            Properties:
                              BorderColor: =RGBA(180, 214, 250, 1)
                              BorderThickness: =1
                              Height: =156
                              Items: |-
                                =
                                tmpApdungSp
                              TemplateSize: =46
                              Visible: =If(Radio2.Selected.ID = 2 , true)
                              Width: =962
                              X: =252
                              Y: =116
                            Children:
                              - DropQTich:
                                  Control: Classic/DropDown@2.3.1
                                  Properties:
                                    BorderColor: =RGBA(180, 214, 250, 1)
                                    ChevronBackground: =RGBA(255, 255, 255, 1)
                                    ChevronFill: =RGBA(180, 214, 250, 1)
                                    ChevronHoverBackground: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                                    ChevronHoverFill: =RGBA(255, 255, 255, 1)
                                    Default: |
                                      =LookUp(DL_DIEUKIEN_APDUNG_LOAI_CT, MA_DIEU_KIEN =varMaDKien && THANH_PHAN ="SP" && AP_DUNG = "1" && KIEU = "2" && MA_TIEU_CHI = ThisItem.cr282_ma_tieu_chi).TEN_TIEU_CHI
                                    DisabledBorderColor: =RGBA(180, 214, 250, 1)
                                    DisabledFill: =RGBA(214, 221, 224, 1)
                                    DisplayMode: =If(varDaGhi,DisplayMode.Disabled,DisplayMode.Edit)
                                    Font: =Font.'Open Sans'
                                    HoverFill: =RGBA(186, 202, 226, 1)
                                    Items: =Filter(DM_TIEU_CHI_APDUNGS, LOAI = "SP")
                                    Items.Value: =cr282_ten_chi_tieu
                                    OnChange: =Reset(ComboBox3)
                                    OnSelect: =Reset(ComboBox3);
                                    PressedColor: =RGBA(255, 255, 255, 1)
                                    PressedFill: =RGBA(0, 18, 107, 1)
                                    SelectionColor: =RGBA(255, 255, 255, 1)
                                    SelectionFill: =RGBA(56, 96, 178, 1)
                                    Size: =11
                                    Width: =200
                              - ComboBox3:
                                  Control: Classic/ComboBox@2.4.0
                                  Properties:
                                    BorderColor: =RGBA(180, 214, 250, 1)
                                    ChevronBackground: =RGBA(255, 255, 255, 1)
                                    ChevronFill: =RGBA(180, 214, 250, 1)
                                    ChevronHoverBackground: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                                    ChevronHoverFill: =RGBA(255, 255, 255, 1)
                                    DefaultSelectedItems: =ThisItem.group
                                    DisabledBorderColor: =RGBA(180, 214, 250, 1)
                                    DisabledFill: =RGBA(214, 221, 224, 1)
                                    DisplayFields: =["cr282_ten_gia_tri","Ma"]
                                    DisplayMode: =If(varDaGhi,DisplayMode.Disabled,DisplayMode.Edit)
                                    Font: =Font.'Open Sans'
                                    HoverFill: =RGBA(186, 202, 226, 1)
                                    IsSearchable: =false
                                    Items: =Filter( tmpDsGiatri, Loai = DropQTich.Selected.MA_CHI_TIEU)
                                    OnSelect: =Select(Parent)
                                    PressedColor: =RGBA(255, 255, 255, 1)
                                    PressedFill: =RGBA(0, 18, 107, 1)
                                    SearchFields: =["cr282_ten_gia_tri"]
                                    SelectionColor: =RGBA(255, 255, 255, 1)
                                    SelectionFill: =RGBA(56, 96, 178, 1)
                                    Width: =423
                                    X: =214
                              - Button5_13:
                                  Control: Classic/Button@2.2.0
                                  Properties:
                                    BorderColor: =ColorFade(Self.Fill, -15%)
                                    Color: =RGBA(255, 255, 255, 1)
                                    DisabledBorderColor: =RGBA(166, 166, 166, 1)
                                    DisplayMode: =If(varDaGhi,DisplayMode.Disabled,DisplayMode.Edit)
                                    Fill: =RGBA(56, 96, 178, 1)
                                    Font: =Font.'Open Sans'
                                    Height: =28
                                    HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                                    HoverColor: =RGBA(255, 255, 255, 1)
                                    HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                                    OnSelect: =RemoveIf(tmpApdungSp, cr282_id = ThisItem.cr282_id)
                                    PressedBorderColor: =Self.Fill
                                    PressedColor: =Self.Fill
                                    PressedFill: =Self.Color
                                    Size: =11
                                    Text: ="Xoá"
                                    Width: =73
                                    X: =876
                                    Y: =6
                              - TextInput1:
                                  Control: Classic/TextInput@2.3.2
                                  Properties:
                                    BorderColor: =RGBA(0, 18, 107, 1)
                                    Default: =ThisItem.cr282_id
                                    Font: =Font.'Open Sans'
                                    HoverBorderColor: =RGBA(0, 18, 107, 1)
                                    HoverFill: =RGBA(186, 202, 226, 1)
                                    OnSelect: =Select(Parent)
                                    Visible: =false
                                    Width: =172
                                    X: =214
                                    Y: =5
                              - PV_AD:
                                  Control: Classic/DropDown@2.3.1
                                  Properties:
                                    BorderColor: =RGBA(180, 214, 250, 1)
                                    ChevronBackground: =RGBA(255, 255, 255, 1)
                                    ChevronFill: =RGBA(180, 214, 250, 1)
                                    ChevronHoverBackground: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                                    ChevronHoverFill: =RGBA(255, 255, 255, 1)
                                    Default: |
                                      =LookUp(DL_DIEUKIEN_APDUNG_LOAI_CT, MA_DIEU_KIEN =varMaDKien && THANH_PHAN ="SP" && AP_DUNG = "1" && KIEU = "2" && MA_TIEU_CHI = ThisItem.cr282_ma_tieu_chi && MA_PV_AD = ThisItem.cr282_ma_pv_ad).TEN_PV_AD
                                    DisabledBorderColor: =RGBA(180, 214, 250, 1)
                                    DisabledFill: =RGBA(214, 221, 224, 1)
                                    DisplayMode: =If(varDaGhi,DisplayMode.Disabled,DisplayMode.Edit)
                                    Font: =Font.'Open Sans'
                                    HoverFill: =RGBA(186, 202, 226, 1)
                                    Items: |
                                      =If(DropQTich.Selected.MA_CHI_TIEU ="MA_COMBO_SP", [{Text:"Hợp đồng hiện tại", ID: "1" },{Text:"Liên kết hợp đồng", ID: "2"}], [{Text:"", ID: "" }])
                                    Items.Value: =Text
                                    OnChange: =
                                    OnSelect: =
                                    PressedColor: =RGBA(255, 255, 255, 1)
                                    PressedFill: =RGBA(0, 18, 107, 1)
                                    SelectionColor: =RGBA(255, 255, 255, 1)
                                    SelectionFill: =RGBA(56, 96, 178, 1)
                                    Size: =11
                                    Visible: |
                                      =If(DropQTich.Selected.MA_CHI_TIEU ="MA_COMBO_SP", true, false)
                                    Width: =188
                                    X: =648
                        - Label7_4:
                            Control: Label@2.5.1
                            Properties:
                              BorderColor: =RGBA(0, 18, 107, 1)
                              Font: =Font.'Open Sans'
                              FontWeight: =FontWeight.Bold
                              Size: =11
                              Text: ="Áp dụng"
                              X: =25
                              Y: =76
                        - Button3_5:
                            Control: Classic/Button@2.2.0
                            Properties:
                              BorderColor: =ColorFade(Self.Fill, -15%)
                              Color: =RGBA(255, 255, 255, 1)
                              DisabledBorderColor: =RGBA(166, 166, 166, 1)
                              DisplayMode: =If(varDaGhi,DisplayMode.Disabled,DisplayMode.Edit)
                              Fill: =RGBA(56, 96, 178, 1)
                              Font: =Font.'Open Sans'
                              Height: =25
                              HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                              HoverColor: =RGBA(255, 255, 255, 1)
                              HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                              OnSelect: |+
                                =Collect(
                                    tmpApdungSp,
                                    [{cr282_id:Value( Max (tmpApdungSp, cr282_id) + 1)}]
                                );

                              PressedBorderColor: =Self.Fill
                              PressedColor: =Self.Fill
                              PressedFill: =Self.Color
                              Size: =11
                              Text: ="Thêm mới"
                              Visible: =If(Radio2.Selected.ID = 2 , true)
                              Width: =91
                              X: =254
                              Y: =51
                        - BadgeCanvas1_38:
                            Control: Badge@0.0.24
                            Properties:
                              Content: =""
                              Height: =27
                              Visible: =If(Radio2.Selected.ID = 2 , true)
                              Width: =962
                              X: =252
                              Y: =90
                        - Label11:
                            Control: Label@2.5.1
                            Properties:
                              Align: =Align.Center
                              BorderColor: =RGBA(0, 18, 107, 1)
                              Font: =Font.'Open Sans'
                              FontWeight: =FontWeight.Bold
                              Height: =27
                              Size: =11
                              Text: ="Tiêu chí"
                              Visible: =If(Radio2.Selected.ID = 2 , true)
                              Width: =203
                              X: =254
                              Y: =90
                        - Label11_1:
                            Control: Label@2.5.1
                            Properties:
                              Align: =Align.Center
                              BorderColor: =RGBA(0, 18, 107, 1)
                              Font: =Font.'Open Sans'
                              FontWeight: =FontWeight.Bold
                              Height: =27
                              Size: =11
                              Text: ="Giá trị"
                              Visible: =If(Radio2.Selected.ID = 2 , true)
                              Width: =419
                              X: =473
                              Y: =90
                        - Label11_2:
                            Control: Label@2.5.1
                            Properties:
                              Align: =Align.Center
                              BorderColor: =RGBA(0, 18, 107, 1)
                              Font: =Font.'Open Sans'
                              FontWeight: =FontWeight.Bold
                              Height: =26
                              Size: =11
                              Text: ="Phạm vi áp dụng"
                              Visible: =If(Radio2.Selected.ID = 2 , true)
                              Width: =189
                              X: =908
                              Y: =90
                  - SPLoaiTru:
                      Control: GroupContainer@1.3.0
                      Variant: ManualLayout
                      Properties:
                        DropShadow: =DropShadow.None
                        Height: =221
                        Width: =1222
                        X: =131
                        Y: =615
                      Children:
                        - Radio2_1:
                            Control: Classic/Radio@2.3.0
                            Properties:
                              BorderColor: =RGBA(0, 0, 0, 0)
                              Default: |-
                                =
                                If(IsBlank(varMaDKien) Or varXoaSP, "",LookUp(DL_DIEUKIEN_APDUNG_LOAI, MA_DIEU_KIEN =varMaDKien  && THANH_PHAN = "SP" && AP_DUNG = "2" ).TEN_KIEU)
                              DisplayMode: =If(varDaGhi,DisplayMode.Disabled,DisplayMode.Edit)
                              Font: =Font.'Open Sans'
                              HoverColor: =RGBA(0, 0, 0, 1)
                              Items: |-
                                =[{Text:"Một phần", ID: 2}]
                              Items.Value: =Text
                              OnSelect: =true
                              RadioBorderColor: =RGBA(15, 84, 140, 1)
                              RadioSelectionFill: =RGBA(0, 0, 0, 1)
                              Size: =11
                              X: =43
                              Y: =65
                        - Gallery5_1:
                            Control: Gallery@2.15.0
                            Variant: Vertical
                            Properties:
                              BorderColor: =RGBA(180, 214, 250, 1)
                              BorderThickness: =1
                              Height: =150
                              Items: =tmpLoaitruSp
                              TemplateSize: =46
                              Visible: =If(Radio2_1.Selected.ID = 2 , true)
                              Width: =962
                              X: =253.2
                              Y: =65
                            Children:
                              - DropQTich_1:
                                  Control: Classic/DropDown@2.3.1
                                  Properties:
                                    BorderColor: =RGBA(180, 214, 250, 1)
                                    ChevronBackground: =RGBA(255, 255, 255, 1)
                                    ChevronFill: =RGBA(180, 214, 250, 1)
                                    ChevronHoverBackground: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                                    ChevronHoverFill: =RGBA(255, 255, 255, 1)
                                    Default: |
                                      =LookUp(DL_DIEUKIEN_APDUNG_LOAI_CT, MA_DIEU_KIEN =varMaDKien && THANH_PHAN ="SP" && AP_DUNG = "2" && KIEU = "2" && MA_TIEU_CHI = ThisItem.cr282_ma_tieu_chi).TEN_TIEU_CHI
                                    DisabledBorderColor: =RGBA(180, 214, 250, 1)
                                    DisabledFill: =RGBA(214, 221, 224, 1)
                                    DisplayMode: =If(varDaGhi,DisplayMode.Disabled,DisplayMode.Edit)
                                    Font: =Font.'Open Sans'
                                    HoverFill: =RGBA(186, 202, 226, 1)
                                    Items: =Filter(DM_TIEU_CHI_APDUNGS, LOAI = "SP")
                                    Items.Value: =cr282_ten_chi_tieu
                                    OnChange: =
                                    OnSelect: =Reset(ComboBox3_1)
                                    PressedColor: =RGBA(255, 255, 255, 1)
                                    PressedFill: =RGBA(0, 18, 107, 1)
                                    SelectionColor: =RGBA(255, 255, 255, 1)
                                    SelectionFill: =RGBA(56, 96, 178, 1)
                                    Size: =11
                                    Width: =200
                              - ComboBox3_1:
                                  Control: Classic/ComboBox@2.4.0
                                  Properties:
                                    BorderColor: =RGBA(180, 214, 250, 1)
                                    ChevronBackground: =RGBA(255, 255, 255, 1)
                                    ChevronFill: =RGBA(180, 214, 250, 1)
                                    ChevronHoverBackground: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                                    ChevronHoverFill: =RGBA(255, 255, 255, 1)
                                    DefaultSelectedItems: =ThisItem.group
                                    DisabledBorderColor: =RGBA(180, 214, 250, 1)
                                    DisabledFill: =RGBA(214, 221, 224, 1)
                                    DisplayFields: =["cr282_ten_gia_tri"]
                                    DisplayMode: =If(varDaGhi,DisplayMode.Disabled,DisplayMode.Edit)
                                    Font: =Font.'Open Sans'
                                    HoverFill: =RGBA(186, 202, 226, 1)
                                    IsSearchable: =false
                                    Items: =Filter( tmpDsGiatri, Loai = DropQTich_1.Selected.MA_CHI_TIEU)
                                    OnSelect: =Select(Parent)
                                    PressedColor: =RGBA(255, 255, 255, 1)
                                    PressedFill: =RGBA(0, 18, 107, 1)
                                    SearchFields: =["cr282_ten_gia_tri"]
                                    SelectionColor: =RGBA(255, 255, 255, 1)
                                    SelectionFill: =RGBA(56, 96, 178, 1)
                                    Width: =423
                                    X: =212
                              - Button5_14:
                                  Control: Classic/Button@2.2.0
                                  Properties:
                                    BorderColor: =ColorFade(Self.Fill, -15%)
                                    Color: =RGBA(255, 255, 255, 1)
                                    DisabledBorderColor: =RGBA(166, 166, 166, 1)
                                    DisplayMode: =If(varDaGhi,DisplayMode.Disabled,DisplayMode.Edit)
                                    Fill: =RGBA(56, 96, 178, 1)
                                    Font: =Font.'Open Sans'
                                    Height: =28
                                    HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                                    HoverColor: =RGBA(255, 255, 255, 1)
                                    HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                                    OnSelect: =RemoveIf(tmpLoaitruSp, cr282_id = ThisItem.cr282_id)
                                    PressedBorderColor: =Self.Fill
                                    PressedColor: =Self.Fill
                                    PressedFill: =Self.Color
                                    Size: =11
                                    Text: ="Xoá"
                                    Width: =73
                                    X: =877
                                    Y: =3
                              - TextInput2:
                                  Control: Classic/TextInput@2.3.2
                                  Properties:
                                    BorderColor: =RGBA(0, 18, 107, 1)
                                    Default: =ThisItem.cr282_id
                                    Font: =Font.'Open Sans'
                                    HoverBorderColor: =RGBA(0, 18, 107, 1)
                                    HoverFill: =RGBA(186, 202, 226, 1)
                                    OnSelect: =Select(Parent)
                                    Visible: =false
                                    Width: =268
                                    X: =247
                                    Y: =6
                              - PV_AD_1:
                                  Control: Classic/DropDown@2.3.1
                                  Properties:
                                    BorderColor: =RGBA(180, 214, 250, 1)
                                    ChevronBackground: =RGBA(255, 255, 255, 1)
                                    ChevronFill: =RGBA(180, 214, 250, 1)
                                    ChevronHoverBackground: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                                    ChevronHoverFill: =RGBA(255, 255, 255, 1)
                                    Default: |
                                      =LookUp(DL_DIEUKIEN_APDUNG_LOAI_CT, MA_DIEU_KIEN =varMaDKien && THANH_PHAN ="SP" && AP_DUNG = "2" && KIEU = "2" && MA_TIEU_CHI = ThisItem.cr282_ma_tieu_chi && MA_PV_AD = ThisItem.cr282_ma_pv_ad).TEN_PV_AD
                                    DisabledBorderColor: =RGBA(180, 214, 250, 1)
                                    DisabledFill: =RGBA(214, 221, 224, 1)
                                    DisplayMode: =If(varDaGhi,DisplayMode.Disabled,DisplayMode.Edit)
                                    Font: =Font.'Open Sans'
                                    HoverFill: =RGBA(186, 202, 226, 1)
                                    Items: |
                                      =If(DropQTich.Selected.MA_CHI_TIEU ="MA_COMBO_SP", [{Text:"Hợp đồng hiện tại", ID: "1" },{Text:"Liên kết hợp đồng", ID: "2"}], [{Text:"", ID: "" }])
                                    Items.Value: =Text
                                    OnChange: =
                                    OnSelect: =
                                    PressedColor: =RGBA(255, 255, 255, 1)
                                    PressedFill: =RGBA(0, 18, 107, 1)
                                    SelectionColor: =RGBA(255, 255, 255, 1)
                                    SelectionFill: =RGBA(56, 96, 178, 1)
                                    Size: =11
                                    Visible: |
                                      =If(DropQTich_1.Selected.MA_CHI_TIEU ="MA_COMBO_SP", true, false)
                                    Width: =188
                                    X: =648
                        - Label7_5:
                            Control: Label@2.5.1
                            Properties:
                              BorderColor: =RGBA(0, 18, 107, 1)
                              Font: =Font.'Open Sans'
                              FontWeight: =FontWeight.Bold
                              Size: =11
                              Text: ="Loại trừ"
                              Width: =75
                              X: =24
                              Y: =7
                        - Button3_6:
                            Control: Classic/Button@2.2.0
                            Properties:
                              BorderColor: =ColorFade(Self.Fill, -15%)
                              Color: =RGBA(255, 255, 255, 1)
                              DisabledBorderColor: =RGBA(166, 166, 166, 1)
                              DisplayMode: =If(varDaGhi,DisplayMode.Disabled,DisplayMode.Edit)
                              Fill: =RGBA(56, 96, 178, 1)
                              Font: =Font.'Open Sans'
                              Height: =25
                              HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                              HoverColor: =RGBA(255, 255, 255, 1)
                              HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                              OnSelect: |-
                                =Collect(
                                    tmpLoaitruSp,
                                    [{cr282_id:Value( Max (tmpLoaitruSp, cr282_id) + 1)}]
                                );
                              PressedBorderColor: =Self.Fill
                              PressedColor: =Self.Fill
                              PressedFill: =Self.Color
                              Size: =11
                              Text: ="Thêm mới"
                              Visible: =If(Radio2_1.Selected.ID = 2 , true)
                              Width: =91
                              X: =254
                              Y: =7
                        - BadgeCanvas1_45:
                            Control: Badge@0.0.24
                            Properties:
                              Content: =""
                              Height: =27
                              Visible: =If(Radio2_1.Selected.ID = 2 , true)
                              Width: =962
                              X: =252
                              Y: =38
                        - Label11_15:
                            Control: Label@2.5.1
                            Properties:
                              Align: =Align.Center
                              BorderColor: =RGBA(0, 18, 107, 1)
                              Font: =Font.'Open Sans'
                              FontWeight: =FontWeight.Bold
                              Height: =27
                              Size: =11
                              Text: ="Tiêu chí"
                              Visible: =If(Radio2_1.Selected.ID = 2 , true)
                              Width: =203
                              X: =254
                              Y: =38
                        - Label11_16:
                            Control: Label@2.5.1
                            Properties:
                              Align: =Align.Center
                              BorderColor: =RGBA(0, 18, 107, 1)
                              Font: =Font.'Open Sans'
                              FontWeight: =FontWeight.Bold
                              Height: =27
                              Size: =11
                              Text: ="Giá trị"
                              Visible: =If(Radio2_1.Selected.ID = 2 , true)
                              Width: =419
                              X: =473
                              Y: =38
                        - Label11_17:
                            Control: Label@2.5.1
                            Properties:
                              Align: =Align.Center
                              BorderColor: =RGBA(0, 18, 107, 1)
                              Font: =Font.'Open Sans'
                              FontWeight: =FontWeight.Bold
                              Height: =26
                              Size: =11
                              Text: ="Phạm vi áp dụng"
                              Visible: =If(Radio2_1.Selected.ID = 2 , true)
                              Width: =189
                              X: =908
                              Y: =38
                        - Icon2_1:
                            Control: Classic/Icon@2.5.0
                            Properties:
                              BorderColor: =RGBA(0, 0, 0, 1)
                              Color: =RGBA(0, 0, 0, 1)
                              Height: =20
                              Icon: =Icon.Cancel
                              OnSelect: |-
                                =Reset(Radio2_1);
                                Set(varXoaSP, true);
                              Width: =20
                              X: =99
                              Y: =15
                  - Container2.2:
                      Control: GroupContainer@1.3.0
                      Variant: ManualLayout
                      Properties:
                        DropShadow: =DropShadow.None
                        Height: =458
                        Width: =Parent.Width-Self.X-14
                        X: =130
                        Y: =836
                      Children:
                        - Label6_6:
                            Control: Label@2.5.1
                            Properties:
                              BorderColor: =RGBA(0, 18, 107, 1)
                              Font: =Font.'Open Sans'
                              FontWeight: =FontWeight.Bold
                              Height: =46
                              Size: =11
                              Text: ="2.2 Kênh bán"
                              Width: =Parent.Width
                        - RadioKB:
                            Control: Classic/Radio@2.3.0
                            Properties:
                              BorderColor: =RGBA(0, 0, 0, 0)
                              Default: |-
                                =//If(CountRows(Filter(DL_DIEUKIEN_APDUNG_LOAI, MA_DIEU_KIEN =varMaDKien  && THANH_PHAN = "KB" && AP_DUNG = "1")) > 0, LookUp(DL_DIEUKIEN_APDUNG_LOAI, MA_DIEU_KIEN =varMaDKien  && THANH_PHAN = "KB" && AP_DUNG = "1" ).TEN_KIEU, "Tất cả" )
                                If(IsBlank(varMaDKien), "Tất cả",LookUp(DL_DIEUKIEN_APDUNG_LOAI, MA_DIEU_KIEN =varMaDKien  && THANH_PHAN = "KB" && AP_DUNG = "1" ).TEN_KIEU)
                              DisplayMode: =If(varDaGhi,DisplayMode.Disabled,DisplayMode.Edit)
                              Font: =Font.'Open Sans'
                              HoverColor: =RGBA(0, 0, 0, 1)
                              Items: |-
                                =[{Text:"Tất cả", ID: 1 },{Text:"Một phần", ID: 2}]
                              Items.Value: =Text
                              OnSelect: =true
                              RadioBorderColor: =RGBA(0, 84, 148, 1)
                              RadioSelectionFill: =RGBA(0, 0, 0, 1)
                              Size: =11
                              X: =40
                              Y: =76
                        - GalleryKB:
                            Control: Gallery@2.15.0
                            Variant: Vertical
                            Properties:
                              BorderColor: =RGBA(180, 214, 250, 1)
                              BorderThickness: =1
                              Height: =156
                              Items: =tmpApdungKB
                              TemplateSize: =46
                              Visible: =If(RadioKB.Selected.ID = 2 , true)
                              Width: =962
                              X: =253
                              Y: =76
                            Children:
                              - DropKB:
                                  Control: Classic/DropDown@2.3.1
                                  Properties:
                                    BorderColor: =RGBA(180, 214, 250, 1)
                                    ChevronBackground: =RGBA(255, 255, 255, 1)
                                    ChevronFill: =RGBA(180, 214, 250, 1)
                                    ChevronHoverBackground: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                                    ChevronHoverFill: =RGBA(255, 255, 255, 1)
                                    Default: =ThisItem.cr282_ten_tieu_chi
                                    DisabledBorderColor: =RGBA(204, 228, 246, 1)
                                    DisabledFill: =RGBA(230, 230, 230, 1)
                                    DisplayMode: =If(varDaGhi,DisplayMode.Disabled,DisplayMode.Edit)
                                    Font: =Font.'Open Sans'
                                    HoverFill: =RGBA(186, 202, 226, 1)
                                    Items: =Filter(DM_TIEU_CHI_APDUNGS, LOAI = "KB")
                                    Items.Value: =cr282_ten_chi_tieu
                                    OnChange: =Reset(ComboBoxGTKB)
                                    OnSelect: =
                                    PressedColor: =RGBA(255, 255, 255, 1)
                                    PressedFill: =RGBA(0, 18, 107, 1)
                                    SelectionColor: =RGBA(255, 255, 255, 1)
                                    SelectionFill: =RGBA(56, 96, 178, 1)
                                    Size: =11
                                    Width: =200
                              - ComboBoxGTKB:
                                  Control: Classic/ComboBox@2.4.0
                                  Properties:
                                    BorderColor: =RGBA(180, 214, 250, 1)
                                    ChevronBackground: =RGBA(255, 255, 255, 1)
                                    ChevronFill: =RGBA(180, 214, 250, 1)
                                    ChevronHoverBackground: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                                    ChevronHoverFill: =RGBA(255, 255, 255, 1)
                                    DefaultSelectedItems: =ThisItem.group_apdung_kb
                                    DisabledBorderColor: =RGBA(204, 228, 246, 1)
                                    DisabledFill: =RGBA(230, 230, 230, 1)
                                    DisplayFields: =["cr282_ten_gia_tri"]
                                    DisplayMode: =If(varDaGhi,DisplayMode.Disabled,DisplayMode.Edit)
                                    Font: =Font.'Open Sans'
                                    HoverFill: =RGBA(186, 202, 226, 1)
                                    IsSearchable: =false
                                    Items: =Filter( tmpDsGiatri, Loai = DropKB.Selected.MA_CHI_TIEU)
                                    OnSelect: =Select(Parent)
                                    PressedColor: =RGBA(255, 255, 255, 1)
                                    PressedFill: =RGBA(0, 18, 107, 1)
                                    SearchFields: =["cr282_ten_gia_tri"]
                                    SelectionColor: =RGBA(255, 255, 255, 1)
                                    SelectionFill: =RGBA(56, 96, 178, 1)
                                    Size: =11
                                    Width: =643
                                    X: =212
                              - Button5_15:
                                  Control: Classic/Button@2.2.0
                                  Properties:
                                    BorderColor: =ColorFade(Self.Fill, -15%)
                                    Color: =RGBA(255, 255, 255, 1)
                                    DisabledBorderColor: =RGBA(166, 166, 166, 1)
                                    DisplayMode: =If(varDaGhi,DisplayMode.Disabled,DisplayMode.Edit)
                                    Fill: =RGBA(56, 96, 178, 1)
                                    Font: =Font.'Open Sans'
                                    Height: =28
                                    HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                                    HoverColor: =RGBA(255, 255, 255, 1)
                                    HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                                    OnSelect: =RemoveIf(tmpApdungKB, cr282_id=ThisItem.cr282_id)
                                    PressedBorderColor: =Self.Fill
                                    PressedColor: =Self.Fill
                                    PressedFill: =Self.Color
                                    Size: =11
                                    Text: ="Xoá"
                                    Width: =73
                                    X: =877
                                    Y: =3
                              - TextInput3:
                                  Control: Classic/TextInput@2.3.2
                                  Properties:
                                    BorderColor: =RGBA(0, 18, 107, 1)
                                    Default: =ThisItem.cr282_id
                                    Font: =Font.'Open Sans'
                                    HoverBorderColor: =RGBA(0, 18, 107, 1)
                                    HoverFill: =RGBA(186, 202, 226, 1)
                                    OnSelect: =Select(Parent)
                                    Visible: =false
                                    Width: =269
                                    X: =575
                                    Y: =3
                        - Label7_6:
                            Control: Label@2.5.1
                            Properties:
                              BorderColor: =RGBA(0, 18, 107, 1)
                              Font: =Font.'Open Sans'
                              FontWeight: =FontWeight.Bold
                              Size: =11
                              Text: ="Áp dụng"
                              X: =25
                              Y: =36
                        - RadioKB_LoaiTru:
                            Control: Classic/Radio@2.3.0
                            Properties:
                              BorderColor: =RGBA(0, 0, 0, 0)
                              Default: |-
                                =
                                If(IsBlank(varMaDKien) Or varXoaKB, "",LookUp(DL_DIEUKIEN_APDUNG_LOAI, MA_DIEU_KIEN =varMaDKien  && THANH_PHAN = "KB" && AP_DUNG = "2" ).TEN_KIEU )
                              DisplayMode: =If(varDaGhi,DisplayMode.Disabled,DisplayMode.Edit)
                              Font: =Font.'Open Sans'
                              HoverColor: =RGBA(0, 0, 0, 1)
                              Items: |-
                                =[{Text:"Một phần", ID: 2}]
                              Items.Value: =Text
                              OnSelect: =true
                              RadioBorderColor: =RGBA(0, 84, 148, 1)
                              RadioSelectionFill: =RGBA(0, 0, 0, 1)
                              Size: =11
                              X: =41
                              Y: =295
                        - GalleryKB_LoaiTru:
                            Control: Gallery@2.15.0
                            Variant: Vertical
                            Properties:
                              BorderColor: =RGBA(180, 214, 250, 1)
                              BorderThickness: =1
                              Height: =156
                              Items: =tmpLoaitruKB
                              TemplateSize: =46
                              Visible: =If(RadioKB_LoaiTru.Selected.ID = 2 , true)
                              Width: =962
                              X: =251
                              Y: =295
                            Children:
                              - DropKB_LoaiTru:
                                  Control: Classic/DropDown@2.3.1
                                  Properties:
                                    BorderColor: =RGBA(180, 214, 250, 1)
                                    ChevronBackground: =RGBA(255, 255, 255, 1)
                                    ChevronFill: =RGBA(180, 214, 250, 1)
                                    ChevronHoverBackground: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                                    ChevronHoverFill: =RGBA(255, 255, 255, 1)
                                    Default: =ThisItem.cr282_ten_tieu_chi
                                    DisabledBorderColor: =RGBA(204, 228, 246, 1)
                                    DisabledFill: =RGBA(230, 230, 230, 1)
                                    DisplayMode: =If(varDaGhi,DisplayMode.Disabled,DisplayMode.Edit)
                                    Font: =Font.'Open Sans'
                                    HoverFill: =RGBA(186, 202, 226, 1)
                                    Items: =Filter(DM_TIEU_CHI_APDUNGS, LOAI = "KB")
                                    Items.Value: =cr282_ten_chi_tieu
                                    OnChange: =Reset(ComboBoxGTKB_LT)
                                    OnSelect: =
                                    PressedColor: =RGBA(255, 255, 255, 1)
                                    PressedFill: =RGBA(0, 18, 107, 1)
                                    SelectionColor: =RGBA(255, 255, 255, 1)
                                    SelectionFill: =RGBA(56, 96, 178, 1)
                                    Size: =11
                                    Width: =200
                                    X: =1
                              - ComboBoxGTKB_LT:
                                  Control: Classic/ComboBox@2.4.0
                                  Properties:
                                    BorderColor: =RGBA(180, 214, 250, 1)
                                    ChevronBackground: =RGBA(255, 255, 255, 1)
                                    ChevronFill: =RGBA(180, 214, 250, 1)
                                    ChevronHoverBackground: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                                    ChevronHoverFill: =RGBA(255, 255, 255, 1)
                                    DefaultSelectedItems: =ThisItem.group_loaitru_kb
                                    DisabledBorderColor: =RGBA(204, 228, 246, 1)
                                    DisabledFill: =RGBA(230, 230, 230, 1)
                                    DisplayFields: =["cr282_ten_gia_tri"]
                                    DisplayMode: =If(varDaGhi,DisplayMode.Disabled,DisplayMode.Edit)
                                    Font: =Font.'Open Sans'
                                    HoverFill: =RGBA(186, 202, 226, 1)
                                    IsSearchable: =false
                                    Items: =Filter( tmpDsGiatri, Loai = DropKB_LoaiTru.Selected.MA_CHI_TIEU)
                                    OnSelect: =Select(Parent)
                                    PressedColor: =RGBA(255, 255, 255, 1)
                                    PressedFill: =RGBA(0, 18, 107, 1)
                                    SearchFields: =["cr282_ten_gia_tri"]
                                    SelectionColor: =RGBA(255, 255, 255, 1)
                                    SelectionFill: =RGBA(56, 96, 178, 1)
                                    Size: =11
                                    Width: =643
                                    X: =215
                              - Button5_16:
                                  Control: Classic/Button@2.2.0
                                  Properties:
                                    BorderColor: =ColorFade(Self.Fill, -15%)
                                    Color: =RGBA(255, 255, 255, 1)
                                    DisabledBorderColor: =RGBA(166, 166, 166, 1)
                                    DisplayMode: =If(varDaGhi,DisplayMode.Disabled,DisplayMode.Edit)
                                    Fill: =RGBA(56, 96, 178, 1)
                                    Font: =Font.'Open Sans'
                                    Height: =28
                                    HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                                    HoverColor: =RGBA(255, 255, 255, 1)
                                    HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                                    OnSelect: =RemoveIf(tmpLoaitruKB, cr282_id=ThisItem.cr282_id)
                                    PressedBorderColor: =Self.Fill
                                    PressedColor: =Self.Fill
                                    PressedFill: =Self.Color
                                    Size: =11
                                    Text: ="Xoá"
                                    Width: =73
                                    X: =877
                                    Y: =3
                              - TextInput4:
                                  Control: Classic/TextInput@2.3.2
                                  Properties:
                                    BorderColor: =RGBA(0, 18, 107, 1)
                                    Default: =ThisItem.cr282_id
                                    Font: =Font.'Open Sans'
                                    HoverBorderColor: =RGBA(0, 18, 107, 1)
                                    HoverFill: =RGBA(186, 202, 226, 1)
                                    OnSelect: =Select(Parent)
                                    Visible: =false
                                    X: =231
                                    Y: =5
                        - Label7_7:
                            Control: Label@2.5.1
                            Properties:
                              BorderColor: =RGBA(0, 18, 107, 1)
                              Font: =Font.'Open Sans'
                              FontWeight: =FontWeight.Bold
                              Size: =11
                              Text: ="Loại trừ"
                              Width: =81
                              X: =25
                              Y: =255
                        - Button3_7:
                            Control: Classic/Button@2.2.0
                            Properties:
                              BorderColor: =ColorFade(Self.Fill, -15%)
                              Color: =RGBA(255, 255, 255, 1)
                              DisabledBorderColor: =RGBA(166, 166, 166, 1)
                              DisplayMode: =If(varDaGhi,DisplayMode.Disabled,DisplayMode.Edit)
                              Fill: =RGBA(56, 96, 178, 1)
                              Font: =Font.'Open Sans'
                              Height: =25
                              HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                              HoverColor: =RGBA(255, 255, 255, 1)
                              HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                              OnSelect: |-
                                =
                                Collect(
                                    tmpApdungKB,
                                    [{cr282_id:Value( Max (tmpApdungKB, cr282_id) + 1)}]
                                );
                              PressedBorderColor: =Self.Fill
                              PressedColor: =Self.Fill
                              PressedFill: =Self.Color
                              Size: =11
                              Text: ="Thêm mới"
                              Visible: =If(RadioKB.Selected.ID = 2, true)
                              Width: =91
                              X: =253.2
                              Y: =11
                        - Button3_8:
                            Control: Classic/Button@2.2.0
                            Properties:
                              BorderColor: =ColorFade(Self.Fill, -15%)
                              Color: =RGBA(255, 255, 255, 1)
                              DisabledBorderColor: =RGBA(166, 166, 166, 1)
                              DisplayMode: =If(varDaGhi,DisplayMode.Disabled,DisplayMode.Edit)
                              Fill: =RGBA(56, 96, 178, 1)
                              Font: =Font.'Open Sans'
                              Height: =25
                              HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                              HoverColor: =RGBA(255, 255, 255, 1)
                              HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                              OnSelect: |-
                                =


                                Collect(
                                    tmpLoaitruKB,
                                    [{cr282_id:Value( Max (tmpLoaitruKB, cr282_id) + 1)}]
                                );
                              PressedBorderColor: =Self.Fill
                              PressedColor: =Self.Fill
                              PressedFill: =Self.Color
                              Size: =11
                              Text: ="Thêm mới"
                              Visible: =If(RadioKB_LoaiTru.Selected.ID = 2 , true)
                              Width: =91
                              X: =254
                              Y: =241
                        - BadgeCanvas1_39:
                            Control: Badge@0.0.24
                            Properties:
                              Content: =""
                              Height: =27
                              Visible: =If(RadioKB.Selected.ID = 2 , true)
                              Width: =962
                              X: =252
                              Y: =49
                        - Label11_3:
                            Control: Label@2.5.1
                            Properties:
                              Align: =Align.Center
                              BorderColor: =RGBA(0, 18, 107, 1)
                              Font: =Font.'Open Sans'
                              FontWeight: =FontWeight.Bold
                              Height: =27
                              Size: =11
                              Text: ="Tiêu chí"
                              Visible: =If(RadioKB.Selected.ID = 2 , true)
                              Width: =203
                              X: =253
                              Y: =49
                        - Label11_4:
                            Control: Label@2.5.1
                            Properties:
                              Align: =Align.Center
                              BorderColor: =RGBA(0, 18, 107, 1)
                              Font: =Font.'Open Sans'
                              FontWeight: =FontWeight.Bold
                              Height: =27
                              Size: =11
                              Text: ="Giá trị"
                              Visible: =If(RadioKB.Selected.ID = 2 , true)
                              Width: =642
                              X: =472
                              Y: =49
                        - BadgeCanvas1_40:
                            Control: Badge@0.0.24
                            Properties:
                              Content: =""
                              Height: =27
                              Visible: =If(RadioKB_LoaiTru.Selected.ID = 2 , true)
                              Width: =962
                              X: =252
                              Y: =268
                        - Label11_5:
                            Control: Label@2.5.1
                            Properties:
                              Align: =Align.Center
                              BorderColor: =RGBA(0, 18, 107, 1)
                              Font: =Font.'Open Sans'
                              FontWeight: =FontWeight.Bold
                              Height: =27
                              Size: =11
                              Text: ="Giá trị"
                              Visible: =If(RadioKB_LoaiTru.Selected.ID = 2 , true)
                              Width: =642
                              X: =472
                              Y: =268
                        - Label11_6:
                            Control: Label@2.5.1
                            Properties:
                              Align: =Align.Center
                              BorderColor: =RGBA(0, 18, 107, 1)
                              Font: =Font.'Open Sans'
                              FontWeight: =FontWeight.Bold
                              Height: =27
                              Size: =11
                              Text: ="Tiêu chí"
                              Visible: =If(RadioKB_LoaiTru.Selected.ID = 2 , true)
                              Width: =203
                              X: =254
                              Y: =268
                        - Icon2:
                            Control: Classic/Icon@2.5.0
                            Properties:
                              BorderColor: =RGBA(0, 0, 0, 1)
                              Color: =RGBA(0, 0, 0, 1)
                              Height: =20
                              Icon: =Icon.Cancel
                              OnSelect: |-
                                =Reset(RadioKB_LoaiTru);
                                Set(varXoaKB, true);
                              Width: =20
                              X: =99
                              Y: =265
      - Button6_11:
          Control: Classic/Button@2.2.0
          Properties:
            BorderColor: =ColorFade(Self.Fill, -15%)
            Color: =RGBA(255, 255, 255, 1)
            DisabledBorderColor: =RGBA(166, 166, 166, 1)
            DisplayMode: =If(varDaGhi,DisplayMode.Disabled,DisplayMode.Edit)
            Fill: =RGBA(56, 96, 178, 1)
            Font: =Font.'Open Sans'
            HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
            HoverColor: =RGBA(255, 255, 255, 1)
            HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
            OnSelect: "=//Xu ly thong tin chung\nUpdateContext({errorMsgDK: \"\"});\n//Clear(tmpCheckDup);\nIf(\n    IsBlank(DataCardID.Text),\n    UpdateContext(\n        {\n            newIDMaDD: If(\n                CountIf(\n                    DL_DIEUKIEN_APDUNG,\n                    true\n                ) = 0,\n                1,\n                Max(\n                    DL_DIEUKIEN_APDUNG,\n                    ID\n                ) + 1\n            )\n        }\n    ),\n    UpdateContext({newIDMaDD: Value(DataCardID.Text)})\n);\nIf(\n    IsBlank(DataCardValueMaDK.Text),\n    UpdateContext(\n        {\n            newMaDK: Concatenate(\n                \"AD\",\n                If(\n                    newIDMaDD < 10,\n                    \"000\",\n                    If(\n                        newIDMaDD < 100 && newIDMaDD >= 10,\n                        \"00\",\n                        If(\n                            newIDMaDD < 1000 && newIDMaDD >= 100,\n                            \"0\",\n                            \"\"\n                        )\n                    )\n                ),\n                Text(newIDMaDD)\n            )\n        }\n    ),\n    UpdateContext({newMaDK: DataCardValueMaDK.Text})\n);\nIf(\n    IsBlank(DateValueTU.SelectedDate),\n    UpdateContext({errorMsgDK: \"Hiệu lực từ là bắt buộc\"})\n);\nIf(\n    IsBlank(errorMsgDK) && !IsBlank(DateValueDen.SelectedDate) && DateValueTU.SelectedDate > DateValueDen.SelectedDate,\n    UpdateContext({errorMsgDK: \"Hiệu lực đến phải sau hiệu lực từ\"})\n);\n//Kiem tra tieu chi la duy nhat\n//San pham - ap dung\nIf(\n    IsBlank(errorMsgDK) && CountRows(tmpApdungSp) > 0,\n    Clear(errorCol);\n    Clear(tmpCheckDup);\n    ForAll(\n        Gallery5.AllItems As kh,\n        Collect(\n            tmpCheckDup,\n            {\n                Type: \"SP\",\n                Value: kh.DropQTich.Selected.MA_CHI_TIEU\n            }\n        );\n    );\n    ForAll(\n        Gallery5.AllItems As kh,\n        If(\n            CountIf(\n                tmpCheckDup,\n                Type = \"SP\" && Value = kh.DropQTich.Selected.MA_CHI_TIEU\n            ) > 1,\n            Collect(\n                errorCol,\n                {Message: \"Trùng tiêu chí áp dụng sản phẩm\"}\n            )\n        )\n    );\n    If(\n        !IsEmpty(errorCol),\n        UpdateContext({errorMsgDK: First(errorCol).Message})\n    )\n);\n//san pham - loai tru\nIf(\n    IsBlank(errorMsgDK) && CountRows(tmpLoaitruSp) > 0,\n    Clear(errorCol);\n    Clear(tmpCheckDup);\n    ForAll(\n        Gallery5_1.AllItems As kh,\n        Collect(\n            tmpCheckDup,\n            {\n                Type: \"KH\",\n                Value: kh.DropQTich_1.Selected.MA_CHI_TIEU\n            }\n        );\n    );\n    ForAll(\n        Gallery5_1.AllItems As kh,\n        If(\n            CountIf(\n                tmpCheckDup,\n                Type = \"KH\" && Value = kh.DropQTich_1.Selected.MA_CHI_TIEU\n            ) > 1,\n            Collect(\n                errorCol,\n                {Message: \"Trùng tiêu chí loại trừ sản phẩm\"}\n            )\n        )\n    );\n    If(\n        !IsEmpty(errorCol),\n        UpdateContext({errorMsgDK: First(errorCol).Message})\n    )\n);\n//Kenh ban\n//Kenh ban - ap dung\nIf(\n    IsBlank(errorMsgDK) && CountRows(tmpApdungKB) > 0,\n    Clear(errorCol);\n    Clear(tmpCheckDup);\n    ForAll(\n        GalleryKB.AllItems As kh,\n        Collect(\n            tmpCheckDup,\n            {\n                Type: \"KB\",\n                Value: kh.DropKB.Selected.MA_CHI_TIEU\n            }\n        );\n    );\n    ForAll(\n        GalleryKB.AllItems As kh,\n        If(\n            CountIf(\n                tmpCheckDup,\n                Type = \"KB\" && Value = kh.DropKB.Selected.MA_CHI_TIEU\n            ) > 1,\n            Collect(\n                errorCol,\n                {Message: \"Trùng tiêu chí áp dụng kênh bán\"}\n            )\n        )\n    );\n    If(\n        !IsEmpty(errorCol),\n        UpdateContext({errorMsgDK: First(errorCol).Message})\n    )\n);\n//Kenh ban - loai tru\nIf(\n    IsBlank(errorMsgDK) && CountRows(tmpLoaitruKB) > 0,\n    Clear(errorCol);\n    Clear(tmpCheckDup);\n    ForAll(\n        GalleryKB_LoaiTru.AllItems As kh,\n        Collect(\n            tmpCheckDup,\n            {\n                Type: \"KB\",\n                Value: kh.DropKB_LoaiTru.Selected.MA_CHI_TIEU\n            }\n        );\n    );\n    ForAll(\n        GalleryKB_LoaiTru.AllItems As kh,\n        If(\n            CountIf(\n                tmpCheckDup,\n                Type = \"KB\" && Value = kh.DropKB_LoaiTru.Selected.MA_CHI_TIEU\n            ) > 1,\n            Collect(\n                errorCol,\n                {Message: \"Trùng tiêu chí loại trừ kênh bán\"}\n            )\n        )\n    );\n    If(\n        !IsEmpty(errorCol),\n        UpdateContext({errorMsgDK: First(errorCol).Message})\n    )\n);\n//End kenh ban\n//Khach hang - ap dung\nIf(\n    IsBlank(errorMsgDK) && CountRows(tmpApdungKH) > 0,\n    Clear(errorCol);\n    Clear(tmpCheckDup);\n    ForAll(\n        GalleryKH_1.AllItems As kh,\n        Collect(\n            tmpCheckDup,\n            {\n                Type: \"KH\",\n                Value: kh.DropKH.Selected.MA_CHI_TIEU\n            }\n        );\n    );\n    ForAll(\n        GalleryKH_1.AllItems As kh,\n        If(\n            CountIf(\n                tmpCheckDup,\n                Type = \"KH\" && Value = kh.DropKH.Selected.MA_CHI_TIEU\n            ) > 1,\n            Collect(\n                errorCol,\n                {Message: \"Trùng tiêu chí áp dụng khách hàng\"}\n            )\n        )\n    );\n    If(\n        !IsEmpty(errorCol),\n        UpdateContext({errorMsgDK: First(errorCol).Message})\n    )\n);\n//Khach hang - loai tru\nIf(\n    IsBlank(errorMsgDK) && CountRows(tmpLoaitruKH) > 0,\n    Clear(errorCol);\n    Clear(tmpCheckDup);\n    ForAll(\n        GalleryKH_LoaiTru.AllItems As kh,\n        Collect(\n            tmpCheckDup,\n            {\n                Type: \"KH\",\n                Value: kh.DropKH_LoaiTru.Selected.MA_CHI_TIEU\n            }\n        );\n    );\n    ForAll(\n        GalleryKH_LoaiTru.AllItems As kh,\n        If(\n            CountIf(\n                tmpCheckDup,\n                Type = \"KH\" && Value = kh.DropKH_LoaiTru.Selected.MA_CHI_TIEU\n            ) > 1,\n            Collect(\n                errorCol,\n                {Message: \"Trùng tiêu chí loại trừ khách hàng\"}\n            )\n        )\n    );\n    If(\n        !IsEmpty(errorCol),\n        UpdateContext({errorMsgDK: First(errorCol).Message})\n    )\n);\n//pham vi - ap dung\nIf(\n    IsBlank(errorMsgDK) && CountRows(tmpApdungPV) > 0,\n    Clear(errorCol);\n    Clear(tmpCheckDup);\n    ForAll(\n        GalleryPV_1.AllItems As kh,\n        Collect(\n            tmpCheckDup,\n            {\n                Type: \"PV\",\n                Value: kh.DropPV.Selected.MA_CHI_TIEU\n            }\n        );\n    );\n    ForAll(\n        GalleryPV_1.AllItems As kh,\n        If(\n            CountIf(\n                tmpCheckDup,\n                Type = \"PV\" && Value = kh.DropPV.Selected.MA_CHI_TIEU\n            ) > 1,\n            Collect(\n                errorCol,\n                {Message: \"Trùng tiêu chí áp dụng phạm vi\"}\n            )\n        )\n    );\n    If(\n        !IsEmpty(errorCol),\n        UpdateContext({errorMsgDK: First(errorCol).Message})\n    )\n);\n//Pham vi - loai tru\nIf(\n    IsBlank(errorMsgDK) && CountRows(tmpLoaitruPV) > 0,\n    Clear(errorCol);\n    Clear(tmpCheckDup);\n    ForAll(\n        GalleryPV_LoaiTru.AllItems As kh,\n        Collect(\n            tmpCheckDup,\n            {\n                Type: \"PV\",\n                Value: kh.DropPV_LoaiTru.Selected.MA_CHI_TIEU\n            }\n        );\n    );\n    ForAll(\n        GalleryPV_LoaiTru.AllItems As kh,\n        If(\n            CountIf(\n                tmpCheckDup,\n                Type = \"PV\" && Value = kh.DropPV_LoaiTru.Selected.MA_CHI_TIEU\n            ) > 1,\n            Collect(\n                errorCol,\n                {Message: \"Trùng tiêu chí loại trừ phạm vi\"}\n            )\n        )\n    );\n    If(\n        !IsEmpty(errorCol),\n        UpdateContext({errorMsgDK: First(errorCol).Message})\n    )\n);\nIf(\n    !IsBlank(errorMsgDK),\n    Notify(\n        errorMsgDK,\n        NotificationType.Error,\n        800\n    ),\n    \n    SubmitForm(FormDKChung);\n    UpdateContext({rcd: newMaDK});\n    EditForm(FormDKChung);\n    Refresh(DL_DIEUKIEN_APDUNG_LOAI);\n    RemoveIf(\n        DL_DIEUKIEN_APDUNG_LOAI,\n        MA_DIEU_KIEN = newMaDK\n    );\n    Refresh(DL_DIEUKIEN_APDUNG_LOAI_CT);\n    RemoveIf(\n        DL_DIEUKIEN_APDUNG_LOAI_CT,\n        MA_DIEU_KIEN = newMaDK\n    );\n    Set(\n        varIdAdSP,\n        0\n    );\n    Set(\n        varIdLtSp,\n        0\n    );\n    // T.ANH LƯU SAN PHAM\n// lưu dữ liệu ở bảng  DL_DIEUKIEN_APDUNG_LOAI\n// THÊM DỮ LIỆU ÁP DỤNG\nSet(\n        varIdAdSP,\n        Max(\n            DL_DIEUKIEN_APDUNG_LOAI,\n            ID\n        ) + 1\n    );\n    Patch(\n        DL_DIEUKIEN_APDUNG_LOAI,\n        Defaults(DL_DIEUKIEN_APDUNG_LOAI),\n        {\n            ID: varIdAdSP,\n            MA_DIEU_KIEN: newMaDK,\n            THANH_PHAN: \"SP\",\n            AP_DUNG: \"1\",\n            KIEU: Radio2.Selected.ID,\n            TEN_KIEU: Radio2.Selected.Text\n        }\n    );\n    \n// THÊM DỮ LIỆU LOẠI TRỪ\nSet(\n        varIdLtSp,\n        Max(\n            DL_DIEUKIEN_APDUNG_LOAI,\n            ID\n        ) + 1\n    );\n    If(\n        !IsBlank(Radio2_1.Selected.Text),\n        Patch(\n            DL_DIEUKIEN_APDUNG_LOAI,\n            Defaults(DL_DIEUKIEN_APDUNG_LOAI),\n            {\n                ID: varIdLtSp,\n                MA_DIEU_KIEN: newMaDK,\n                THANH_PHAN: \"SP\",\n                AP_DUNG: \"2\",\n                KIEU: Radio2_1.Selected.ID,\n                TEN_KIEU: Radio2_1.Selected.Text\n            }\n        )\n    );\n    \n// lưu dữ liệu ở bảng chi tiết\n// lưu áp dụng\nIf(\n        Radio2.Selected.ID = 2,\n        ForAll(\n            Gallery5.AllItems As ad,\n            ForAll(\n                ad.ComboBox3.SelectedItems As gt,\n                Patch(\n                    DL_DIEUKIEN_APDUNG_LOAI_CT,\n                    Defaults(DL_DIEUKIEN_APDUNG_LOAI_CT),\n                    {\n                        ID: Value(ad.TextInput1.Text),\n                        ID_LOAI: varIdAdSP,\n                        MA_DIEU_KIEN: newMaDK,\n                        THANH_PHAN: \"SP\",\n                        AP_DUNG: \"1\",\n                        KIEU: Radio2.Selected.ID,\n                        MA_TIEU_CHI: ad.DropQTich.Selected.MA_CHI_TIEU,\n                        TEN_TIEU_CHI: ad.DropQTich.Selected.TEN_CHI_TIEU,\n                        MA_GIA_TRI: LookUp(\n                            tmpDsGiatri,\n                            cr282_ten_gia_tri = gt.cr282_ten_gia_tri && Loai = ad.DropQTich.Selected.MA_CHI_TIEU\n                        ).Ma,\n                        TEN_GIA_TRI: gt.cr282_ten_gia_tri,\n                        MA_PV_AD:PV_AD.Selected.ID,\n                        TEN_PV_AD:PV_AD.Selected.Text\n                    }\n                )\n            )\n        )\n    );\n    \n// lưu loại trừ\nIf(\n        Radio2_1.Selected.ID = 2,\n        ForAll(\n            Gallery5_1.AllItems As ad,\n            ForAll(\n                ad.ComboBox3_1.SelectedItems As gt,\n                Patch(\n                    DL_DIEUKIEN_APDUNG_LOAI_CT,\n                    Defaults(DL_DIEUKIEN_APDUNG_LOAI_CT),\n                    {\n                        ID: Value(TextInput2.Text),\n                        ID_LOAI: varIdAdSP,\n                        MA_DIEU_KIEN: newMaDK,\n                        THANH_PHAN: \"SP\",\n                        AP_DUNG: \"2\",\n                        KIEU: Radio2_1.Selected.ID,\n                        MA_TIEU_CHI: ad.DropQTich_1.Selected.MA_CHI_TIEU,\n                        TEN_TIEU_CHI: ad.DropQTich_1.Selected.TEN_CHI_TIEU,\n                        MA_GIA_TRI: LookUp(\n                            tmpDsGiatri,\n                            cr282_ten_gia_tri = gt.cr282_ten_gia_tri && Loai = ad.DropQTich_1.Selected.MA_CHI_TIEU\n                        ).Ma,\n                        TEN_GIA_TRI: gt.cr282_ten_gia_tri,\n                        MA_PV_AD:PV_AD_1.Selected.ID,\n                        TEN_PV_AD:PV_AD_1.Selected.Text\n                    }\n                )\n            )\n        )\n    );\n    \n// lưu dữ liệu ở bảng  DL_DIEUKIEN_APDUNG_LOAI KENH BAN\nSet(\n        varIdAdKB,\n        0\n    );\n    Set(\n        varIdLtKB,\n        0\n    );\n    Set(\n        varIdAdKB,\n        Max(\n            DL_DIEUKIEN_APDUNG_LOAI,\n            ID\n        ) + 1\n    );\n    // ÁP DỤNG\nPatch(\n        DL_DIEUKIEN_APDUNG_LOAI,\n        Defaults(DL_DIEUKIEN_APDUNG_LOAI),\n        {\n            ID: varIdAdKB,\n            MA_DIEU_KIEN: newMaDK,\n            THANH_PHAN: \"KB\",\n            AP_DUNG: \"1\",\n            KIEU: RadioKB.Selected.ID,\n            TEN_KIEU: RadioKB.Selected.Text\n        }\n    );\n    // LOẠI TRỪ\nIf(\n        !IsBlank(RadioKB_LoaiTru.Selected.Text),\n        Patch(\n            DL_DIEUKIEN_APDUNG_LOAI,\n            Set(\n                varIdLtKB,\n                Max(\n                    DL_DIEUKIEN_APDUNG_LOAI,\n                    ID\n                ) + 1\n            );\n            Defaults(DL_DIEUKIEN_APDUNG_LOAI),\n            {\n                ID: Max(\n                    DL_DIEUKIEN_APDUNG_LOAI,\n                    ID\n                ) + 1,\n                MA_DIEU_KIEN: newMaDK,\n                THANH_PHAN: \"KB\",\n                AP_DUNG: \"2\",\n                KIEU: RadioKB_LoaiTru.Selected.ID,\n                TEN_KIEU: RadioKB_LoaiTru.Selected.Text\n            }\n        )\n    );\n    \n// lưu dữ liệu ở bảng chi tiết\nIf(\n        RadioKB.Selected.ID = 2 && CountRows(tmpApdungKB) > 0,\n        ForAll(\n            GalleryKB.AllItems As kh,\n            ForAll(\n                kh.ComboBoxGTKB.SelectedItems As gt,\n                Patch(\n                    DL_DIEUKIEN_APDUNG_LOAI_CT,\n                    Defaults(DL_DIEUKIEN_APDUNG_LOAI_CT),\n                    {\n                        ID: Value( kh.TextInput3.Text),\n                        ID_LOAI: varIdAdKB,\n                        MA_DIEU_KIEN: newMaDK,\n                        THANH_PHAN: \"KB\",\n                        AP_DUNG: \"1\",\n                        KIEU: RadioKB.Selected.ID,\n                        MA_TIEU_CHI: kh.DropKB.Selected.MA_CHI_TIEU,\n                        TEN_TIEU_CHI: kh.DropKB.Selected.TEN_CHI_TIEU,\n                        MA_GIA_TRI: LookUp(\n                            tmpDsGiatri,\n                            cr282_ten_gia_tri = gt.cr282_ten_gia_tri && Loai = kh.DropKB.Selected.MA_CHI_TIEU\n                        ).Ma,\n                        TEN_GIA_TRI: gt.cr282_ten_gia_tri\n                    }\n                )\n            )\n        )\n    );\n    \n// lưu dữ liệu ở bảng chi tiết loai trừ\nIf(\n        RadioKB_LoaiTru.Selected.ID = 2 && CountRows(tmpLoaitruKB) > 0,\n        ForAll(\n            GalleryKB_LoaiTru.AllItems As kh,\n            ForAll(\n                kh.ComboBoxGTKB_LT.SelectedItems As gt,\n                Patch(\n                    DL_DIEUKIEN_APDUNG_LOAI_CT,\n                    Defaults(DL_DIEUKIEN_APDUNG_LOAI_CT),\n                    {\n                        ID: Value(kh.TextInput4.Text),\n                        ID_LOAI: varIdLtKB,\n                        MA_DIEU_KIEN: newMaDK,\n                        THANH_PHAN: \"KB\",\n                        AP_DUNG: \"2\",\n                        KIEU: RadioKB_LoaiTru.Selected.ID,\n                        MA_TIEU_CHI: kh.DropKB_LoaiTru.Selected.MA_CHI_TIEU,\n                        TEN_TIEU_CHI: kh.DropKB_LoaiTru.Selected.TEN_CHI_TIEU,\n                        MA_GIA_TRI: LookUp(\n                            tmpDsGiatri,\n                            cr282_ten_gia_tri = gt.cr282_ten_gia_tri && Loai = kh.DropKB_LoaiTru.Selected.MA_CHI_TIEU\n                        ).Ma,\n                        TEN_GIA_TRI: gt.cr282_ten_gia_tri\n                    }\n                )\n            )\n        )\n    );\n    \n//End kenh ban\n// lưu dữ liệu ở bảng  DL_DIEUKIEN_APDUNG_LOAI KHANH HANG\nSet(\n        varIdAdKH,\n        0\n    );\n    Set(\n        varIdLtKH,\n        0\n    );\n    Set(\n        varIdAdKH,\n        Max(\n            DL_DIEUKIEN_APDUNG_LOAI,\n            ID\n        ) + 1\n    );\n    Patch(\n        DL_DIEUKIEN_APDUNG_LOAI,\n        Defaults(DL_DIEUKIEN_APDUNG_LOAI),\n        {\n            ID: varIdAdKH,\n            MA_DIEU_KIEN: newMaDK,\n            THANH_PHAN: \"KH\",\n            AP_DUNG: \"1\",\n            KIEU: RadioKH.Selected.ID,\n            TEN_KIEU: RadioKH.Selected.Text\n        }\n    );\n    If(\n        !IsBlank(RadioKH_LoaiTru.Selected.Text),\n        Patch(\n            DL_DIEUKIEN_APDUNG_LOAI,\n            Set(\n                varIdLtKH,\n                Max(\n                    DL_DIEUKIEN_APDUNG_LOAI,\n                    ID\n                ) + 1\n            );\n            Defaults(DL_DIEUKIEN_APDUNG_LOAI),\n            {\n                ID: Max(\n                    DL_DIEUKIEN_APDUNG_LOAI,\n                    ID\n                ) + 1,\n                MA_DIEU_KIEN: newMaDK,\n                THANH_PHAN: \"KH\",\n                AP_DUNG: \"2\",\n                KIEU: RadioKH_LoaiTru.Selected.ID,\n                TEN_KIEU: RadioKB_LoaiTru.Selected.Text\n            }\n        )\n    );\n    \n// lưu dữ liệu ở bảng chi tiết\nIf(\n        RadioKH.Selected.ID = 2 && CountRows(tmpApdungKH) > 0,\n        ForAll(\n            GalleryKH_1.AllItems As kh,\n            ForAll(\n                kh.ComboBoxGTKH.SelectedItems As gt,\n                Patch(\n                    DL_DIEUKIEN_APDUNG_LOAI_CT,\n                    Defaults(DL_DIEUKIEN_APDUNG_LOAI_CT),\n                    {\n                        ID: Value(kh.TextInput5.Text),\n                        ID_LOAI: varIdAdKH,\n                        MA_DIEU_KIEN: newMaDK,\n                        THANH_PHAN: \"KH\",\n                        AP_DUNG: \"1\",\n                        KIEU: RadioKH.Selected.ID,\n                        MA_TIEU_CHI: kh.DropKH.Selected.MA_CHI_TIEU,\n                        TEN_TIEU_CHI: kh.DropKH.Selected.TEN_CHI_TIEU,\n                        MA_GIA_TRI: LookUp(\n                            tmpDsGiatri,\n                            cr282_ten_gia_tri = gt.cr282_ten_gia_tri && Loai = kh.DropKH.Selected.MA_CHI_TIEU\n                        ).Ma,\n                        TEN_GIA_TRI: gt.cr282_ten_gia_tri\n                    }\n                )\n            )\n        )\n    );\n    \n// lưu dữ liệu ở bảng chi tiết loai tru\nIf(\n        RadioKH_LoaiTru.Selected.ID = 2 && CountRows(tmpLoaitruKH) > 0,\n        ForAll(\n            GalleryKH_LoaiTru.AllItems As kh,\n            ForAll(\n                kh.ComboBoxGTKH_LT.SelectedItems As gt,\n                Patch(\n                    DL_DIEUKIEN_APDUNG_LOAI_CT,\n                    Defaults(DL_DIEUKIEN_APDUNG_LOAI_CT),\n                    {\n                        ID: Value(kh.TextInput6.Text) ,\n                        ID_LOAI: varIdLtKH,\n                        MA_DIEU_KIEN: newMaDK,\n                        THANH_PHAN: \"KH\",\n                        AP_DUNG: \"2\",\n                        KIEU: RadioKH_LoaiTru.Selected.ID,\n                        MA_TIEU_CHI: kh.DropKH_LoaiTru.Selected.MA_CHI_TIEU,\n                        TEN_TIEU_CHI: kh.DropKH_LoaiTru.Selected.TEN_CHI_TIEU,\n                        MA_GIA_TRI: LookUp(\n                            tmpDsGiatri,\n                            cr282_ten_gia_tri = gt.cr282_ten_gia_tri && Loai = kh.DropKH_LoaiTru.Selected.MA_CHI_TIEU\n                        ).Ma,\n                        TEN_GIA_TRI: gt.cr282_ten_gia_tri\n                    }\n                )\n            )\n        )\n    );\n    \n// lưu dữ liệu ở bảng  DL_DIEUKIEN_APDUNG_LOAI PHAM_VI\nSet(\n        varIdAdPV,\n        0\n    );\n    Set(\n        varIdLtPV,\n        0\n    );\n    Set(\n        varIdAdPV,\n        Max(\n            DL_DIEUKIEN_APDUNG_LOAI,\n            ID\n        ) + 1\n    );\n    Patch(\n        DL_DIEUKIEN_APDUNG_LOAI,\n        Defaults(DL_DIEUKIEN_APDUNG_LOAI),\n        {\n            ID: varIdAdPV,\n            MA_DIEU_KIEN: newMaDK,\n            THANH_PHAN: \"PV\",\n            AP_DUNG: \"1\",\n            KIEU: RadioPV.Selected.ID,\n            TEN_KIEU: RadioPV.Selected.Text\n        }\n    );\n    If(\n        !IsBlank(RadioPV_LoaiTru.Selected.Text),\n        Patch(\n            DL_DIEUKIEN_APDUNG_LOAI,\n            Set(\n                varIdLtPV,\n                Max(\n                    DL_DIEUKIEN_APDUNG_LOAI,\n                    ID\n                ) + 1\n            );\n            Defaults(DL_DIEUKIEN_APDUNG_LOAI),\n            {\n                ID: Max(\n                    DL_DIEUKIEN_APDUNG_LOAI,\n                    ID\n                ) + 1,\n                MA_DIEU_KIEN: newMaDK,\n                THANH_PHAN: \"PV\",\n                AP_DUNG: \"2\",\n                KIEU: RadioPV_LoaiTru.Selected.ID,\n                TEN_KIEU: RadioPV_LoaiTru.Selected.Text\n            }\n        )\n    );\n    \n// lưu dữ liệu ở bảng chi tiết\nIf(\n        RadioPV.Selected.ID = 2 && CountRows(tmpApdungPV) > 0,\n        ForAll(\n            GalleryPV_1.AllItems As pv,\n            ForAll(\n                pv.ComboBoxGTPV.SelectedItems As gt,\n                Patch(\n                    DL_DIEUKIEN_APDUNG_LOAI_CT,\n                    Defaults(DL_DIEUKIEN_APDUNG_LOAI_CT),\n                    {\n                        ID: Value(pv.TextInput7.Text),\n                        ID_LOAI: varIdAdPV,\n                        MA_DIEU_KIEN: newMaDK,\n                        THANH_PHAN: \"PV\",\n                        AP_DUNG: \"1\",\n                        KIEU: RadioPV.Selected.ID,\n                        MA_TIEU_CHI: pv.DropPV.Selected.MA_CHI_TIEU,\n                        TEN_TIEU_CHI: pv.DropPV.Selected.TEN_CHI_TIEU,\n                        MA_GIA_TRI: LookUp(\n                            tmpDsGiatri,\n                            cr282_ten_gia_tri = gt.cr282_ten_gia_tri && Loai = pv.DropPV.Selected.MA_CHI_TIEU\n                        ).Ma,\n                        TEN_GIA_TRI: gt.cr282_ten_gia_tri\n                    }\n                )\n            )\n        )\n    );\n    \n// lưu dữ liệu ở bảng chi tiết loai trừ\nIf(\n        RadioPV_LoaiTru.Selected.ID = 2 && CountRows(tmpLoaitruPV) > 0,\n        ForAll(\n            GalleryPV_LoaiTru.AllItems As kh,\n            ForAll(\n                kh.ComboBoxGTPV_LT.SelectedItems As gt,\n                Patch(\n                    DL_DIEUKIEN_APDUNG_LOAI_CT,\n                    Defaults(DL_DIEUKIEN_APDUNG_LOAI_CT),\n                    {\n                        ID: Value(kh.TextInput8.Text),\n                        ID_LOAI: varIdLtPV,\n                        MA_DIEU_KIEN: newMaDK,\n                        THANH_PHAN: \"PV\",\n                        AP_DUNG: \"2\",\n                        KIEU: RadioPV_LoaiTru.Selected.ID,\n                        MA_TIEU_CHI: kh.DropPV_LoaiTru.Selected.MA_CHI_TIEU,\n                        TEN_TIEU_CHI: kh.DropPV_LoaiTru.Selected.TEN_CHI_TIEU,\n                        MA_GIA_TRI: LookUp(\n                            tmpDsGiatri,\n                            cr282_ten_gia_tri = gt.cr282_ten_gia_tri && Loai = kh.DropPV_LoaiTru.Selected.MA_CHI_TIEU\n                        ).Ma,\n                        TEN_GIA_TRI: gt.cr282_ten_gia_tri\n                    }\n                )\n            )\n        )\n    );\n    Notify(\n        \"Lưu dữ liệu thành công\",\n        NotificationType.Success,\n        800\n    ); \n);\n"
            PressedBorderColor: =Self.Fill
            PressedColor: =Self.Fill
            PressedFill: =Self.Color
            Size: =11
            Text: ="Lưu điều kiện"
            Width: =122
            X: =1093
            Y: =728
      - Button6_12:
          Control: Classic/Button@2.2.0
          Properties:
            BorderColor: =ColorFade(Self.Fill, -15%)
            Color: =RGBA(255, 255, 255, 1)
            DisabledBorderColor: =RGBA(166, 166, 166, 1)
            Fill: =RGBA(56, 96, 178, 1)
            Font: =Font.'Open Sans'
            HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
            HoverColor: =RGBA(255, 255, 255, 1)
            HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
            OnSelect: =Back();
            PressedBorderColor: =Self.Fill
            PressedColor: =Self.Fill
            PressedFill: =Self.Color
            Size: =11
            Text: ="Quay lại"
            Width: =81
            X: =1005
            Y: =728
      - ButtonGhi:
          Control: Classic/Button@2.2.0
          Properties:
            BorderColor: =ColorFade(Self.Fill, -15%)
            Color: =RGBA(255, 255, 255, 1)
            DisabledBorderColor: =RGBA(166, 166, 166, 1)
            DisplayMode: =If(varDaGhi,DisplayMode.Disabled,DisplayMode.Edit)
            Fill: =RGBA(56, 96, 178, 1)
            Font: =Font.'Open Sans'
            HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
            HoverColor: =RGBA(255, 255, 255, 1)
            HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
            OnSelect: "=//Xu ly thong tin chung\n//Xu ly thong tin chung\nUpdateContext({errorMsgDK: \"\"});\n//Clear(tmpCheckDup);\nIf(\n    IsBlank(DataCardID.Text),\n    UpdateContext(\n        {\n            newIDMaDD: If(\n                CountIf(\n                    DL_DIEUKIEN_APDUNG,\n                    true\n                ) = 0,\n                1,\n                Max(\n                    DL_DIEUKIEN_APDUNG,\n                    ID\n                ) + 1\n            )\n        }\n    ),\n    UpdateContext({newIDMaDD: Value(DataCardID.Text)})\n);\nIf(\n    IsBlank(DataCardValueMaDK.Text),\n    UpdateContext(\n        {\n            newMaDK: Concatenate(\n                \"AD\",\n                If(\n                    newIDMaDD < 10,\n                    \"000\",\n                    If(\n                        newIDMaDD < 100 && newIDMaDD >= 10,\n                        \"00\",\n                        If(\n                            newIDMaDD < 1000 && newIDMaDD >= 100,\n                            \"0\",\n                            \"\"\n                        )\n                    )\n                ),\n                Text(newIDMaDD)\n            )\n        }\n    ),\n    UpdateContext({newMaDK: DataCardValueMaDK.Text})\n);\nIf(\n    IsBlank(DateValueTU.SelectedDate),\n    UpdateContext({errorMsgDK: \"Hiệu lực từ là bắt buộc\"})\n);\nIf(\n    IsBlank(errorMsgDK) && !IsBlank(DateValueDen.SelectedDate) && DateValueTU.SelectedDate > DateValueDen.SelectedDate,\n    UpdateContext({errorMsgDK: \"Hiệu lực đến phải sau hiệu lực từ\"})\n);\n//Kiem tra tieu chi la duy nhat\n//San pham - ap dung\nIf(\n    IsBlank(errorMsgDK) && CountRows(tmpApdungSp) > 0,\n    Clear(errorCol);\n    Clear(tmpCheckDup);\n    ForAll(\n        Gallery5.AllItems As kh,\n        Collect(\n            tmpCheckDup,\n            {\n                Type: \"SP\",\n                Value: kh.DropQTich.Selected.MA_CHI_TIEU\n            }\n        );\n    );\n    ForAll(\n        Gallery5.AllItems As kh,\n        If(\n            CountIf(\n                tmpCheckDup,\n                Type = \"SP\" && Value = kh.DropQTich.Selected.MA_CHI_TIEU\n            ) > 1,\n            Collect(\n                errorCol,\n                {Message: \"Trùng tiêu chí áp dụng sản phẩm\"}\n            )\n        )\n    );\n    If(\n        !IsEmpty(errorCol),\n        UpdateContext({errorMsgDK: First(errorCol).Message})\n    )\n);\n//san pham - loai tru\nIf(\n    IsBlank(errorMsgDK) && CountRows(tmpLoaitruSp) > 0,\n    Clear(errorCol);\n    Clear(tmpCheckDup);\n    ForAll(\n        Gallery5_1.AllItems As kh,\n        Collect(\n            tmpCheckDup,\n            {\n                Type: \"KH\",\n                Value: kh.DropQTich_1.Selected.MA_CHI_TIEU\n            }\n        );\n    );\n    ForAll(\n        Gallery5_1.AllItems As kh,\n        If(\n            CountIf(\n                tmpCheckDup,\n                Type = \"KH\" && Value = kh.DropQTich_1.Selected.MA_CHI_TIEU\n            ) > 1,\n            Collect(\n                errorCol,\n                {Message: \"Trùng tiêu chí loại trừ sản phẩm\"}\n            )\n        )\n    );\n    If(\n        !IsEmpty(errorCol),\n        UpdateContext({errorMsgDK: First(errorCol).Message})\n    )\n);\n//Kenh ban\n//Kenh ban - ap dung\nIf(\n    IsBlank(errorMsgDK) && CountRows(tmpApdungKB) > 0,\n    Clear(errorCol);\n    Clear(tmpCheckDup);\n    ForAll(\n        GalleryKB.AllItems As kh,\n        Collect(\n            tmpCheckDup,\n            {\n                Type: \"KB\",\n                Value: kh.DropKB.Selected.MA_CHI_TIEU\n            }\n        );\n    );\n    ForAll(\n        GalleryKB.AllItems As kh,\n        If(\n            CountIf(\n                tmpCheckDup,\n                Type = \"KB\" && Value = kh.DropKB.Selected.MA_CHI_TIEU\n            ) > 1,\n            Collect(\n                errorCol,\n                {Message: \"Trùng tiêu chí áp dụng kênh bán\"}\n            )\n        )\n    );\n    If(\n        !IsEmpty(errorCol),\n        UpdateContext({errorMsgDK: First(errorCol).Message})\n    )\n);\n//Kenh ban - loai tru\nIf(\n    IsBlank(errorMsgDK) && CountRows(tmpLoaitruKB) > 0,\n    Clear(errorCol);\n    Clear(tmpCheckDup);\n    ForAll(\n        GalleryKB_LoaiTru.AllItems As kh,\n        Collect(\n            tmpCheckDup,\n            {\n                Type: \"KB\",\n                Value: kh.DropKB_LoaiTru.Selected.MA_CHI_TIEU\n            }\n        );\n    );\n    ForAll(\n        GalleryKB_LoaiTru.AllItems As kh,\n        If(\n            CountIf(\n                tmpCheckDup,\n                Type = \"KB\" && Value = kh.DropKB_LoaiTru.Selected.MA_CHI_TIEU\n            ) > 1,\n            Collect(\n                errorCol,\n                {Message: \"Trùng tiêu chí loại trừ kênh bán\"}\n            )\n        )\n    );\n    If(\n        !IsEmpty(errorCol),\n        UpdateContext({errorMsgDK: First(errorCol).Message})\n    )\n);\n//End kenh ban\n//Khach hang - ap dung\nIf(\n    IsBlank(errorMsgDK) && CountRows(tmpApdungKH) > 0,\n    Clear(errorCol);\n    Clear(tmpCheckDup);\n    ForAll(\n        GalleryKH_1.AllItems As kh,\n        Collect(\n            tmpCheckDup,\n            {\n                Type: \"KH\",\n                Value: kh.DropKH.Selected.MA_CHI_TIEU\n            }\n        );\n    );\n    ForAll(\n        GalleryKH_1.AllItems As kh,\n        If(\n            CountIf(\n                tmpCheckDup,\n                Type = \"KH\" && Value = kh.DropKH.Selected.MA_CHI_TIEU\n            ) > 1,\n            Collect(\n                errorCol,\n                {Message: \"Trùng tiêu chí áp dụng khách hàng\"}\n            )\n        )\n    );\n    If(\n        !IsEmpty(errorCol),\n        UpdateContext({errorMsgDK: First(errorCol).Message})\n    )\n);\n//Khach hang - loai tru\nIf(\n    IsBlank(errorMsgDK) && CountRows(tmpLoaitruKH) > 0,\n    Clear(errorCol);\n    Clear(tmpCheckDup);\n    ForAll(\n        GalleryKH_LoaiTru.AllItems As kh,\n        Collect(\n            tmpCheckDup,\n            {\n                Type: \"KH\",\n                Value: kh.DropKH_LoaiTru.Selected.MA_CHI_TIEU\n            }\n        );\n    );\n    ForAll(\n        GalleryKH_LoaiTru.AllItems As kh,\n        If(\n            CountIf(\n                tmpCheckDup,\n                Type = \"KH\" && Value = kh.DropKH_LoaiTru.Selected.MA_CHI_TIEU\n            ) > 1,\n            Collect(\n                errorCol,\n                {Message: \"Trùng tiêu chí loại trừ khách hàng\"}\n            )\n        )\n    );\n    If(\n        !IsEmpty(errorCol),\n        UpdateContext({errorMsgDK: First(errorCol).Message})\n    )\n);\n//pham vi - ap dung\nIf(\n    IsBlank(errorMsgDK) && CountRows(tmpApdungPV) > 0,\n    Clear(errorCol);\n    Clear(tmpCheckDup);\n    ForAll(\n        GalleryPV_1.AllItems As kh,\n        Collect(\n            tmpCheckDup,\n            {\n                Type: \"PV\",\n                Value: kh.DropPV.Selected.MA_CHI_TIEU\n            }\n        );\n    );\n    ForAll(\n        GalleryPV_1.AllItems As kh,\n        If(\n            CountIf(\n                tmpCheckDup,\n                Type = \"PV\" && Value = kh.DropPV.Selected.MA_CHI_TIEU\n            ) > 1,\n            Collect(\n                errorCol,\n                {Message: \"Trùng tiêu chí áp dụng phạm vi\"}\n            )\n        )\n    );\n    If(\n        !IsEmpty(errorCol),\n        UpdateContext({errorMsgDK: First(errorCol).Message})\n    )\n);\n//Pham vi - loai tru\nIf(\n    IsBlank(errorMsgDK) && CountRows(tmpLoaitruPV) > 0,\n    Clear(errorCol);\n    Clear(tmpCheckDup);\n    ForAll(\n        GalleryPV_LoaiTru.AllItems As kh,\n        Collect(\n            tmpCheckDup,\n            {\n                Type: \"PV\",\n                Value: kh.DropPV_LoaiTru.Selected.MA_CHI_TIEU\n            }\n        );\n    );\n    ForAll(\n        GalleryPV_LoaiTru.AllItems As kh,\n        If(\n            CountIf(\n                tmpCheckDup,\n                Type = \"PV\" && Value = kh.DropPV_LoaiTru.Selected.MA_CHI_TIEU\n            ) > 1,\n            Collect(\n                errorCol,\n                {Message: \"Trùng tiêu chí loại trừ phạm vi\"}\n            )\n        )\n    );\n    If(\n        !IsEmpty(errorCol),\n        UpdateContext({errorMsgDK: First(errorCol).Message})\n    )\n);\nIf(\n    !IsBlank(errorMsgDK),\n    Notify(\n        errorMsgDK,\n        NotificationType.Error,\n        800\n    ),\n    SubmitForm(FormDKChung);\n    UpdateContext({rcd: newMaDK});\n    EditForm(FormDKChung);\n    RemoveIf(\n        DL_DIEUKIEN_APDUNG_LOAI,\n        MA_DIEU_KIEN = newMaDK\n    );\n    RemoveIf(\n        DL_DIEUKIEN_APDUNG_LOAI_CT,\n        MA_DIEU_KIEN = newMaDK\n    );\n    Set(\n        varIdAdSP,\n        0\n    );\n    Set(\n        varIdLtSp,\n        0\n    );\n    // T.ANH LƯU SAN PHAM\n// lưu dữ liệu ở bảng  DL_DIEUKIEN_APDUNG_LOAI\n// THÊM DỮ LIỆU ÁP DỤNG\nSet(\n        varIdAdSP,\n        Max(\n            DL_DIEUKIEN_APDUNG_LOAI,\n            ID\n        ) + 1\n    );\n    Patch(\n        DL_DIEUKIEN_APDUNG_LOAI,\n        Defaults(DL_DIEUKIEN_APDUNG_LOAI),\n        {\n            ID: varIdAdSP,\n            MA_DIEU_KIEN: newMaDK,\n            THANH_PHAN: \"SP\",\n            AP_DUNG: \"1\",\n            KIEU: Radio2.Selected.ID,\n            TEN_KIEU: Radio2.Selected.Text\n        }\n    );\n    \n// THÊM DỮ LIỆU LOẠI TRỪ\nSet(\n        varIdLtSp,\n        Max(\n            DL_DIEUKIEN_APDUNG_LOAI,\n            ID\n        ) + 1\n    );\n    If(\n        !IsBlank(Radio2_1.Selected.Text),\n        Patch(\n            DL_DIEUKIEN_APDUNG_LOAI,\n            Defaults(DL_DIEUKIEN_APDUNG_LOAI),\n            {\n                ID: varIdLtSp,\n                MA_DIEU_KIEN: newMaDK,\n                THANH_PHAN: \"SP\",\n                AP_DUNG: \"2\",\n                KIEU: Radio2_1.Selected.ID,\n                TEN_KIEU: Radio2_1.Selected.Text\n            }\n        )\n    );\n    \n// lưu dữ liệu ở bảng chi tiết\n// lưu áp dụng\nIf(\n        Radio2.Selected.ID = 2,\n        ForAll(\n            Gallery5.AllItems As ad,\n            ForAll(\n                ad.ComboBox3.SelectedItems As gt,\n                Patch(\n                    DL_DIEUKIEN_APDUNG_LOAI_CT,\n                    Defaults(DL_DIEUKIEN_APDUNG_LOAI_CT),\n                    {\n                        ID: Value(ad.TextInput1.Text),\n                        ID_LOAI: varIdAdSP,\n                        MA_DIEU_KIEN: varMaDKien,\n                        THANH_PHAN: \"SP\",\n                        AP_DUNG: \"1\",\n                        KIEU: Radio2.Selected.ID,\n                        MA_TIEU_CHI: ad.DropQTich.Selected.MA_CHI_TIEU,\n                        TEN_TIEU_CHI: ad.DropQTich.Selected.TEN_CHI_TIEU,\n                        MA_GIA_TRI: LookUp(\n                            tmpDsGiatri,\n                            cr282_ten_gia_tri = gt.cr282_ten_gia_tri && Loai = ad.DropQTich.Selected.MA_CHI_TIEU\n                        ).Ma,\n                        TEN_GIA_TRI: gt.cr282_ten_gia_tri\n                    }\n                )\n            )\n        )\n    );\n    \n// lưu loại trừ\nIf(\n        Radio2_1.Selected.ID = 2,\n        ForAll(\n            Gallery5_1.AllItems As ad,\n            ForAll(\n                ad.ComboBox3_1.SelectedItems As gt,\n                Patch(\n                    DL_DIEUKIEN_APDUNG_LOAI_CT,\n                    Defaults(DL_DIEUKIEN_APDUNG_LOAI_CT),\n                    {\n                        ID: Value(TextInput2.Text),\n                        ID_LOAI: varIdAdSP,\n                        MA_DIEU_KIEN: varMaDKien,\n                        THANH_PHAN: \"SP\",\n                        AP_DUNG: \"2\",\n                        KIEU: Radio2_1.Selected.ID,\n                        MA_TIEU_CHI: ad.DropQTich_1.Selected.MA_CHI_TIEU,\n                        TEN_TIEU_CHI: ad.DropQTich_1.Selected.TEN_CHI_TIEU,\n                        MA_GIA_TRI: LookUp(\n                            tmpDsGiatri,\n                            cr282_ten_gia_tri = gt.cr282_ten_gia_tri && Loai = ad.DropQTich_1.Selected.MA_CHI_TIEU\n                        ).Ma,\n                        TEN_GIA_TRI: gt.cr282_ten_gia_tri\n                    }\n                )\n            )\n        )\n    );\n    \n// lưu dữ liệu ở bảng  DL_DIEUKIEN_APDUNG_LOAI KENH BAN\nSet(\n        varIdAdKB,\n        0\n    );\n    Set(\n        varIdLtKB,\n        0\n    );\n    Set(\n        varIdAdKB,\n        Max(\n            DL_DIEUKIEN_APDUNG_LOAI,\n            ID\n        ) + 1\n    );\n    // ÁP DỤNG\nPatch(\n        DL_DIEUKIEN_APDUNG_LOAI,\n        Defaults(DL_DIEUKIEN_APDUNG_LOAI),\n        {\n            ID: varIdAdKB,\n            MA_DIEU_KIEN: newMaDK,\n            THANH_PHAN: \"KB\",\n            AP_DUNG: \"1\",\n            KIEU: RadioKB.Selected.ID,\n            TEN_KIEU: RadioKB.Selected.Text\n        }\n    );\n    // LOẠI TRỪ\nIf(\n        !IsBlank(RadioKB_LoaiTru.Selected.Text),\n        Patch(\n            DL_DIEUKIEN_APDUNG_LOAI,\n            Set(\n                varIdLtKB,\n                Max(\n                    DL_DIEUKIEN_APDUNG_LOAI,\n                    ID\n                ) + 1\n            );\n            Defaults(DL_DIEUKIEN_APDUNG_LOAI),\n            {\n                ID: Max(\n                    DL_DIEUKIEN_APDUNG_LOAI,\n                    ID\n                ) + 1,\n                MA_DIEU_KIEN: newMaDK,\n                THANH_PHAN: \"KB\",\n                AP_DUNG: \"2\",\n                KIEU: RadioKB_LoaiTru.Selected.ID,\n                TEN_KIEU: RadioKB_LoaiTru.Selected.Text\n            }\n        )\n    );\n    \n// lưu dữ liệu ở bảng chi tiết\nIf(\n        RadioKB.Selected.ID = 2 && CountRows(tmpApdungKB) > 0,\n        ForAll(\n            GalleryKB.AllItems As kh,\n            ForAll(\n                kh.ComboBoxGTKB.SelectedItems As gt,\n                Patch(\n                    DL_DIEUKIEN_APDUNG_LOAI_CT,\n                    Defaults(DL_DIEUKIEN_APDUNG_LOAI_CT),\n                    {\n                        ID: Value(kh.TextInput3.Text),\n                        ID_LOAI: varIdAdKB,\n                        MA_DIEU_KIEN: newMaDK,\n                        THANH_PHAN: \"KB\",\n                        AP_DUNG: \"1\",\n                        KIEU: RadioKB.Selected.ID,\n                        MA_TIEU_CHI: kh.DropKB.Selected.MA_CHI_TIEU,\n                        TEN_TIEU_CHI: kh.DropKB.Selected.TEN_CHI_TIEU,\n                        MA_GIA_TRI: LookUp(\n                            tmpDsGiatri,\n                            cr282_ten_gia_tri = gt.cr282_ten_gia_tri && Loai = kh.DropKB.Selected.MA_CHI_TIEU\n                        ).Ma,\n                        TEN_GIA_TRI: gt.cr282_ten_gia_tri\n                    }\n                )\n            )\n        )\n    );\n    \n// lưu dữ liệu ở bảng chi tiết loai trừ\nIf(\n        RadioKB_LoaiTru.Selected.ID = 2 && CountRows(tmpLoaitruKB) > 0,\n        ForAll(\n            GalleryKB_LoaiTru.AllItems As kh,\n            ForAll(\n                kh.ComboBoxGTKB_LT.SelectedItems As gt,\n                Patch(\n                    DL_DIEUKIEN_APDUNG_LOAI_CT,\n                    Defaults(DL_DIEUKIEN_APDUNG_LOAI_CT),\n                    {\n                        ID: Value(kh.TextInput4.Text),\n                        ID_LOAI: varIdLtKB,\n                        MA_DIEU_KIEN: newMaDK,\n                        THANH_PHAN: \"KB\",\n                        AP_DUNG: \"2\",\n                        KIEU: RadioKB_LoaiTru.Selected.ID,\n                        MA_TIEU_CHI: kh.DropKB_LoaiTru.Selected.MA_CHI_TIEU,\n                        TEN_TIEU_CHI: kh.DropKB_LoaiTru.Selected.TEN_CHI_TIEU,\n                        MA_GIA_TRI: LookUp(\n                            tmpDsGiatri,\n                            cr282_ten_gia_tri = gt.cr282_ten_gia_tri && Loai = kh.DropKB_LoaiTru.Selected.MA_CHI_TIEU\n                        ).Ma,\n                        TEN_GIA_TRI: gt.cr282_ten_gia_tri\n                    }\n                )\n            )\n        )\n    );\n    \n//End kenh ban\n// lưu dữ liệu ở bảng  DL_DIEUKIEN_APDUNG_LOAI KHANH HANG\nSet(\n        varIdAdKH,\n        0\n    );\n    Set(\n        varIdLtKH,\n        0\n    );\n    Set(\n        varIdAdKH,\n        Max(\n            DL_DIEUKIEN_APDUNG_LOAI,\n            ID\n        ) + 1\n    );\n    Patch(\n        DL_DIEUKIEN_APDUNG_LOAI,\n        Defaults(DL_DIEUKIEN_APDUNG_LOAI),\n        {\n            ID: varIdAdKH,\n            MA_DIEU_KIEN: newMaDK,\n            THANH_PHAN: \"KH\",\n            AP_DUNG: \"1\",\n            KIEU: RadioKH.Selected.ID,\n            TEN_KIEU: RadioKH.Selected.Text\n        }\n    );\n    If(\n        !IsBlank(RadioKH_LoaiTru.Selected.Text),\n        Patch(\n            DL_DIEUKIEN_APDUNG_LOAI,\n            Set(\n                varIdLtKH,\n                Max(\n                    DL_DIEUKIEN_APDUNG_LOAI,\n                    ID\n                ) + 1\n            );\n            Defaults(DL_DIEUKIEN_APDUNG_LOAI),\n            {\n                ID: Max(\n                    DL_DIEUKIEN_APDUNG_LOAI,\n                    ID\n                ) + 1,\n                MA_DIEU_KIEN: newMaDK,\n                THANH_PHAN: \"KH\",\n                AP_DUNG: \"2\",\n                KIEU: RadioKH_LoaiTru.Selected.ID,\n                TEN_KIEU: RadioKB_LoaiTru.Selected.Text\n            }\n        )\n    );\n    \n// lưu dữ liệu ở bảng chi tiết\nIf(\n        RadioKH.Selected.ID = 2 && CountRows(tmpApdungKH) > 0,\n        ForAll(\n            GalleryKH_1.AllItems As kh,\n            ForAll(\n                kh.ComboBoxGTKH.SelectedItems As gt,\n                Patch(\n                    DL_DIEUKIEN_APDUNG_LOAI_CT,\n                    Defaults(DL_DIEUKIEN_APDUNG_LOAI_CT),\n                    {\n                        ID: Value(kh.TextInput5.Text),\n                        ID_LOAI: varIdAdKH,\n                        MA_DIEU_KIEN: newMaDK,\n                        THANH_PHAN: \"KH\",\n                        AP_DUNG: \"1\",\n                        KIEU: RadioKH.Selected.ID,\n                        MA_TIEU_CHI: kh.DropKH.Selected.MA_CHI_TIEU,\n                        TEN_TIEU_CHI: kh.DropKH.Selected.TEN_CHI_TIEU,\n                        MA_GIA_TRI: LookUp(\n                            tmpDsGiatri,\n                            cr282_ten_gia_tri = gt.cr282_ten_gia_tri && Loai = kh.DropKH.Selected.MA_CHI_TIEU\n                        ).Ma,\n                        TEN_GIA_TRI: gt.cr282_ten_gia_tri\n                    }\n                )\n            )\n        )\n    );\n    \n// lưu dữ liệu ở bảng chi tiết loai tru\nIf(\n        RadioKH_LoaiTru.Selected.ID = 2 && CountRows(tmpLoaitruKH) > 0,\n        ForAll(\n            GalleryKH_LoaiTru.AllItems As kh,\n            ForAll(\n                kh.ComboBoxGTKH_LT.SelectedItems As gt,\n                Patch(\n                    DL_DIEUKIEN_APDUNG_LOAI_CT,\n                    Defaults(DL_DIEUKIEN_APDUNG_LOAI_CT),\n                    {\n                        ID: Value(kh.TextInput6.Text),\n                        ID_LOAI: varIdLtKH,\n                        MA_DIEU_KIEN: newMaDK,\n                        THANH_PHAN: \"KH\",\n                        AP_DUNG: \"2\",\n                        KIEU: RadioKH_LoaiTru.Selected.ID,\n                        MA_TIEU_CHI: kh.DropKH_LoaiTru.Selected.MA_CHI_TIEU,\n                        TEN_TIEU_CHI: kh.DropKH_LoaiTru.Selected.TEN_CHI_TIEU,\n                        MA_GIA_TRI: LookUp(\n                            tmpDsGiatri,\n                            cr282_ten_gia_tri = gt.cr282_ten_gia_tri && Loai = kh.DropKH_LoaiTru.Selected.MA_CHI_TIEU\n                        ).Ma,\n                        TEN_GIA_TRI: gt.cr282_ten_gia_tri\n                    }\n                )\n            )\n        )\n    );\n    \n// lưu dữ liệu ở bảng  DL_DIEUKIEN_APDUNG_LOAI PHAM_VI\nSet(\n        varIdAdPV,\n        0\n    );\n    Set(\n        varIdLtPV,\n        0\n    );\n    Set(\n        varIdAdPV,\n        Max(\n            DL_DIEUKIEN_APDUNG_LOAI,\n            ID\n        ) + 1\n    );\n    Patch(\n        DL_DIEUKIEN_APDUNG_LOAI,\n        Defaults(DL_DIEUKIEN_APDUNG_LOAI),\n        {\n            ID: varIdAdPV,\n            MA_DIEU_KIEN: newMaDK,\n            THANH_PHAN: \"PV\",\n            AP_DUNG: \"1\",\n            KIEU: RadioPV.Selected.ID,\n            TEN_KIEU: RadioPV.Selected.Text\n        }\n    );\n    If(\n        !IsBlank(RadioPV_LoaiTru.Selected.Text),\n        Patch(\n            DL_DIEUKIEN_APDUNG_LOAI,\n            Set(\n                varIdLtPV,\n                Max(\n                    DL_DIEUKIEN_APDUNG_LOAI,\n                    ID\n                ) + 1\n            );\n            Defaults(DL_DIEUKIEN_APDUNG_LOAI),\n            {\n                ID: Max(\n                    DL_DIEUKIEN_APDUNG_LOAI,\n                    ID\n                ) + 1,\n                MA_DIEU_KIEN: newMaDK,\n                THANH_PHAN: \"PV\",\n                AP_DUNG: \"2\",\n                KIEU: RadioPV_LoaiTru.Selected.ID,\n                TEN_KIEU: RadioPV_LoaiTru.Selected.Text\n            }\n        )\n    );\n    \n// lưu dữ liệu ở bảng chi tiết\nIf(\n        RadioPV.Selected.ID = 2 && CountRows(tmpApdungPV) > 0,\n        ForAll(\n            GalleryPV_1.AllItems As pv,\n            ForAll(\n                pv.ComboBoxGTPV.SelectedItems As gt,\n                Patch(\n                    DL_DIEUKIEN_APDUNG_LOAI_CT,\n                    Defaults(DL_DIEUKIEN_APDUNG_LOAI_CT),\n                    {\n                        ID: Value(pv.TextInput7.Text),\n                        ID_LOAI: varIdAdPV,\n                        MA_DIEU_KIEN: newMaDK,\n                        THANH_PHAN: \"PV\",\n                        AP_DUNG: \"1\",\n                        KIEU: RadioPV.Selected.ID,\n                        MA_TIEU_CHI: pv.DropPV.Selected.MA_CHI_TIEU,\n                        TEN_TIEU_CHI: pv.DropPV.Selected.TEN_CHI_TIEU,\n                        MA_GIA_TRI: LookUp(\n                            tmpDsGiatri,\n                            cr282_ten_gia_tri = gt.cr282_ten_gia_tri && Loai = pv.DropPV.Selected.MA_CHI_TIEU\n                        ).Ma,\n                        TEN_GIA_TRI: gt.cr282_ten_gia_tri\n                    }\n                )\n            )\n        )\n    );\n    \n// lưu dữ liệu ở bảng chi tiết loai trừ\nIf(\n        RadioPV_LoaiTru.Selected.ID = 2 && CountRows(tmpLoaitruPV) > 0,\n        ForAll(\n            GalleryPV_LoaiTru.AllItems As kh,\n            ForAll(\n                kh.ComboBoxGTPV_LT.SelectedItems As gt,\n                Patch(\n                    DL_DIEUKIEN_APDUNG_LOAI_CT,\n                    Defaults(DL_DIEUKIEN_APDUNG_LOAI_CT),\n                    {\n                        ID: Value(kh.TextInput8.Text),\n                        ID_LOAI: varIdLtPV,\n                        MA_DIEU_KIEN: newMaDK,\n                        THANH_PHAN: \"PV\",\n                        AP_DUNG: \"2\",\n                        KIEU: RadioPV_LoaiTru.Selected.ID,\n                        MA_TIEU_CHI: kh.DropPV_LoaiTru.Selected.MA_CHI_TIEU,\n                        TEN_TIEU_CHI: kh.DropPV_LoaiTru.Selected.TEN_CHI_TIEU,\n                        MA_GIA_TRI: LookUp(\n                            tmpDsGiatri,\n                            cr282_ten_gia_tri = gt.cr282_ten_gia_tri && Loai = kh.DropPV_LoaiTru.Selected.MA_CHI_TIEU\n                        ).Ma,\n                        TEN_GIA_TRI: gt.cr282_ten_gia_tri\n                    }\n                )\n            )\n        )\n    );\n    /*UpdateIf(\n        DL_DIEUKIEN_APDUNG,\n        MA_DIEU_KIEN = DataCardValueMaDK.Text,\n        {TRANG_THAI: \"true\"}\n    );*/\n    UpdateContext({rcd: newMaDK});\n    EditForm(FormDKChung);\n    Notify(\n        \"Ghi dữ liệu thành công\",\n        NotificationType.Success,\n        800\n    );\n    /*Set(\n        varDaGhi,\n        true\n    );*/\n);\n"
            PressedBorderColor: =Self.Fill
            PressedColor: =Self.Fill
            PressedFill: =Self.Color
            Size: =11
            Text: ="Ghi dữ liệu"
            Visible: |-
              =//If(!IsBlank(DataCardValueMaDK.Text),true,false)
              false
            Width: =122
            X: =1222
            Y: =728
