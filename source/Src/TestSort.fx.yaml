"TestSort As screen.'phoneLayout_FluidGridWithHeaderPageLayout_ver3.0'":
    OnVisible: |-
        =ClearCollect(
            tmpCTCollect,
            ShowColumns(
                AddColumns(
                    SortByColumns(
                        Filter(
                            ' DL_SAN_PHAM_CT',
                            MA_SAN_PHAM = valMaSP
                        ),
                        "cr282_ma_chuong_trinh",
                        SortOrder.Ascending
                    ),
                    "edited",
                    0
                ),
                "cr282_ma_chuong_trinh",
                "cr282_ma_chuongtrinh",
                "cr282_ten_chuong_trinh",
                "cr282_mo_ta",
                "cr282_ma_san_pham",
                "cr282_trang_thai",
                "edited"
            )
        );
        ClearCollect(
            tmpDKCCollect,
            ShowColumns(
                AddColumns(
                    SortByColumns(
                       //DL_SAN_PHAM_DKCHUNGS,
                       Filter(DL_SAN_PHAM_DKCHUNGS,ma_san_pham=valMaSP),
                        "cr282_id_dkc",
                        SortOrder.Ascending
                    ),
                    "edited",
                    0
                ),
                "cr282_id_dkc",
                "cr282_ma_san_pham",
                "cr282_nhom_thong_tin",
                "cr282_thong_tin",
                "cr282_noi_dung",
                "edited"
            )
        );
        ClearCollect(
            dsNhomTT,
            {
                Key:"Đối tượng bảo hiểm",
                Value:1
            },
            {
                Key:"Phạm vi rủi ro được bảo hiểm",
                Value:2
            },
            {
                Key:"Điều khoản loại trừ",
                Value:3
            },
            {
                Key:"Phương thức đóng phi",
                Value:4
            }
            ,
            {
                Key:"Thời hạn bảo hiểm",
                Value:5
            }
            ,
            {
                Key:"Các quy định giải quyết tranh chấp",
                Value:6
            },
            {
                Key:"Quyền lợi và nghĩa vụ bên mua bảo hiểm, người được bảo hiểm",
                Value:7
            }
            , {
                Key:"Trách nhiệm Doanh nghiệp bảo hiểm",
                Value:8
            }
        );
        UpdateContext(
            {
                maAdded: "",
                maUpdated: ""
            }
        );
        UpdateContext(
            {
                maAddedDKC:"",
                maUpdatedDKC: ""
            }
        );
        
        ClearCollect(
            tmpGPCCollect,
            ShowColumns(
                AddColumns(
                    SortByColumns(
                       DL_SAN_PHAM_GPS,
                        "cr282_id_giamphi",
                        SortOrder.Ascending
                    ),
                    "edited",
                    0
                ),
                "cr282_id_giamphi",
                "cr282_ma_san_pham",
                "cr282_thong_tin",
                "cr282_mo_ta",
                "cr282_so_tien",
                "cr282_donvi_tien",
                "cr282_ty_le",
                "edited"
            )
        );
        UpdateContext({maAddedGP:"",maUpdatedGP:""});
        ClearCollect(
            tmpQLKCollect,
            ShowColumns(
                AddColumns(
                    SortByColumns(
                        DL_SAN_PHAM_QL_KHACS,
                        "cr282_ma_dl",
                        SortOrder.Ascending
                    ),
                    "edited",
                    0
                ),
                "cr282_ma_dl",
                "cr282_ma_sp",
                "cr282_ma_nhom_ql",
                "cr282_mo_ta",
                "edited"
            )
        );
        UpdateContext({
            maAddedQLK:"",
            maUpdatedQLK:"",
            showConfirmQLK:0
        });
        ClearCollect(
            tmpNQLSPCollect,
            ShowColumns(
                AddColumns(
                    SortByColumns(
                        Filter(
                            DL_SAN_PHAM_NHOMQLS,
                            MA_SP="1000"
                        ),
                        "cr282_ma_dl",
                        SortOrder.Ascending
                    ),
                    "edited",
                    0
                ),
                "cr282_ma_dl",
                "cr282_chuongtrinh_apdung",
                "cr282_loai",
                "cr282_ma_nhom_ql",
                "cr282_ma_nhom_tinhphi",
                "cr282_ma_sp",
                "cr282_phamvi_dialy",
                "cr282_ten_hien_thi",
                "edited"
            )
        );
        ClearCollect(
            tmpQLCTTBCollect,
            ShowColumns(
                SortByColumns(
                    DL_SAN_PHAM_QLCT_CHONS,
                    "cr282_ma_ql_chitiet",
                    SortOrder.Ascending
                ),
                "cr282_ma_ql_chitiet",
                "cr282_ma_nhomql_sp",
                "cr282_ten_hien_thi"
            )
        );
        UpdateContext({
            maAddedNQLSP:"",
            maUpdatedNQLSP:"",
            loaiFilterQLCTTB:1,
            loaiFilterNQLSP:1
        });

    CanvasSP As fluidGrid.fluidGridWithBlankCard:
        BorderThickness: =0
        Height: =768
        Width: =Parent.Width
        Y: =
        ZIndex: =3

        DataCard1 As dataCard:
            BorderColor: =RGBA(0, 0, 0, 1)
            BorderStyle: =BorderStyle.Solid
            BorderThickness: =0
            DisplayMode: =DisplayMode.Edit
            Fill: =RGBA(0, 0, 0, 0)
            Height: =768
            Width: =1366
            X: =0
            Y: =0
            ZIndex: =1

            "'1. ChuongTrinh' As groupContainer.manualLayoutContainer":
                Height: =406
                Width: =1214
                X: =150
                ZIndex: =1

                GalleryCT As gallery.galleryVertical:
                    DelayItemLoading: =true
                    Height: =155
                    Items: =SortByColumns(tmpCTCollect,"cr282_ma_chuong_trinh",SortOrder.Ascending)
                    Layout: =Layout.Vertical
                    LoadingSpinner: =LoadingSpinner.Data
                    NavigationStep: =0
                    TemplateSize: =40
                    Width: =1076
                    X: =5
                    Y: =251
                    ZIndex: =1

                    TxtMaCT As text:
                        BorderColor: =RGBA(15, 108, 189, 1)
                        Default: =ThisItem.cr282_ma_chuongtrinh
                        DisabledBorderColor: =RGBA(180, 214, 250, 1)
                        DisabledColor: =RGBA(0, 0, 0, 1)
                        DisabledFill: =RGBA(255, 255, 255, 1)
                        DisplayMode: =DisplayMode.Disabled
                        OnChange: =
                        OnSelect: =Select(Parent)
                        Width: =168
                        ZIndex: =8

                    TxtTenCT As text:
                        BorderColor: =RGBA(72, 163, 62, 1)
                        Default: =ThisItem.cr282_ten_chuong_trinh
                        DisabledBorderColor: =RGBA(180, 214, 250, 1)
                        DisabledColor: =RGBA(0, 0, 0, 1)
                        DisabledFill: =RGBA(255, 255, 255, 1)
                        DisplayMode: =If(ThisItem.edited=0,DisplayMode.Disabled,DisplayMode.Edit) 
                        OnChange: =
                        OnSelect: =Select(Parent)
                        Width: =229
                        X: =180
                        ZIndex: =9

                    TxtMoTa As text:
                        BorderColor: =RGBA(72, 163, 62, 1)
                        Default: =ThisItem.cr282_mo_ta
                        DisabledBorderColor: =RGBA(180, 214, 250, 1)
                        DisabledColor: =RGBA(0, 0, 0, 1)
                        DisabledFill: =RGBA(255, 255, 255, 1)
                        DisplayMode: =If(ThisItem.edited=0,DisplayMode.Disabled,DisplayMode.Edit) 
                        OnChange: =
                        OnSelect: =Select(Parent)
                        Width: =326
                        X: =426
                        ZIndex: =10

                    Btn_SuaCT As button:
                        OnSelect: |-
                            =If(
                                Or(maAdded<>"",maUpdated<>""),
                                Notify("Có dữ liệu chưa được lưu",NotificationType.Warning,800),
                                UpdateIf(
                                    tmpCTCollect,
                                    cr282_ma_chuong_trinh=ThisItem.cr282_ma_chuong_trinh,
                                    {
                                        edited:1
                                    }
                                );
                                UpdateContext({
                                    maUpdated:ThisItem.cr282_ma_chuong_trinh
                                })
                            )
                        Text: ="Sửa"
                        Visible: =ThisItem.edited=0
                        Width: =75
                        X: =770
                        ZIndex: =17

                    Btn_XoaCT As button:
                        OnSelect: |-
                            =If(
                                Or(maAdded<>"",maUpdated<>""),
                                Notify("Có dữ liệu chưa được lưu",NotificationType.Warning,800),
                                Refresh(' DL_SAN_PHAM_CT');
                                RemoveIf(
                                    ' DL_SAN_PHAM_CT',
                                    ID=ThisItem.cr282_ma_chuong_trinh
                                );
                                Remove(tmpCTCollect,ThisItem);
                                Notify("Xóa dữ liệu thành công", NotificationType.Success,800) 
                            )
                        Text: ="Xóa"
                        Visible: =ThisItem.edited=0
                        Width: =85
                        X: =861
                        ZIndex: =18

                    Btn_LuuCT As button:
                        OnSelect: |-
                            =If(
                                TxtTenCT.Text="",
                                Notify("Bắt buộc nhập tên chương trình", NotificationType.Error,800),
                                If(
                                    ThisItem.cr282_ma_chuong_trinh=maAdded,
                                    Patch(
                                        ' DL_SAN_PHAM_CT',
                                        {
                                            ID:ThisItem.cr282_ma_chuong_trinh,
                                            MA_CHUONG_TRINH:TxtMaCT.Text,
                                            TEN_CHUONG_TRINH:TxtTenCT.Text,
                                            MO_TA:TxtMoTa.Text,
                                            MA_SAN_PHAM:Txt_MaSP.Text,
                                            TRANG_THAI:0
                                        }
                                    ),
                                    UpdateIf(
                                        ' DL_SAN_PHAM_CT',
                                        ID=ThisItem.cr282_ma_chuong_trinh,
                                        {
                                            TEN_CHUONG_TRINH:TxtTenCT.Text,
                                            MO_TA:TxtMoTa.Text,
                                            MA_SAN_PHAM:Txt_MaSP.Text,
                                            TRANG_THAI:0
                                        }
                                    )
                                );
                                UpdateIf(
                                    tmpCTCollect,
                                    cr282_ma_chuong_trinh=ThisItem.cr282_ma_chuong_trinh,
                                    {
                                        cr282_ten_chuong_trinh:TxtTenCT.Text,
                                        cr282_mo_ta:TxtMoTa.Text,
                                        cr282_ma_san_pham:Txt_MaSP.Text,
                                        edited:0
                                    }
                                );
                                Notify("Lưu dữ liệu thành công", NotificationType.Success,800);
                                ClearCollect(
                                    tmpCTCollect,
                                    ShowColumns(
                                        AddColumns(
                                            SortByColumns(
                                                ' DL_SAN_PHAM_CT',
                                                "cr282_ma_chuong_trinh",
                                                SortOrder.Ascending
                                            ),
                                            "edited",
                                            0
                                        ),
                                        "cr282_ma_chuong_trinh",
                                        "cr282_ma_chuongtrinh",
                                        "cr282_ten_chuong_trinh",
                                        "cr282_mo_ta",
                                        "cr282_ma_san_pham",
                                        "cr282_trang_thai",
                                        "edited"
                                    )
                                );
                                UpdateContext({
                                    maAdded:"",
                                    maUpdated:""
                                });
                            )
                        Text: ="Lưu"
                        Visible: =ThisItem.edited=1
                        Width: =125
                        X: =764
                        ZIndex: =19

                    Btn_HuyCT As button:
                        OnSelect: |-
                            =If(
                                ThisItem.cr282_ma_chuong_trinh=maAdded,
                                Remove(tmpCTCollect,ThisItem),
                                UpdateIf(
                                    tmpCTCollect,
                                    cr282_ma_chuong_trinh=ThisItem.cr282_ma_chuong_trinh,
                                    {
                                        edited:0
                                    }
                                )
                            );
                            UpdateContext({
                                maAdded:"",
                                maUpdated:""
                            });
                        Text: ="Hủy"
                        Visible: =ThisItem.edited=1
                        Width: =130
                        X: =920
                        ZIndex: =20

                    Btn_ChiTiet As button:
                        OnSelect: =
                        Text: ="Chi tiết"
                        Visible: =ThisItem.edited=0 && ThisItem.cr282_trang_thai=1
                        Width: =103
                        X: =963
                        ZIndex: =21

                    TxtID As text:
                        BorderColor: =RGBA(15, 108, 189, 1)
                        Default: =ThisItem.cr282_ma_chuong_trinh
                        DisabledBorderColor: =RGBA(180, 214, 250, 1)
                        DisabledColor: =RGBA(0, 0, 0, 1)
                        DisabledFill: =RGBA(255, 255, 255, 1)
                        DisplayMode: =DisplayMode.Disabled
                        OnChange: =
                        OnSelect: =Select(Parent)
                        Visible: =false
                        Width: =168
                        ZIndex: =22

                BadgeCanvas1_9 As Badge:
                    BasePaletteColor: =
                    Content: =""
                    DisplayMode: =DisplayMode.Edit
                    FontColor: =
                    Height: =35
                    Visible: =true
                    Width: =1076
                    X: =0
                    Y: =213
                    ZIndex: =2

                TextCanvas2_50 As Text:
                    DisplayMode: =DisplayMode.Edit
                    FontColor: =
                    Height: =38
                    Size: =14
                    Text: ="Tên chương trình"
                    Weight: ='TextCanvas.Weight'.Bold
                    Width: =262
                    X: =228
                    Y: =210
                    ZIndex: =3

                TextCanvas2_52 As Text:
                    DisplayMode: =DisplayMode.Edit
                    FontColor: =
                    Height: =34
                    Size: =14
                    Text: ="Mô tả"
                    Weight: ='TextCanvas.Weight'.Bold
                    Width: =96
                    X: =555
                    Y: =214
                    ZIndex: =4

                TextCanvas2_53 As Text:
                    DisplayMode: =DisplayMode.Edit
                    FontColor: =
                    Height: =34
                    Size: =14
                    Text: ="Thao tác"
                    Weight: ='TextCanvas.Weight'.Bold
                    Width: =96
                    X: =872
                    Y: =214
                    ZIndex: =5

                Label_MaSP As label:
                    Height: =37
                    Text: ="Mã sản phẩm"
                    Width: =122
                    X: =40
                    Y: =40
                    ZIndex: =6

                Label_TenSP As label:
                    Height: =37
                    Text: ="Tên sản phẩm"
                    Width: =137
                    X: =476
                    Y: =40
                    ZIndex: =7

                Txt_MaSP As text:
                    Default: =valMaSP
                    DisplayMode: =DisplayMode.Disabled
                    Height: =37
                    Width: =265
                    X: =162
                    Y: =40
                    ZIndex: =8

                Txt_TenSP As text:
                    Default: =valTenSP
                    DisplayMode: =DisplayMode.Disabled
                    Height: =37
                    Width: =392
                    X: =613
                    Y: =40
                    ZIndex: =9

                TextCanvas2_51 As Text:
                    DisplayMode: =DisplayMode.Edit
                    FontColor: =
                    Height: =39
                    Size: =14
                    Text: ="Mã chương trình"
                    Weight: ='TextCanvas.Weight'.Bold
                    Width: =162
                    X: =52
                    Y: =212
                    ZIndex: =10

                ThemMoiCT As button:
                    Height: =36
                    OnSelect: |-
                        =If(
                            Or(
                                maAdded <> "",
                                maUpdated <> ""
                            ),
                            Notify(
                                "Có dữ liệu chưa được lưu",
                                NotificationType.Warning,
                                800
                            ),
                            UpdateContext(
                                {
                                    idMa: If(
                                        CountIf(
                                            ' DL_SAN_PHAM_CT',
                                            true
                                        ) = 0,
                                        1000,
                                        Value(
                                            Last(
                                                SortByColumns(
                                                    ' DL_SAN_PHAM_CT',
                                                    "cr282_ma_chuong_trinh",
                                                    SortOrder.Ascending
                                                )
                                            ).ID
                                        ) + 1
                                    )
                                }
                            );
                            Set(MaCT,CountIf(' DL_SAN_PHAM_CT',true) + 1);
                            Collect(
                                tmpCTCollect,
                                {
                                    cr282_ma_chuong_trinh: Text(idMa),
                                    cr282_ma_chuongtrinh: Concatenate(
                                        valMaSP,
                                        "_",
                                        If(
                                            MaCT < 10,
                                            "00",
                                            If(
                                                MaCT < 100 && MaCT >= 10,
                                                "0",
                                                ""
                                            )
                                        ),
                                        Text(MaCT)
                                    ),
                                    cr282_ten_chuong_trinh: "",
                                    cr282_mo_ta: "",
                                    cr282_ma_san_pham: "",
                                    cr282_trang_thai: 0,
                                    edited: 1
                                }
                            );
                            UpdateContext({maAdded: Text(idMa)})
                        )
                    Text: ="Thêm mới"
                    X: =5
                    Y: =160
                    ZIndex: =11

                LuuThongTinCT As button:
                    Height: =36
                    OnSelect: |-
                        =If(
                            Or(
                                maAdded <> "",
                                maUpdated <> ""
                            ),
                            Notify(
                                "Có dữ liệu chưa được lưu",
                                NotificationType.Warning,
                                800
                            ),
                            If(
                                CountRows(tmpCTCollect) > 0,
                                UpdateIf(
                                    ' DL_SAN_PHAM_CT',
                                    Txt_MaSP.Text = MA_SAN_PHAM && TRANG_THAI=0,
                                    {TRANG_THAI: 1}
                                )
                            )
                        );
                        Select(IconTaiLaiCT);
                    Text: ="Lưu thông tin"
                    Visible: |-
                        =If(
                            CountRows(Filter(' DL_SAN_PHAM_CT',MA_SAN_PHAM=Txt_MaSP.Text)) > 0,
                            true,
                            false
                        )
                    X: =228
                    Y: =160
                    ZIndex: =12

                Label1_2 As label:
                    Align: =Align.Justify
                    FontWeight: =FontWeight.Bold
                    Height: =44
                    Size: =16
                    Text: ="1. Chương trình (gói sản phẩm)"
                    Width: =1076
                    Y: =95
                    ZIndex: =13

                IconTaiLaiCT As icon.Sync:
                    Color: =RGBA(83, 144, 164, 1)
                    Height: =36
                    Icon: =Icon.Sync
                    OnSelect: |-
                        =ClearCollect(
                            tmpCTCollect,
                            ShowColumns(
                                AddColumns(
                                    SortByColumns(
                                        ' DL_SAN_PHAM_CT',
                                        "cr282_ma_chuong_trinh",
                                        SortOrder.Ascending
                                    ),
                                    "edited",
                                    0
                                ),
                                "cr282_ma_chuong_trinh",
                                "cr282_ma_chuongtrinh",
                                "cr282_ten_chuong_trinh",
                                "cr282_mo_ta",
                                "cr282_ma_san_pham",
                                "cr282_trang_thai",
                                "edited"
                            )
                        );
                        UpdateContext({
                            maAdded:"",
                            maUpdated:""
                        });
                    Tooltip: ="Tải lại"
                    Width: =32
                    X: =1044
                    Y: =160
                    ZIndex: =14

        DataCard2 As dataCard.blankCard:
            BorderColor: =RGBA(0, 0, 0, 1)
            BorderStyle: =BorderStyle.Solid
            DisplayMode: =DisplayMode.Edit
            Fill: =RGBA(0, 0, 0, 0)
            Height: =100
            Width: =1366
            X: =0
            Y: =1
            ZIndex: =2

            YeuToAnhHuong As groupContainer.manualLayoutContainer:
                Height: =768
                Width: =1207
                X: =148
                ZIndex: =1

                ChuongTrinh As checkbox:
                    Default: =true
                    DisplayMode: =DisplayMode.Disabled
                    Text: ="Chương trình"
                    Width: =192
                    X: =38
                    Y: =80
                    ZIndex: =1

                GioiTinh As checkbox:
                    Text: ="Giới tính"
                    Visible: |-
                        =LookUp(
                            DM_YEUTO_AH_PHIS,
                            TEN_YEU_TO = "Giới tính"
                        ).HIEU_LUC_TU <= Today() && (LookUp(
                            DM_YEUTO_AH_PHIS,
                            TEN_YEU_TO = "Giới tính"
                        ).HIEU_LUC_DEN >= Today() || IsBlank(
                            LookUp(
                                DM_YEUTO_AH_PHIS,
                                TEN_YEU_TO = "Giới tính"
                            ).HIEU_LUC_DEN
                        ))
                    Width: =192
                    X: =38
                    Y: =332
                    ZIndex: =3

                NganhNghe As checkbox:
                    Text: ="Ngành nghề"
                    Visible: |-
                        =LookUp(
                            DM_YEUTO_AH_PHIS,
                            TEN_YEU_TO = "Ngành nghề"
                        ).HIEU_LUC_TU <= Today() && (LookUp(
                            DM_YEUTO_AH_PHIS,
                            TEN_YEU_TO = "Ngành nghề"
                        ).HIEU_LUC_DEN >= Today() || IsBlank(
                            LookUp(
                                DM_YEUTO_AH_PHIS,
                                TEN_YEU_TO = "Ngành nghề"
                            ).HIEU_LUC_DEN
                        ))
                    Width: =192
                    X: =38
                    Y: =390
                    ZIndex: =4

                NhomTP As checkbox:
                    Default: =true
                    DisplayMode: =DisplayMode.Disabled
                    Text: ="Nhóm tính phí"
                    Width: =192
                    X: =38
                    Y: =145
                    ZIndex: =5

                PVDiaLy As checkbox:
                    Default: =true
                    Text: ="Phạm vi địa lý"
                    Visible: |-
                        =LookUp(
                            DM_YEUTO_AH_PHIS,
                            TEN_YEU_TO = "Phạm vi địa lý"
                        ).HIEU_LUC_TU <= Today() && (LookUp(
                            DM_YEUTO_AH_PHIS,
                            TEN_YEU_TO = "Phạm vi địa lý"
                        ).HIEU_LUC_DEN >= Today() || IsBlank(
                            LookUp(
                                DM_YEUTO_AH_PHIS,
                                TEN_YEU_TO = "Phạm vi địa lý"
                            ).HIEU_LUC_DEN
                        ))
                    Width: =192
                    X: =38
                    Y: =211
                    ZIndex: =6

                BH_SoTien As checkbox:
                    Default: =true
                    Height: =38
                    Text: ="Số tiền bảo hiểm"
                    Visible: |-
                        =LookUp(
                            DM_YEUTO_AH_PHIS,
                            TEN_YEU_TO = "Số tiền bảo hiểm"
                        ).HIEU_LUC_TU <= Today() && (LookUp(
                            DM_YEUTO_AH_PHIS,
                            TEN_YEU_TO = "Số tiền bảo hiểm"
                        ).HIEU_LUC_DEN >= Today() || IsBlank(
                            LookUp(
                                DM_YEUTO_AH_PHIS,
                                TEN_YEU_TO = "Số tiền bảo hiểm"
                            ).HIEU_LUC_DEN
                        ))
                    Width: =192
                    X: =38
                    Y: =457
                    ZIndex: =7

                BH_SoNguoi As checkbox:
                    Text: ="Số người được BH"
                    Visible: |-
                        =LookUp(
                            DM_YEUTO_AH_PHIS,
                            TEN_YEU_TO = "Số người được BH"
                        ).HIEU_LUC_TU <= Today() && (LookUp(
                            DM_YEUTO_AH_PHIS,
                            TEN_YEU_TO = "Số người được BH"
                        ).HIEU_LUC_DEN >= Today() || IsBlank(
                            LookUp(
                                DM_YEUTO_AH_PHIS,
                                TEN_YEU_TO = "Số người được BH"
                            ).HIEU_LUC_DEN
                        ))
                    Width: =192
                    X: =38
                    Y: =513
                    ZIndex: =8

                BH_ThoiHan As checkbox:
                    Text: ="Thời hạn bảo hiểm"
                    Visible: |-
                        =LookUp(
                            DM_YEUTO_AH_PHIS,
                            TEN_YEU_TO = "Thời hạn bảo hiểm"
                        ).HIEU_LUC_TU <= Today() && (LookUp(
                            DM_YEUTO_AH_PHIS,
                            TEN_YEU_TO = "Thời hạn bảo hiểm"
                        ).HIEU_LUC_DEN >= Today() || IsBlank(
                            LookUp(
                                DM_YEUTO_AH_PHIS,
                                TEN_YEU_TO = "Thời hạn bảo hiểm"
                            ).HIEU_LUC_DEN
                        ))
                    Width: =212
                    X: =38
                    Y: =572
                    ZIndex: =9

                BH_PhuongThuc As checkbox:
                    Height: =38
                    Text: ="Phương thức đóng phí"
                    Visible: |-
                        =LookUp(
                            DM_YEUTO_AH_PHIS,
                            TEN_YEU_TO = "Phương thức đóng phí"
                        ).HIEU_LUC_TU <= Today() && (LookUp(
                            DM_YEUTO_AH_PHIS,
                            TEN_YEU_TO = "Phương thức đóng phí"
                        ).HIEU_LUC_DEN >= Today() || IsBlank(
                            LookUp(
                                DM_YEUTO_AH_PHIS,
                                TEN_YEU_TO = "Phương thức đóng phí"
                            ).HIEU_LUC_DEN
                        ))
                    Width: =232
                    X: =38
                    Y: =646
                    ZIndex: =10

                Label_TienTe As label:
                    Text: ="Đơn vị tiền"
                    X: =38
                    Y: =706
                    ZIndex: =11

                DsTienTe As dropdown:
                    Height: =45
                    Items: =BH_DM_TIENTES
                    X: =296
                    Y: =706
                    ZIndex: =12

                Datafield_CT As combobox:
                    DefaultSelectedItems: =
                    DisplayFields: =["cr282_ten_chuong_trinh"]
                    Height: =45
                    InputTextPlaceholder: =""
                    IsSearchable: =false
                    Items: =Filter(' DL_SAN_PHAM_CT',MA_SAN_PHAM=valMaSP)
                    SearchFields: =["cr282_ten_chuong_trinh"]
                    SearchItems: =[]
                    Width: =840
                    X: =296
                    Y: =80
                    ZIndex: =13

                Datafield_Nhom As combobox:
                    DisplayFields: =["cr282_ten_nhom_tp"]
                    Height: =45
                    InputTextPlaceholder: =""
                    IsSearchable: =false
                    Items: =BH_DM_NHOMTP
                    SearchFields: =["cr282_id"]
                    SearchItems: =[]
                    Width: =840
                    X: =296
                    Y: =150
                    ZIndex: =14

                Datafield_DT As combobox:
                    DisplayFields: =["cr282_mo_ta"]
                    Height: =45
                    InputTextPlaceholder: =""
                    IsSearchable: =false
                    Items: =DM_DO_TUOIS
                    SearchFields: =["cr282_mo_ta"]
                    SearchItems: =[]
                    Visible: =If(DoTuoi.Value=true && DoTuoi.Visible=true,true,false)
                    Width: =840
                    X: =296
                    Y: =277
                    ZIndex: =15

                Datafield_GT As combobox:
                    DisplayFields: =["cr282_ten_gioi_tinh"]
                    Height: =45
                    InputTextPlaceholder: ="Find items"
                    IsSearchable: =false
                    Items: =DM_GIOI_TINHS
                    SearchFields: =["cr282_ten_gioi_tinh"]
                    SearchItems: =[]
                    Visible: =If(GioiTinh.Value=true && GioiTinh.Visible=true, true,false)
                    Width: =840
                    X: =296
                    Y: =337
                    ZIndex: =16

                LuuYT As button:
                    OnSelect: |
                        =RemoveIf(
                            DL_SAN_PHAM_MATRANPHI,
                            true
                        );
                        UpdateContext(
                            {
                                valMaYT: If(
                                    CountIf(
                                        DL_SAN_PHAM_YT,
                                        true
                                    ) = 0,
                                    1,
                                    Value(
                                        Last(
                                            SortByColumns(
                                                DL_SAN_PHAM_YT,
                                                "cr282_ma_yeu_to_sp",
                                                SortOrder.Ascending
                                            )
                                        ).MA_YEU_TO_SP
                                    ) + 1
                                )
                            }
                        );
                        If(
                            IsBlank(
                                LookUp(
                                    DL_SAN_PHAM_YT,
                                    MA_SAN_PHAM = valMaSP
                                ).MA_YEU_TO_SP
                            ),
                            Patch(
                                DL_SAN_PHAM_YT,
                                {
                                    MA_SAN_PHAM: valMaSP,
                                    MA_YEU_TO_SP: Concatenate(
                                        If(
                                            valMaYT < 10,
                                            "00",
                                            If(
                                                valMaYT < 100 && valMaYT >= 10,
                                                "0",
                                                ""
                                            )
                                        ),
                                        Text(valMaYT)
                                    ),
                                    CHUONG_TRINH: Concat(Datafield_CT.SelectedItems, TEN_CHUONG_TRINH,", "),
                                    NHOM_TINH_PHI: Concat(Datafield_Nhom.SelectedItems,TEN_NHOM_TP,", "),
                                    PHAM_VI_DL: Datafield_PV.Selected.TEN_PHAMVI,
                                    CHECKED_DOTUOI: If(
                                        DoTuoi.Visible = true && DoTuoi.Value = true,
                                        true,
                                        false
                                    ),
                                    CHECKED_GIOITINH: If(
                                        GioiTinh.Visible = true && GioiTinh.Value = true,
                                        true,
                                        false
                                    ),
                                    CHECKED_NGANHNGHE: If(
                                        NganhNghe.Visible = true && NganhNghe.Value = true,
                                        true,
                                        false
                                    ),
                                    CHECKED_SOTIEN: If(
                                        BH_SoTien.Visible = true && BH_SoTien.Value = true,
                                        true,
                                        false
                                    ),
                                    CHECKED_SONGUOI: If(
                                        BH_SoNguoi.Visible = true && BH_SoNguoi.Value = true,
                                        true,
                                        false
                                    ),
                                    CHECKED_THOIHAN: If(
                                        BH_ThoiHan.Visible = true && BH_ThoiHan.Value = true,
                                        true,
                                        false
                                    ),
                                    CHECKED_DONGPHI: If(
                                        BH_PhuongThuc.Visible = true && BH_PhuongThuc.Value = true,
                                        true,
                                        false
                                    ),
                                    DON_VI_TIEN: DsTienTe.Selected.TIEN_TE,
                                    DO_TUOI: Concat(Datafield_DT.SelectedItems,MO_TA,", "),
                                    GIOI_TINH: Concat(Datafield_GT.SelectedItems,TEN_GIOI_TINH,", "),
                                    NGANH_NGHE: Concat(Datafield_NN.SelectedItems,TEN_NGANH,", "),
                                    BH_SO_TIEN: Concat(Datafield_ST.SelectedItems,TEN_SOTIEN,", "),
                                    BH_SO_NGUOI: Concat(Datafield_SN.SelectedItems,TEN_SO_NGUOI,", "),
                                    BH_THOI_HAN: Concat(Datafield_TH.SelectedItems,TEN_THOI_HAN,", "),
                                    BH_PHUONG_THUC_DP: Concat(Datafield_DP.SelectedItems,TEN_PT,", ")
                                }
                            ),
                            UpdateIf(
                                DL_SAN_PHAM_YT,
                                MA_SAN_PHAM = valMaSP,
                                {
                                    CHUONG_TRINH: Concat(Datafield_CT.SelectedItems, TEN_CHUONG_TRINH,", "),
                                    NHOM_TINH_PHI: Concat(Datafield_Nhom.SelectedItems,TEN_NHOM_TP,", "),
                                    PHAM_VI_DL: Datafield_PV.Selected.TEN_PHAMVI,
                                    CHECKED_DOTUOI: If(
                                        DoTuoi.Visible = true && DoTuoi.Value = true,
                                        true,
                                        false
                                    ),
                                    CHECKED_GIOITINH: If(
                                        GioiTinh.Visible = true && GioiTinh.Value = true,
                                        true,
                                        false
                                    ),
                                    CHECKED_NGANHNGHE: If(
                                        NganhNghe.Visible = true && NganhNghe.Value = true,
                                        true,
                                        false
                                    ),
                                    CHECKED_SOTIEN: If(
                                        BH_SoTien.Visible = true && BH_SoTien.Value = true,
                                        true,
                                        false
                                    ),
                                    CHECKED_SONGUOI: If(
                                        BH_SoNguoi.Visible = true && BH_SoNguoi.Value = true,
                                        true,
                                        false
                                    ),
                                    CHECKED_THOIHAN: If(
                                        BH_ThoiHan.Visible = true && BH_ThoiHan.Value = true,
                                        true,
                                        false
                                    ),
                                    CHECKED_DONGPHI: If(
                                        BH_PhuongThuc.Visible = true && BH_PhuongThuc.Value = true,
                                        true,
                                        false
                                    ),
                                    DON_VI_TIEN: DsTienTe.Selected.TIEN_TE,
                                    DO_TUOI: Concat(Datafield_DT.SelectedItems,MO_TA,", "),
                                    GIOI_TINH: Concat(Datafield_GT.SelectedItems,TEN_GIOI_TINH,", "),
                                    NGANH_NGHE: Concat(Datafield_NN.SelectedItems,TEN_NGANH,", "),
                                    BH_SO_TIEN: Concat(Datafield_ST.SelectedItems,TEN_SOTIEN,", "),
                                    BH_SO_NGUOI: Concat(Datafield_SN.SelectedItems,TEN_SO_NGUOI,", "),
                                    BH_THOI_HAN: Concat(Datafield_TH.SelectedItems,TEN_THOI_HAN,", "),
                                    BH_PHUONG_THUC_DP: Concat(Datafield_DP.SelectedItems,TEN_PT,", ")
                                }
                            )
                        );
                        UpdateContext({showGrid: true});
                    Text: ="Lưu"
                    X: =976
                    Y: =708
                    ZIndex: =17

                Datafield_PV As dropdown:
                    Height: =45
                    Items: =DM_PHAMVI_DIALYS
                    Visible: =If(PVDiaLy.Value=true && PVDiaLy.Visible=true,true,false)
                    Width: =840
                    X: =296
                    Y: =216
                    ZIndex: =18

                Datafield_NN As combobox:
                    DisplayFields: =["cr282_ten_nganh"]
                    Height: =45
                    InputTextPlaceholder: =""
                    IsSearchable: =false
                    Items: =BH_DM_NGANHNGHES
                    SearchFields: =["cr282_ten_nganh"]
                    SearchItems: =[]
                    Visible: =If(NganhNghe.Value=true && NganhNghe.Visible=true,true,false)
                    Width: =840
                    X: =296
                    Y: =398
                    ZIndex: =19

                Datafield_ST As combobox:
                    DisplayFields: =["cr282_ten_sotien"]
                    Height: =45
                    InputTextPlaceholder: =""
                    IsSearchable: =false
                    Items: =BH_DM_SOTIEN
                    SearchFields: =["cr282_ten_sotien"]
                    SearchItems: =[]
                    Visible: =If(BH_SoTien.Value=true && BH_SoTien.Visible=true,true,false)
                    Width: =840
                    X: =296
                    Y: =457
                    ZIndex: =20

                Datafield_SN As combobox:
                    DisplayFields: =["cr282_ten_so_nguoi"]
                    Height: =45
                    InputTextPlaceholder: =""
                    IsSearchable: =false
                    Items: =BH_DM_SONGUOI
                    SearchFields: =["cr282_ten_so_nguoi"]
                    SearchItems: =[]
                    Visible: =If(BH_SoNguoi.Value=true && BH_SoNguoi.Visible=true,true,false)
                    Width: =840
                    X: =296
                    Y: =513
                    ZIndex: =21

                Datafield_TH As combobox:
                    DisplayFields: =["cr282_ten_thoi_han"]
                    Height: =45
                    InputTextPlaceholder: =""
                    IsSearchable: =false
                    Items: =BH_DM_THOIHAN
                    SearchFields: =["cr282_ten_thoi_han"]
                    SearchItems: =[]
                    Visible: =If(BH_ThoiHan.Value=true && BH_ThoiHan.Visible=true,true,false)
                    Width: =840
                    X: =296
                    Y: =577
                    ZIndex: =22

                Datafield_DP As combobox:
                    DisplayFields: =["cr282_ten_pt"]
                    Height: |
                        =45
                    InputTextPlaceholder: =""
                    IsSearchable: =false
                    Items: =BH_DM_PT_DONG
                    SearchFields: =["cr282_ten_pt"]
                    SearchItems: =[]
                    Visible: =If(BH_PhuongThuc.Value=true && BH_PhuongThuc.Visible=true,true,false)
                    Width: =840
                    X: =296
                    Y: =646
                    ZIndex: =23

                SuaYT As button:
                    OnSelect: |
                        =If(
                            CountRows(DL_SAN_PHAM_YTCT) > 0,
                            RemoveIf(
                                DL_SAN_PHAM_YTCT,
                                true
                            )
                        );
                        If(
                            CountRows(DL_SAN_PHAM_MATRANPHI) > 0,
                            RemoveIf(
                                DL_SAN_PHAM_MATRANPHI,
                                true
                            )
                        );
                        UpdateContext({showGrid: false});
                    Text: ="Sửa"
                    X: =751
                    Y: =708
                    ZIndex: =24

                Label1_5 As label:
                    Align: =Align.Justify
                    FontWeight: =FontWeight.Bold
                    Height: =46
                    Size: =16
                    Text: ="4.1.1. Các yếu tố ảnh hưởng"
                    Width: =1204
                    X: =3
                    Y: =18
                    ZIndex: =25

                DoTuoi As checkbox:
                    Default: =true
                    Text: ="Độ tuổi"
                    Visible: |-
                        =LookUp(
                            DM_YEUTO_AH_PHIS,
                            TEN_YEU_TO = "Độ tuổi"
                        ).HIEU_LUC_TU <= Today() && (LookUp(
                            DM_YEUTO_AH_PHIS,
                            TEN_YEU_TO = "Độ tuổi"
                        ).HIEU_LUC_DEN >= Today() || IsBlank(
                            LookUp(
                                DM_YEUTO_AH_PHIS,
                                TEN_YEU_TO = "Độ tuổi"
                            ).HIEU_LUC_DEN
                        ))
                    Width: =192
                    X: =38
                    Y: =274
                    ZIndex: =26

        DataCard3 As dataCard.blankCard:
            BorderColor: =RGBA(0, 0, 0, 1)
            BorderStyle: =BorderStyle.Solid
            DisplayMode: =DisplayMode.Edit
            Fill: =RGBA(0, 0, 0, 0)
            Height: =648
            Width: =1366
            X: =0
            Y: =2
            ZIndex: =3

            Container3 As groupContainer.manualLayoutContainer:
                Height: =612
                Width: =1207
                X: =148
                Y: =40
                ZIndex: =1

                BadgeCanvas1_10 As Badge:
                    BasePaletteColor: =
                    Content: =""
                    DisplayMode: =DisplayMode.Edit
                    FontColor: =
                    Height: =45
                    Visible: =showGrid
                    Width: =1195
                    X: =12
                    Y: =122
                    ZIndex: =1

                "Gallery As gallery.'BrowseLayout_Vertical_OneTextVariant_ver5.0'":
                    DelayItemLoading: =true
                    Height: =284
                    Items: |-
                        =GroupBy(
                            Filter(DL_SAN_PHAM_YTCT,MA_SAN_PHAM=valMaSP),
                            "cr282_nhom_tinh_phi",
                            "cr282_do_tuoi",
                            "cr282_pham_vi_dl",
                            "cr282_bh_phuong_thuc",
                            "cr282_bh_songuoi",
                            "cr282_bh_sotien",
                            "cr282_bh_thoihan",
                            "cr282_gioi_tinh",
                            "cr282_nganh_nghe",
                            "CHUONG_TRINH_GROUP"
                        )
                    Layout: =Layout.Vertical
                    LoadingSpinner: =LoadingSpinner.Data
                    TemplatePadding: =0
                    TemplateSize: =62
                    Width: =1207
                    Y: =167
                    ZIndex: =2

                    Combo_CT As combobox:
                        DefaultSelectedItems: =ThisItem.CHUONG_TRINH_GROUP
                        DisplayFields: =["cr282_ten_chuong_trinh"]
                        Height: =31
                        InputTextPlaceholder: =""
                        IsSearchable: =false
                        Items: =Datafield_CT.SelectedItems
                        OnSelect: =Select(Parent)
                        SearchFields: =["cr282_ten_chuong_trinh"]
                        SearchItems: =[]
                        Width: =176
                        X: =16
                        Y: =19
                        ZIndex: =5

                    Dropdown_TP As dropdown:
                        Default: =ThisItem.cr282_nhom_tinh_phi
                        Height: =31
                        Items: =Datafield_Nhom.SelectedItems
                        OnSelect: =Select(Parent)
                        Width: =145
                        X: =192
                        Y: =19
                        ZIndex: =6

                    Checkbox_PV As checkbox:
                        Default: =ThisItem.cr282_pham_vi_dl
                        DisplayMode: =If(PVDiaLy.Value=true, DisplayMode.Edit, DisplayMode.Disabled)
                        Height: =52
                        OnSelect: =Select(Parent)
                        Text: =""
                        Width: =50
                        X: =363
                        Y: =9
                        ZIndex: =7

                    Checkbox_DT As checkbox:
                        Default: =ThisItem.cr282_do_tuoi
                        DisplayMode: =If(DoTuoi.Value=true, DisplayMode.Edit,DisplayMode.Disabled)
                        Height: =52
                        OnSelect: =Select(Parent)
                        Text: =""
                        Width: =50
                        X: =445
                        Y: =9
                        ZIndex: =8

                    Checkbox_GT As checkbox:
                        Default: =ThisItem.cr282_gioi_tinh
                        DisplayMode: =If(GioiTinh.Value=true, DisplayMode.Edit, DisplayMode.Disabled)
                        Height: =52
                        OnSelect: =Select(Parent)
                        Text: =""
                        Width: =50
                        X: =531
                        Y: =9
                        ZIndex: =9

                    Icon1_2 As icon.Cancel:
                        Height: =36
                        Icon: =Icon.Cancel
                        OnSelect: |
                            =RemoveIf(DL_SAN_PHAM_YTCT, ID="NULL");
                            ForAll(
                                Combo_CT.SelectedItems As ct,
                                RemoveIf(
                                    DL_SAN_PHAM_YTCT,
                                    ID = Concatenate(
                                        Dropdown_TP.Selected.TEN_NHOM_TP,
                                        "- ",
                                        ct.TEN_CHUONG_TRINH
                                    ) && MA_SAN_PHAM = valMaSP
                                )
                            );
                        Width: =38
                        X: =1165
                        Y: =17
                        ZIndex: =10

                    Icon2 As icon.Save:
                        Height: =42
                        Icon: =Icon.Save
                        OnSelect: |-
                            =RemoveIf(
                                DL_SAN_PHAM_YTCT,
                                ID = "NULL"
                            );
                            UpdateContext(
                                {
                                    maxIdYTCT: If(
                                        CountIf(
                                            DL_SAN_PHAM_YTCT,
                                            true
                                        ) = 0,
                                        0,
                                        Value(
                                            Last(
                                                SortByColumns(
                                                    DL_SAN_PHAM_YTCT,
                                                    "cr282_id",
                                                    SortOrder.Ascending
                                                )
                                            ).ID
                                        )
                                    )
                                }
                            );
                            ForAll(
                                Combo_CT.SelectedItems As ct,
                                If(
                                    IsBlank(
                                        LookUp(
                                            DL_SAN_PHAM_YTCT,
                                            CHUONGTRINH_NHOMTP = Concatenate(
                                                Dropdown_TP.Selected.TEN_NHOM_TP,
                                                "- ",
                                                ct.TEN_CHUONG_TRINH
                                            ) && MA_SAN_PHAM = valMaSP
                                        ).ID
                                    ),
                                    Patch(
                                        DL_SAN_PHAM_YTCT,
                                        Defaults(DL_SAN_PHAM_YTCT),
                                        {
                                            ID: Concatenate(
                                                Dropdown_TP.Selected.TEN_NHOM_TP,
                                                "- ",
                                                ct.TEN_CHUONG_TRINH
                                            ),
                                            CHUONGTRINH_NHOMTP: Concatenate(
                                                Dropdown_TP.Selected.TEN_NHOM_TP,
                                                "- ",
                                                ct.TEN_CHUONG_TRINH
                                            ),
                                            MA_SAN_PHAM: valMaSP,
                                            CHUONG_TRINH: ct.TEN_CHUONG_TRINH,
                                            NHOM_TINH_PHI: Dropdown_TP.Selected.TEN_NHOM_TP,
                                            GIOI_TINH: Checkbox_GT.Value,
                                            PHAM_VI_DL: Checkbox_PV.Value,
                                            DO_TUOI: Checkbox_DT.Value,
                                            NGANH_NGHE: Checkbox_NN.Value,
                                            BH_SOTIEN: Checkbox_ST.Value,
                                            BH_SONGUOI: Checkbox_SN.Value,
                                            BH_THOIHAN: Checkbox_TH.Value,
                                            BH_PHUONG_THUC: Checkbox_PT.Value
                                        }
                                    ),
                                    UpdateIf(
                                        DL_SAN_PHAM_YTCT,
                                        CHUONGTRINH_NHOMTP = Concatenate(
                                            Dropdown_TP.Selected.TEN_NHOM_TP,
                                            "- ",
                                            ct.TEN_CHUONG_TRINH
                                        ) && MA_SAN_PHAM = valMaSP,
                                        {
                                            CHUONG_TRINH: ct.TEN_CHUONG_TRINH,
                                            NHOM_TINH_PHI: Dropdown_TP.Selected.TEN_NHOM_TP,
                                            GIOI_TINH: Checkbox_GT.Value,
                                            PHAM_VI_DL: Checkbox_PV.Value,
                                            DO_TUOI: Checkbox_DT.Value,
                                            NGANH_NGHE: Checkbox_NN.Value,
                                            BH_SOTIEN: Checkbox_ST.Value,
                                            BH_SONGUOI: Checkbox_SN.Value,
                                            BH_THOIHAN: Checkbox_TH.Value,
                                            BH_PHUONG_THUC: Checkbox_PT.Value
                                        }
                                    )
                                )
                            )
                        Width: =38
                        X: =1096
                        Y: =17
                        ZIndex: =11

                    Checkbox_NN As checkbox:
                        Default: =ThisItem.cr282_nganh_nghe
                        DisplayMode: =If(NganhNghe.Value=true, DisplayMode.Edit, DisplayMode.Disabled)
                        Height: =52
                        OnSelect: =Select(Parent)
                        Text: =""
                        Width: =50
                        X: =618
                        Y: =9
                        ZIndex: =12

                    Checkbox_ST As checkbox:
                        Default: =ThisItem.cr282_bh_sotien
                        DisplayMode: =If(BH_SoTien.Value=true, DisplayMode.Edit, DisplayMode.Disabled)
                        Height: =52
                        OnSelect: =Select(Parent)
                        Text: =""
                        Width: =50
                        X: =729
                        Y: =9
                        ZIndex: =13

                    Checkbox_SN As checkbox:
                        Default: =ThisItem.cr282_bh_songuoi
                        DisplayMode: =If(BH_SoNguoi.Value=true, DisplayMode.Edit, DisplayMode.Disabled)
                        Height: =52
                        OnSelect: =Select(Parent)
                        Text: =""
                        Width: =50
                        X: =828
                        Y: =9
                        ZIndex: =14

                    Checkbox_TH As checkbox:
                        Default: =ThisItem.cr282_bh_thoihan
                        DisplayMode: =If(BH_ThoiHan.Value=true, DisplayMode.Edit, DisplayMode.Disabled)
                        Height: =52
                        OnSelect: =Select(Parent)
                        Text: =""
                        Width: =50
                        X: =925
                        Y: =9
                        ZIndex: =15

                    Checkbox_PT As checkbox:
                        Default: =ThisItem.cr282_bh_phuong_thuc
                        DisplayMode: =If(BH_PhuongThuc.Value=true, DisplayMode.Edit, DisplayMode.Disabled)
                        Height: =52
                        OnSelect: =Select(Parent)
                        Text: =""
                        Width: =50
                        X: =1023
                        Y: =9
                        ZIndex: =16

                Label_ct As label:
                    Height: =45
                    Text: ="Chương trình"
                    Visible: =showGrid
                    Width: =130
                    X: =28
                    Y: =120
                    ZIndex: =3

                Label_nhom As label:
                    Height: =45
                    Text: ="Nhóm tính phí"
                    Visible: =showGrid
                    Width: =145
                    X: =191
                    Y: =119
                    ZIndex: =4

                Label_pv As label:
                    Height: =45
                    Text: ="Phạm vi"
                    Visible: =showGrid
                    Width: =75
                    X: =344
                    Y: =119
                    ZIndex: =5

                Label_dt As label:
                    Height: =45
                    Text: ="Độ tuổi"
                    Visible: =showGrid
                    Width: =82
                    X: =427
                    Y: =120
                    ZIndex: =6

                Label_gt As label:
                    Height: =45
                    Text: ="Giới tính"
                    Visible: =showGrid
                    Width: =84
                    X: =513
                    Y: =119
                    ZIndex: =7

                Label_thaotac As label:
                    Height: =45
                    Text: ="Thao tác"
                    Visible: =showGrid
                    Width: =82
                    X: =1108
                    Y: =120
                    ZIndex: =8

                ThemMoi_1 As button:
                    OnSelect: |-
                        =Patch(
                            DL_SAN_PHAM_YTCT,
                            Defaults(DL_SAN_PHAM_YTCT),
                            {
                                ID:"NULL",
                                MA_SAN_PHAM: valMaSP
                            }
                        );
                    Text: ="Thêm mới"
                    Visible: =showGrid
                    X: =12
                    Y: =59
                    ZIndex: =9

                Label_st As label:
                    Height: =44
                    Text: |-
                        ="Số tiền 
                        bảo hiểm"
                    Visible: =showGrid
                    Width: =95
                    X: =706
                    Y: =123
                    ZIndex: =10

                Label_nn As label:
                    Height: =45
                    Text: ="Ngành nghề"
                    Visible: =showGrid
                    Width: =115
                    X: =592
                    Y: =120
                    ZIndex: =11

                Label_th As label:
                    Height: =44
                    Text: |-
                        ="Thời hạn 
                        bảo hiểm"
                    Visible: =showGrid
                    Width: =95
                    X: =896
                    Y: =122
                    ZIndex: =12

                Label_pt As label:
                    Height: =43
                    Text: |-
                        ="Phương thức
                        đóng phí"
                    Visible: =showGrid
                    Width: =116
                    X: =991
                    Y: =122
                    ZIndex: =13

                LuuYeuTo As button:
                    OnSelect: |-
                        =If(CountRows(DL_SAN_PHAM_MATRANPHI)>0,
                        RemoveIf(
                            DL_SAN_PHAM_MATRANPHI,
                            true
                        ));
                        If(
                            !IsEmpty(DL_SAN_PHAM_YTCT),
                            ForAll(
                                DL_SAN_PHAM_YTCT As ct,
                                If(
                                    ct.DO_TUOI = true,
                                    ForAll(
                                        Datafield_DT.SelectedItems As dt,
                                        If(
                                            ct.GIOI_TINH = true,
                                            ForAll(
                                                Datafield_GT.SelectedItems As gt,
                                                If(
                                                    ct.NGANH_NGHE = true,
                                                    ForAll(
                                                        Datafield_NN.SelectedItems As nn,
                                                        If(
                                                            ct.BH_SOTIEN = true,
                                                            ForAll(
                                                                Datafield_ST.SelectedItems As st,
                                                                If(
                                                                    ct.BH_SONGUOI = true,
                                                                    ForAll(
                                                                        Datafield_SN.SelectedItems As sn,
                                                                        If(
                                                                            ct.BH_THOIHAN = true,
                                                                            ForAll(
                                                                                Datafield_TH.SelectedItems As th,
                                                                                If(
                                                                                    ct.BH_PHUONG_THUC = true,
                                                                                    ForAll(
                                                                                        Datafield_DP.SelectedItems As dp,
                                                                                        Patch(
                                                                                            DL_SAN_PHAM_MATRANPHI,
                                                                                            Defaults(DL_SAN_PHAM_MATRANPHI),
                                                                                            {
                                                                                                ID: ct.ID,
                                                                                                MA_SAN_PHAM: valMaSP,
                                                                                                CHUONG_TRINH: ct.CHUONG_TRINH,
                                                                                                NHOM_TINH_PHI: ct.NHOM_TINH_PHI,
                                                                                                DO_TUOI: dt.MO_TA,
                                                                                                GIOI_TINH: gt.TEN_GIOI_TINH,
                                                                                                PHAM_VI_DL: If(
                                                                                                    ct.PHAM_VI_DL = true,
                                                                                                    Datafield_PV.Selected.TEN_PHAMVI,
                                                                                                    ""
                                                                                                ),
                                                                                                NGANH_NGHE: nn.TEN_NGANH,
                                                                                                SO_TIEN: st.TEN_SOTIEN,
                                                                                                SO_NGUOI: sn.TEN_SO_NGUOI,
                                                                                                THOI_HAN: th.TEN_THOI_HAN,
                                                                                                PHUONG_THUC_DP: dp.TEN_PT
                                                                                            }
                                                                                        )
                                                                                    ),
                                                                                    Patch(
                                                                                        DL_SAN_PHAM_MATRANPHI,
                                                                                        Defaults(DL_SAN_PHAM_MATRANPHI),
                                                                                        {ID: ct.ID,
                                                                                            MA_SAN_PHAM: valMaSP,
                                                                                            CHUONG_TRINH: ct.CHUONG_TRINH,
                                                                                            NHOM_TINH_PHI: ct.NHOM_TINH_PHI,
                                                                                            DO_TUOI: dt.MO_TA,
                                                                                            GIOI_TINH: gt.TEN_GIOI_TINH,
                                                                                            PHAM_VI_DL: If(
                                                                                                ct.PHAM_VI_DL = true,
                                                                                                Datafield_PV.Selected.TEN_PHAMVI,
                                                                                                ""
                                                                                            ),
                                                                                            NGANH_NGHE: nn.TEN_NGANH,
                                                                                            SO_TIEN: st.TEN_SOTIEN,
                                                                                            SO_NGUOI: sn.TEN_SO_NGUOI,
                                                                                            THOI_HAN: th.TEN_THOI_HAN,
                                                                                            PHUONG_THUC_DP: ""
                                                                                        }
                                                                                    )
                                                                                )
                                                                            ),
                                                                            If(
                                                                                ct.BH_PHUONG_THUC = true,
                                                                                ForAll(
                                                                                    Datafield_DP.SelectedItems As dp,
                                                                                    Patch(
                                                                                        DL_SAN_PHAM_MATRANPHI,
                                                                                        Defaults(DL_SAN_PHAM_MATRANPHI),
                                                                                        {ID: ct.ID,
                                                                                            MA_SAN_PHAM: valMaSP,
                                                                                            CHUONG_TRINH: ct.CHUONG_TRINH,
                                                                                            NHOM_TINH_PHI: ct.NHOM_TINH_PHI,
                                                                                            DO_TUOI: dt.MO_TA,
                                                                                            GIOI_TINH: gt.TEN_GIOI_TINH,
                                                                                            PHAM_VI_DL: If(
                                                                                                ct.PHAM_VI_DL = true,
                                                                                                Datafield_PV.Selected.TEN_PHAMVI,
                                                                                                ""
                                                                                            ),
                                                                                            NGANH_NGHE: nn.TEN_NGANH,
                                                                                            SO_TIEN: st.TEN_SOTIEN,
                                                                                            SO_NGUOI: sn.TEN_SO_NGUOI,
                                                                                            THOI_HAN: "",
                                                                                            PHUONG_THUC_DP: dp.TEN_PT
                                                                                        }
                                                                                    )
                                                                                ),
                                                                                Patch(
                                                                                    DL_SAN_PHAM_MATRANPHI,
                                                                                    Defaults(DL_SAN_PHAM_MATRANPHI),
                                                                                    {ID: ct.ID,
                                                                                        MA_SAN_PHAM: valMaSP,
                                                                                        CHUONG_TRINH: ct.CHUONG_TRINH,
                                                                                        NHOM_TINH_PHI: ct.NHOM_TINH_PHI,
                                                                                        DO_TUOI: dt.MO_TA,
                                                                                        GIOI_TINH: gt.TEN_GIOI_TINH,
                                                                                        PHAM_VI_DL: If(
                                                                                            ct.PHAM_VI_DL = true,
                                                                                            Datafield_PV.Selected.TEN_PHAMVI,
                                                                                            ""
                                                                                        ),
                                                                                        NGANH_NGHE: nn.TEN_NGANH,
                                                                                        SO_TIEN: st.TEN_SOTIEN,
                                                                                        SO_NGUOI: sn.TEN_SO_NGUOI,
                                                                                        THOI_HAN: "",
                                                                                        PHUONG_THUC_DP: ""
                                                                                    }
                                                                                )
                                                                            )
                                                                        )
                                                                    ),
                                                                    If(
                                                                        ct.BH_THOIHAN = true,
                                                                        ForAll(
                                                                            Datafield_TH.SelectedItems As th,
                                                                            If(
                                                                                ct.BH_PHUONG_THUC = true,
                                                                                ForAll(
                                                                                    Datafield_DP.SelectedItems As dp,
                                                                                    Patch(
                                                                                        DL_SAN_PHAM_MATRANPHI,
                                                                                        Defaults(DL_SAN_PHAM_MATRANPHI),
                                                                                        {ID: ct.ID,
                                                                                            MA_SAN_PHAM: valMaSP,
                                                                                            CHUONG_TRINH: ct.CHUONG_TRINH,
                                                                                            NHOM_TINH_PHI: ct.NHOM_TINH_PHI,
                                                                                            DO_TUOI: dt.MO_TA,
                                                                                            GIOI_TINH: gt.TEN_GIOI_TINH,
                                                                                            PHAM_VI_DL: If(
                                                                                                ct.PHAM_VI_DL = true,
                                                                                                Datafield_PV.Selected.TEN_PHAMVI,
                                                                                                ""
                                                                                            ),
                                                                                            NGANH_NGHE: nn.TEN_NGANH,
                                                                                            SO_TIEN: st.TEN_SOTIEN,
                                                                                            SO_NGUOI: "",
                                                                                            THOI_HAN: th.TEN_THOI_HAN,
                                                                                            PHUONG_THUC_DP: dp.TEN_PT
                                                                                        }
                                                                                    )
                                                                                ),
                                                                                Patch(
                                                                                    DL_SAN_PHAM_MATRANPHI,
                                                                                    Defaults(DL_SAN_PHAM_MATRANPHI),
                                                                                    {ID: ct.ID,
                                                                                        MA_SAN_PHAM: valMaSP,
                                                                                        CHUONG_TRINH: ct.CHUONG_TRINH,
                                                                                        NHOM_TINH_PHI: ct.NHOM_TINH_PHI,
                                                                                        DO_TUOI: dt.MO_TA,
                                                                                        GIOI_TINH: gt.TEN_GIOI_TINH,
                                                                                        PHAM_VI_DL: If(
                                                                                            ct.PHAM_VI_DL = true,
                                                                                            Datafield_PV.Selected.TEN_PHAMVI,
                                                                                            ""
                                                                                        ),
                                                                                        NGANH_NGHE: nn.TEN_NGANH,
                                                                                        SO_TIEN: st.TEN_SOTIEN,
                                                                                        SO_NGUOI: "",
                                                                                        THOI_HAN: th.TEN_THOI_HAN,
                                                                                        PHUONG_THUC_DP: ""
                                                                                    }
                                                                                )
                                                                            )
                                                                        ),
                                                                        If(
                                                                            ct.BH_PHUONG_THUC = true,
                                                                            ForAll(
                                                                                Datafield_DP.SelectedItems As dp,
                                                                                Patch(
                                                                                    DL_SAN_PHAM_MATRANPHI,
                                                                                    Defaults(DL_SAN_PHAM_MATRANPHI),
                                                                                    {ID: ct.ID,
                                                                                        MA_SAN_PHAM: valMaSP,
                                                                                        CHUONG_TRINH: ct.CHUONG_TRINH,
                                                                                        NHOM_TINH_PHI: ct.NHOM_TINH_PHI,
                                                                                        DO_TUOI: dt.MO_TA,
                                                                                        GIOI_TINH: gt.TEN_GIOI_TINH,
                                                                                        PHAM_VI_DL: If(
                                                                                            ct.PHAM_VI_DL = true,
                                                                                            Datafield_PV.Selected.TEN_PHAMVI,
                                                                                            ""
                                                                                        ),
                                                                                        NGANH_NGHE: nn.TEN_NGANH,
                                                                                        SO_TIEN: st.TEN_SOTIEN,
                                                                                        SO_NGUOI: "",
                                                                                        THOI_HAN: "",
                                                                                        PHUONG_THUC_DP: dp.TEN_PT
                                                                                    }
                                                                                )
                                                                            ),
                                                                            Patch(
                                                                                DL_SAN_PHAM_MATRANPHI,
                                                                                Defaults(DL_SAN_PHAM_MATRANPHI),
                                                                                {ID: ct.ID,
                                                                                    MA_SAN_PHAM: valMaSP,
                                                                                    CHUONG_TRINH: ct.CHUONG_TRINH,
                                                                                    NHOM_TINH_PHI: ct.NHOM_TINH_PHI,
                                                                                    DO_TUOI: dt.MO_TA,
                                                                                    GIOI_TINH: gt.TEN_GIOI_TINH,
                                                                                    PHAM_VI_DL: If(
                                                                                        ct.PHAM_VI_DL = true,
                                                                                        Datafield_PV.Selected.TEN_PHAMVI,
                                                                                        ""
                                                                                    ),
                                                                                    NGANH_NGHE: nn.TEN_NGANH,
                                                                                    SO_TIEN: st.TEN_SOTIEN,
                                                                                    SO_NGUOI: "",
                                                                                    THOI_HAN: "",
                                                                                    PHUONG_THUC_DP: ""
                                                                                }
                                                                            )
                                                                        )
                                                                    )
                                                                )
                                                            ),
                                                            If(
                                                                ct.BH_SONGUOI = true,
                                                                ForAll(
                                                                    Datafield_SN.SelectedItems As sn,
                                                                    If(
                                                                        ct.BH_THOIHAN = true,
                                                                        ForAll(
                                                                            Datafield_TH.SelectedItems As th,
                                                                            If(
                                                                                ct.BH_PHUONG_THUC = true,
                                                                                ForAll(
                                                                                    Datafield_DP.SelectedItems As dp,
                                                                                    Patch(
                                                                                        DL_SAN_PHAM_MATRANPHI,
                                                                                        Defaults(DL_SAN_PHAM_MATRANPHI),
                                                                                        {ID: ct.ID,
                                                                                            MA_SAN_PHAM: valMaSP,
                                                                                            CHUONG_TRINH: ct.CHUONG_TRINH,
                                                                                            NHOM_TINH_PHI: ct.NHOM_TINH_PHI,
                                                                                            DO_TUOI: dt.MO_TA,
                                                                                            GIOI_TINH: gt.TEN_GIOI_TINH,
                                                                                            PHAM_VI_DL: If(
                                                                                                ct.PHAM_VI_DL = true,
                                                                                                Datafield_PV.Selected.TEN_PHAMVI,
                                                                                                ""
                                                                                            ),
                                                                                            NGANH_NGHE: nn.TEN_NGANH,
                                                                                            SO_TIEN: "",
                                                                                            SO_NGUOI: sn.TEN_SO_NGUOI,
                                                                                            THOI_HAN: th.TEN_THOI_HAN,
                                                                                            PHUONG_THUC_DP: dp.TEN_PT
                                                                                        }
                                                                                    )
                                                                                ),
                                                                                Patch(
                                                                                    DL_SAN_PHAM_MATRANPHI,
                                                                                    Defaults(DL_SAN_PHAM_MATRANPHI),
                                                                                    {ID: ct.ID,
                                                                                        MA_SAN_PHAM: valMaSP,
                                                                                        CHUONG_TRINH: ct.CHUONG_TRINH,
                                                                                        NHOM_TINH_PHI: ct.NHOM_TINH_PHI,
                                                                                        DO_TUOI: dt.MO_TA,
                                                                                        GIOI_TINH: gt.TEN_GIOI_TINH,
                                                                                        PHAM_VI_DL: If(
                                                                                            ct.PHAM_VI_DL = true,
                                                                                            Datafield_PV.Selected.TEN_PHAMVI,
                                                                                            ""
                                                                                        ),
                                                                                        NGANH_NGHE: nn.TEN_NGANH,
                                                                                        SO_TIEN: "",
                                                                                        SO_NGUOI: sn.TEN_SO_NGUOI,
                                                                                        THOI_HAN: th.TEN_THOI_HAN,
                                                                                        PHUONG_THUC_DP: ""
                                                                                    }
                                                                                )
                                                                            )
                                                                        ),
                                                                        If(
                                                                            ct.BH_PHUONG_THUC = true,
                                                                            ForAll(
                                                                                Datafield_DP.SelectedItems As dp,
                                                                                Patch(
                                                                                    DL_SAN_PHAM_MATRANPHI,
                                                                                    Defaults(DL_SAN_PHAM_MATRANPHI),
                                                                                    {ID: ct.ID,
                                                                                        MA_SAN_PHAM: valMaSP,
                                                                                        CHUONG_TRINH: ct.CHUONG_TRINH,
                                                                                        NHOM_TINH_PHI: ct.NHOM_TINH_PHI,
                                                                                        DO_TUOI: dt.MO_TA,
                                                                                        GIOI_TINH: gt.TEN_GIOI_TINH,
                                                                                        PHAM_VI_DL: If(
                                                                                            ct.PHAM_VI_DL = true,
                                                                                            Datafield_PV.Selected.TEN_PHAMVI,
                                                                                            ""
                                                                                        ),
                                                                                        NGANH_NGHE: nn.TEN_NGANH,
                                                                                        SO_TIEN: "",
                                                                                        SO_NGUOI: sn.TEN_SO_NGUOI,
                                                                                        THOI_HAN: "",
                                                                                        PHUONG_THUC_DP: dp.TEN_PT
                                                                                    }
                                                                                )
                                                                            ),
                                                                            Patch(
                                                                                DL_SAN_PHAM_MATRANPHI,
                                                                                Defaults(DL_SAN_PHAM_MATRANPHI),
                                                                                {ID: ct.ID,
                                                                                    MA_SAN_PHAM: valMaSP,
                                                                                    CHUONG_TRINH: ct.CHUONG_TRINH,
                                                                                    NHOM_TINH_PHI: ct.NHOM_TINH_PHI,
                                                                                    DO_TUOI: dt.MO_TA,
                                                                                    GIOI_TINH: gt.TEN_GIOI_TINH,
                                                                                    PHAM_VI_DL: If(
                                                                                        ct.PHAM_VI_DL = true,
                                                                                        Datafield_PV.Selected.TEN_PHAMVI,
                                                                                        ""
                                                                                    ),
                                                                                    NGANH_NGHE: nn.TEN_NGANH,
                                                                                    SO_TIEN: "",
                                                                                    SO_NGUOI: sn.TEN_SO_NGUOI,
                                                                                    THOI_HAN: "",
                                                                                    PHUONG_THUC_DP: ""
                                                                                }
                                                                            )
                                                                        )
                                                                    )
                                                                ),
                                                                If(
                                                                    ct.BH_THOIHAN = true,
                                                                    ForAll(
                                                                        Datafield_TH.SelectedItems As th,
                                                                        If(
                                                                            ct.BH_PHUONG_THUC = true,
                                                                            ForAll(
                                                                                Datafield_DP.SelectedItems As dp,
                                                                                Patch(
                                                                                    DL_SAN_PHAM_MATRANPHI,
                                                                                    Defaults(DL_SAN_PHAM_MATRANPHI),
                                                                                    {ID: ct.ID,
                                                                                        MA_SAN_PHAM: valMaSP,
                                                                                        CHUONG_TRINH: ct.CHUONG_TRINH,
                                                                                        NHOM_TINH_PHI: ct.NHOM_TINH_PHI,
                                                                                        DO_TUOI: dt.MO_TA,
                                                                                        GIOI_TINH: gt.TEN_GIOI_TINH,
                                                                                        PHAM_VI_DL: If(
                                                                                            ct.PHAM_VI_DL = true,
                                                                                            Datafield_PV.Selected.TEN_PHAMVI,
                                                                                            ""
                                                                                        ),
                                                                                        NGANH_NGHE: nn.TEN_NGANH,
                                                                                        SO_TIEN: "",
                                                                                        SO_NGUOI: "",
                                                                                        THOI_HAN: th.TEN_THOI_HAN,
                                                                                        PHUONG_THUC_DP: dp.TEN_PT
                                                                                    }
                                                                                )
                                                                            ),
                                                                            Patch(
                                                                                DL_SAN_PHAM_MATRANPHI,
                                                                                Defaults(DL_SAN_PHAM_MATRANPHI),
                                                                                {ID: ct.ID,
                                                                                    MA_SAN_PHAM: valMaSP,
                                                                                    CHUONG_TRINH: ct.CHUONG_TRINH,
                                                                                    NHOM_TINH_PHI: ct.NHOM_TINH_PHI,
                                                                                    DO_TUOI: dt.MO_TA,
                                                                                    GIOI_TINH: gt.TEN_GIOI_TINH,
                                                                                    PHAM_VI_DL: If(
                                                                                        ct.PHAM_VI_DL = true,
                                                                                        Datafield_PV.Selected.TEN_PHAMVI,
                                                                                        ""
                                                                                    ),
                                                                                    NGANH_NGHE: nn.TEN_NGANH,
                                                                                    SO_TIEN: "",
                                                                                    SO_NGUOI: "",
                                                                                    THOI_HAN: th.TEN_THOI_HAN,
                                                                                    PHUONG_THUC_DP: ""
                                                                                }
                                                                            )
                                                                        )
                                                                    ),
                                                                    If(
                                                                        ct.BH_PHUONG_THUC = true,
                                                                        ForAll(
                                                                            Datafield_DP.SelectedItems As dp,
                                                                            Patch(
                                                                                DL_SAN_PHAM_MATRANPHI,
                                                                                Defaults(DL_SAN_PHAM_MATRANPHI),
                                                                                {ID: ct.ID,
                                                                                    MA_SAN_PHAM: valMaSP,
                                                                                    CHUONG_TRINH: ct.CHUONG_TRINH,
                                                                                    NHOM_TINH_PHI: ct.NHOM_TINH_PHI,
                                                                                    DO_TUOI: dt.MO_TA,
                                                                                    GIOI_TINH: gt.TEN_GIOI_TINH,
                                                                                    PHAM_VI_DL: If(
                                                                                        ct.PHAM_VI_DL = true,
                                                                                        Datafield_PV.Selected.TEN_PHAMVI,
                                                                                        ""
                                                                                    ),
                                                                                    NGANH_NGHE: nn.TEN_NGANH,
                                                                                    SO_TIEN: "",
                                                                                    SO_NGUOI: "",
                                                                                    THOI_HAN: "",
                                                                                    PHUONG_THUC_DP: dp.TEN_PT
                                                                                }
                                                                            )
                                                                        ),
                                                                        Patch(
                                                                            DL_SAN_PHAM_MATRANPHI,
                                                                            Defaults(DL_SAN_PHAM_MATRANPHI),
                                                                            {ID: ct.ID,
                                                                                MA_SAN_PHAM: valMaSP,
                                                                                CHUONG_TRINH: ct.CHUONG_TRINH,
                                                                                NHOM_TINH_PHI: ct.NHOM_TINH_PHI,
                                                                                DO_TUOI: dt.MO_TA,
                                                                                GIOI_TINH: gt.TEN_GIOI_TINH,
                                                                                PHAM_VI_DL: If(
                                                                                    ct.PHAM_VI_DL = true,
                                                                                    Datafield_PV.Selected.TEN_PHAMVI,
                                                                                    ""
                                                                                ),
                                                                                NGANH_NGHE: nn.TEN_NGANH,
                                                                                SO_TIEN: "",
                                                                                SO_NGUOI: "",
                                                                                THOI_HAN: "",
                                                                                PHUONG_THUC_DP: ""
                                                                            }
                                                                        )
                                                                    )
                                                                )
                                                            )
                                                        )
                                                    ),
                                                    If(
                                                        ct.BH_SOTIEN = true,
                                                        ForAll(
                                                            Datafield_ST.SelectedItems As st,
                                                            If(
                                                                ct.BH_SONGUOI = true,
                                                                ForAll(
                                                                    Datafield_SN.SelectedItems As sn,
                                                                    If(
                                                                        ct.BH_THOIHAN = true,
                                                                        ForAll(
                                                                            Datafield_TH.SelectedItems As th,
                                                                            If(
                                                                                ct.BH_PHUONG_THUC = true,
                                                                                ForAll(
                                                                                    Datafield_DP.SelectedItems As dp,
                                                                                    Patch(
                                                                                        DL_SAN_PHAM_MATRANPHI,
                                                                                        Defaults(DL_SAN_PHAM_MATRANPHI),
                                                                                        {ID: ct.ID,
                                                                                            MA_SAN_PHAM: valMaSP,
                                                                                            CHUONG_TRINH: ct.CHUONG_TRINH,
                                                                                            NHOM_TINH_PHI: ct.NHOM_TINH_PHI,
                                                                                            DO_TUOI: dt.MO_TA,
                                                                                            GIOI_TINH: gt.TEN_GIOI_TINH,
                                                                                            PHAM_VI_DL: If(
                                                                                                ct.PHAM_VI_DL = true,
                                                                                                Datafield_PV.Selected.TEN_PHAMVI,
                                                                                                ""
                                                                                            ),
                                                                                            NGANH_NGHE: "",
                                                                                            SO_TIEN: st.TEN_SOTIEN,
                                                                                            SO_NGUOI: sn.TEN_SO_NGUOI,
                                                                                            THOI_HAN: th.TEN_THOI_HAN,
                                                                                            PHUONG_THUC_DP: dp.TEN_PT
                                                                                        }
                                                                                    )
                                                                                ),
                                                                                Patch(
                                                                                    DL_SAN_PHAM_MATRANPHI,
                                                                                    Defaults(DL_SAN_PHAM_MATRANPHI),
                                                                                    {ID: ct.ID,
                                                                                        MA_SAN_PHAM: valMaSP,
                                                                                        CHUONG_TRINH: ct.CHUONG_TRINH,
                                                                                        NHOM_TINH_PHI: ct.NHOM_TINH_PHI,
                                                                                        DO_TUOI: dt.MO_TA,
                                                                                        GIOI_TINH: gt.TEN_GIOI_TINH,
                                                                                        PHAM_VI_DL: If(
                                                                                            ct.PHAM_VI_DL = true,
                                                                                            Datafield_PV.Selected.TEN_PHAMVI,
                                                                                            ""
                                                                                        ),
                                                                                        NGANH_NGHE: "",
                                                                                        SO_TIEN: st.TEN_SOTIEN,
                                                                                        SO_NGUOI: sn.TEN_SO_NGUOI,
                                                                                        THOI_HAN: th.TEN_THOI_HAN,
                                                                                        PHUONG_THUC_DP: ""
                                                                                    }
                                                                                )
                                                                            )
                                                                        ),
                                                                        If(
                                                                            ct.BH_PHUONG_THUC = true,
                                                                            ForAll(
                                                                                Datafield_DP.SelectedItems As dp,
                                                                                Patch(
                                                                                    DL_SAN_PHAM_MATRANPHI,
                                                                                    Defaults(DL_SAN_PHAM_MATRANPHI),
                                                                                    {ID: ct.ID,
                                                                                        MA_SAN_PHAM: valMaSP,
                                                                                        CHUONG_TRINH: ct.CHUONG_TRINH,
                                                                                        NHOM_TINH_PHI: ct.NHOM_TINH_PHI,
                                                                                        DO_TUOI: dt.MO_TA,
                                                                                        GIOI_TINH: gt.TEN_GIOI_TINH,
                                                                                        PHAM_VI_DL: If(
                                                                                            ct.PHAM_VI_DL = true,
                                                                                            Datafield_PV.Selected.TEN_PHAMVI,
                                                                                            ""
                                                                                        ),
                                                                                        NGANH_NGHE: "",
                                                                                        SO_TIEN: st.TEN_SOTIEN,
                                                                                        SO_NGUOI: sn.TEN_SO_NGUOI,
                                                                                        THOI_HAN: "",
                                                                                        PHUONG_THUC_DP: dp.TEN_PT
                                                                                    }
                                                                                )
                                                                            ),
                                                                            Patch(
                                                                                DL_SAN_PHAM_MATRANPHI,
                                                                                Defaults(DL_SAN_PHAM_MATRANPHI),
                                                                                {ID: ct.ID,
                                                                                    MA_SAN_PHAM: valMaSP,
                                                                                    CHUONG_TRINH: ct.CHUONG_TRINH,
                                                                                    NHOM_TINH_PHI: ct.NHOM_TINH_PHI,
                                                                                    DO_TUOI: dt.MO_TA,
                                                                                    GIOI_TINH: gt.TEN_GIOI_TINH,
                                                                                    PHAM_VI_DL: If(
                                                                                        ct.PHAM_VI_DL = true,
                                                                                        Datafield_PV.Selected.TEN_PHAMVI,
                                                                                        ""
                                                                                    ),
                                                                                    NGANH_NGHE: "",
                                                                                    SO_TIEN: st.TEN_SOTIEN,
                                                                                    SO_NGUOI: sn.TEN_SO_NGUOI,
                                                                                    THOI_HAN: "",
                                                                                    PHUONG_THUC_DP: ""
                                                                                }
                                                                            )
                                                                        )
                                                                    )
                                                                ),
                                                                If(
                                                                    ct.BH_THOIHAN = true,
                                                                    ForAll(
                                                                        Datafield_TH.SelectedItems As th,
                                                                        If(
                                                                            ct.BH_PHUONG_THUC = true,
                                                                            ForAll(
                                                                                Datafield_DP.SelectedItems As dp,
                                                                                Patch(
                                                                                    DL_SAN_PHAM_MATRANPHI,
                                                                                    Defaults(DL_SAN_PHAM_MATRANPHI),
                                                                                    {ID: ct.ID,
                                                                                        MA_SAN_PHAM: valMaSP,
                                                                                        CHUONG_TRINH: ct.CHUONG_TRINH,
                                                                                        NHOM_TINH_PHI: ct.NHOM_TINH_PHI,
                                                                                        DO_TUOI: dt.MO_TA,
                                                                                        GIOI_TINH: gt.TEN_GIOI_TINH,
                                                                                        PHAM_VI_DL: If(
                                                                                            ct.PHAM_VI_DL = true,
                                                                                            Datafield_PV.Selected.TEN_PHAMVI,
                                                                                            ""
                                                                                        ),
                                                                                        NGANH_NGHE: "",
                                                                                        SO_TIEN: st.TEN_SOTIEN,
                                                                                        SO_NGUOI: "",
                                                                                        THOI_HAN: th.TEN_THOI_HAN,
                                                                                        PHUONG_THUC_DP: dp.TEN_PT
                                                                                    }
                                                                                )
                                                                            ),
                                                                            Patch(
                                                                                DL_SAN_PHAM_MATRANPHI,
                                                                                Defaults(DL_SAN_PHAM_MATRANPHI),
                                                                                {ID: ct.ID,
                                                                                    MA_SAN_PHAM: valMaSP,
                                                                                    CHUONG_TRINH: ct.CHUONG_TRINH,
                                                                                    NHOM_TINH_PHI: ct.NHOM_TINH_PHI,
                                                                                    DO_TUOI: dt.MO_TA,
                                                                                    GIOI_TINH: gt.TEN_GIOI_TINH,
                                                                                    PHAM_VI_DL: If(
                                                                                        ct.PHAM_VI_DL = true,
                                                                                        Datafield_PV.Selected.TEN_PHAMVI,
                                                                                        ""
                                                                                    ),
                                                                                    NGANH_NGHE: "",
                                                                                    SO_TIEN: st.TEN_SOTIEN,
                                                                                    SO_NGUOI: "",
                                                                                    THOI_HAN: th.TEN_THOI_HAN,
                                                                                    PHUONG_THUC_DP: ""
                                                                                }
                                                                            )
                                                                        )
                                                                    ),
                                                                    If(
                                                                        ct.BH_PHUONG_THUC = true,
                                                                        ForAll(
                                                                            Datafield_DP.SelectedItems As dp,
                                                                            Patch(
                                                                                DL_SAN_PHAM_MATRANPHI,
                                                                                Defaults(DL_SAN_PHAM_MATRANPHI),
                                                                                {ID: ct.ID,
                                                                                    MA_SAN_PHAM: valMaSP,
                                                                                    CHUONG_TRINH: ct.CHUONG_TRINH,
                                                                                    NHOM_TINH_PHI: ct.NHOM_TINH_PHI,
                                                                                    DO_TUOI: dt.MO_TA,
                                                                                    GIOI_TINH: gt.TEN_GIOI_TINH,
                                                                                    PHAM_VI_DL: If(
                                                                                        ct.PHAM_VI_DL = true,
                                                                                        Datafield_PV.Selected.TEN_PHAMVI,
                                                                                        ""
                                                                                    ),
                                                                                    NGANH_NGHE: "",
                                                                                    SO_TIEN: st.TEN_SOTIEN,
                                                                                    SO_NGUOI: "",
                                                                                    THOI_HAN: "",
                                                                                    PHUONG_THUC_DP: dp.TEN_PT
                                                                                }
                                                                            )
                                                                        ),
                                                                        Patch(
                                                                            DL_SAN_PHAM_MATRANPHI,
                                                                            Defaults(DL_SAN_PHAM_MATRANPHI),
                                                                            {ID: ct.ID,
                                                                                MA_SAN_PHAM: valMaSP,
                                                                                CHUONG_TRINH: ct.CHUONG_TRINH,
                                                                                NHOM_TINH_PHI: ct.NHOM_TINH_PHI,
                                                                                DO_TUOI: dt.MO_TA,
                                                                                GIOI_TINH: gt.TEN_GIOI_TINH,
                                                                                PHAM_VI_DL: If(
                                                                                    ct.PHAM_VI_DL = true,
                                                                                    Datafield_PV.Selected.TEN_PHAMVI,
                                                                                    ""
                                                                                ),
                                                                                NGANH_NGHE: "",
                                                                                SO_TIEN: st.TEN_SOTIEN,
                                                                                SO_NGUOI: "",
                                                                                THOI_HAN: "",
                                                                                PHUONG_THUC_DP: ""
                                                                            }
                                                                        )
                                                                    )
                                                                )
                                                            )
                                                        ),
                                                        If(
                                                            ct.BH_SONGUOI = true,
                                                            ForAll(
                                                                Datafield_SN.SelectedItems As sn,
                                                                If(
                                                                    ct.BH_THOIHAN = true,
                                                                    ForAll(
                                                                        Datafield_TH.SelectedItems As th,
                                                                        If(
                                                                            ct.BH_PHUONG_THUC = true,
                                                                            ForAll(
                                                                                Datafield_DP.SelectedItems As dp,
                                                                                Patch(
                                                                                    DL_SAN_PHAM_MATRANPHI,
                                                                                    Defaults(DL_SAN_PHAM_MATRANPHI),
                                                                                    {ID: ct.ID,
                                                                                        MA_SAN_PHAM: valMaSP,
                                                                                        CHUONG_TRINH: ct.CHUONG_TRINH,
                                                                                        NHOM_TINH_PHI: ct.NHOM_TINH_PHI,
                                                                                        DO_TUOI: dt.MO_TA,
                                                                                        GIOI_TINH: gt.TEN_GIOI_TINH,
                                                                                        PHAM_VI_DL: If(
                                                                                            ct.PHAM_VI_DL = true,
                                                                                            Datafield_PV.Selected.TEN_PHAMVI,
                                                                                            ""
                                                                                        ),
                                                                                        NGANH_NGHE: "",
                                                                                        SO_TIEN: "",
                                                                                        SO_NGUOI: sn.TEN_SO_NGUOI,
                                                                                        THOI_HAN: th.TEN_THOI_HAN,
                                                                                        PHUONG_THUC_DP: dp.TEN_PT
                                                                                    }
                                                                                )
                                                                            ),
                                                                            Patch(
                                                                                DL_SAN_PHAM_MATRANPHI,
                                                                                Defaults(DL_SAN_PHAM_MATRANPHI),
                                                                                {ID: ct.ID,
                                                                                    MA_SAN_PHAM: valMaSP,
                                                                                    CHUONG_TRINH: ct.CHUONG_TRINH,
                                                                                    NHOM_TINH_PHI: ct.NHOM_TINH_PHI,
                                                                                    DO_TUOI: dt.MO_TA,
                                                                                    GIOI_TINH: gt.TEN_GIOI_TINH,
                                                                                    PHAM_VI_DL: If(
                                                                                        ct.PHAM_VI_DL = true,
                                                                                        Datafield_PV.Selected.TEN_PHAMVI,
                                                                                        ""
                                                                                    ),
                                                                                    NGANH_NGHE: "",
                                                                                    SO_TIEN: "",
                                                                                    SO_NGUOI: sn.TEN_SO_NGUOI,
                                                                                    THOI_HAN: th.TEN_THOI_HAN,
                                                                                    PHUONG_THUC_DP: ""
                                                                                }
                                                                            )
                                                                        )
                                                                    ),
                                                                    If(
                                                                        ct.BH_PHUONG_THUC = true,
                                                                        ForAll(
                                                                            Datafield_DP.SelectedItems As dp,
                                                                            Patch(
                                                                                DL_SAN_PHAM_MATRANPHI,
                                                                                Defaults(DL_SAN_PHAM_MATRANPHI),
                                                                                {ID: ct.ID,
                                                                                    MA_SAN_PHAM: valMaSP,
                                                                                    CHUONG_TRINH: ct.CHUONG_TRINH,
                                                                                    NHOM_TINH_PHI: ct.NHOM_TINH_PHI,
                                                                                    DO_TUOI: dt.MO_TA,
                                                                                    GIOI_TINH: gt.TEN_GIOI_TINH,
                                                                                    PHAM_VI_DL: If(
                                                                                        ct.PHAM_VI_DL = true,
                                                                                        Datafield_PV.Selected.TEN_PHAMVI,
                                                                                        ""
                                                                                    ),
                                                                                    NGANH_NGHE: "",
                                                                                    SO_TIEN: "",
                                                                                    SO_NGUOI: sn.TEN_SO_NGUOI,
                                                                                    THOI_HAN: "",
                                                                                    PHUONG_THUC_DP: dp.TEN_PT
                                                                                }
                                                                            )
                                                                        ),
                                                                        Patch(
                                                                            DL_SAN_PHAM_MATRANPHI,
                                                                            Defaults(DL_SAN_PHAM_MATRANPHI),
                                                                            {ID: ct.ID,
                                                                                MA_SAN_PHAM: valMaSP,
                                                                                CHUONG_TRINH: ct.CHUONG_TRINH,
                                                                                NHOM_TINH_PHI: ct.NHOM_TINH_PHI,
                                                                                DO_TUOI: dt.MO_TA,
                                                                                GIOI_TINH: gt.TEN_GIOI_TINH,
                                                                                PHAM_VI_DL: If(
                                                                                    ct.PHAM_VI_DL = true,
                                                                                    Datafield_PV.Selected.TEN_PHAMVI,
                                                                                    ""
                                                                                ),
                                                                                NGANH_NGHE: "",
                                                                                SO_TIEN: "",
                                                                                SO_NGUOI: sn.TEN_SO_NGUOI,
                                                                                THOI_HAN: "",
                                                                                PHUONG_THUC_DP: ""
                                                                            }
                                                                        )
                                                                    )
                                                                )
                                                            ),
                                                            If(
                                                                ct.BH_THOIHAN = true,
                                                                ForAll(
                                                                    Datafield_TH.SelectedItems As th,
                                                                    If(
                                                                        ct.BH_PHUONG_THUC = true,
                                                                        ForAll(
                                                                            Datafield_DP.SelectedItems As dp,
                                                                            Patch(
                                                                                DL_SAN_PHAM_MATRANPHI,
                                                                                Defaults(DL_SAN_PHAM_MATRANPHI),
                                                                                {ID: ct.ID,
                                                                                    MA_SAN_PHAM: valMaSP,
                                                                                    CHUONG_TRINH: ct.CHUONG_TRINH,
                                                                                    NHOM_TINH_PHI: ct.NHOM_TINH_PHI,
                                                                                    DO_TUOI: dt.MO_TA,
                                                                                    GIOI_TINH: gt.TEN_GIOI_TINH,
                                                                                    PHAM_VI_DL: If(
                                                                                        ct.PHAM_VI_DL = true,
                                                                                        Datafield_PV.Selected.TEN_PHAMVI,
                                                                                        ""
                                                                                    ),
                                                                                    NGANH_NGHE: "",
                                                                                    SO_TIEN: "",
                                                                                    SO_NGUOI: "",
                                                                                    THOI_HAN: th.TEN_THOI_HAN,
                                                                                    PHUONG_THUC_DP: dp.TEN_PT
                                                                                }
                                                                            )
                                                                        ),
                                                                        Patch(
                                                                            DL_SAN_PHAM_MATRANPHI,
                                                                            Defaults(DL_SAN_PHAM_MATRANPHI),
                                                                            {ID: ct.ID,
                                                                                MA_SAN_PHAM: valMaSP,
                                                                                CHUONG_TRINH: ct.CHUONG_TRINH,
                                                                                NHOM_TINH_PHI: ct.NHOM_TINH_PHI,
                                                                                DO_TUOI: dt.MO_TA,
                                                                                GIOI_TINH: gt.TEN_GIOI_TINH,
                                                                                PHAM_VI_DL: If(
                                                                                    ct.PHAM_VI_DL = true,
                                                                                    Datafield_PV.Selected.TEN_PHAMVI,
                                                                                    ""
                                                                                ),
                                                                                NGANH_NGHE: "",
                                                                                SO_TIEN: "",
                                                                                SO_NGUOI: "",
                                                                                THOI_HAN: th.TEN_THOI_HAN,
                                                                                PHUONG_THUC_DP: ""
                                                                            }
                                                                        )
                                                                    )
                                                                ),
                                                                If(
                                                                    ct.BH_PHUONG_THUC = true,
                                                                    ForAll(
                                                                        Datafield_DP.SelectedItems As dp,
                                                                        Patch(
                                                                            DL_SAN_PHAM_MATRANPHI,
                                                                            Defaults(DL_SAN_PHAM_MATRANPHI),
                                                                            {ID: ct.ID,
                                                                                MA_SAN_PHAM: valMaSP,
                                                                                CHUONG_TRINH: ct.CHUONG_TRINH,
                                                                                NHOM_TINH_PHI: ct.NHOM_TINH_PHI,
                                                                                DO_TUOI: dt.MO_TA,
                                                                                GIOI_TINH: gt.TEN_GIOI_TINH,
                                                                                PHAM_VI_DL: If(
                                                                                    ct.PHAM_VI_DL = true,
                                                                                    Datafield_PV.Selected.TEN_PHAMVI,
                                                                                    ""
                                                                                ),
                                                                                NGANH_NGHE: "",
                                                                                SO_TIEN: "",
                                                                                SO_NGUOI: "",
                                                                                THOI_HAN: "",
                                                                                PHUONG_THUC_DP: dp.TEN_PT
                                                                            }
                                                                        )
                                                                    ),
                                                                    Patch(
                                                                        DL_SAN_PHAM_MATRANPHI,
                                                                        Defaults(DL_SAN_PHAM_MATRANPHI),
                                                                        {ID: ct.ID,
                                                                            MA_SAN_PHAM: valMaSP,
                                                                            CHUONG_TRINH: ct.CHUONG_TRINH,
                                                                            NHOM_TINH_PHI: ct.NHOM_TINH_PHI,
                                                                            DO_TUOI: dt.MO_TA,
                                                                            GIOI_TINH: gt.TEN_GIOI_TINH,
                                                                            PHAM_VI_DL: If(
                                                                                ct.PHAM_VI_DL = true,
                                                                                Datafield_PV.Selected.TEN_PHAMVI,
                                                                                ""
                                                                            ),
                                                                            NGANH_NGHE: "",
                                                                            SO_TIEN: "",
                                                                            SO_NGUOI: "",
                                                                            THOI_HAN: "",
                                                                            PHUONG_THUC_DP: ""
                                                                        }
                                                                    )
                                                                )
                                                            )
                                                        )
                                                    )
                                                )
                                            ),
                                            If(
                                                ct.NGANH_NGHE = true,
                                                ForAll(
                                                    Datafield_NN.SelectedItems As nn,
                                                    If(
                                                        ct.BH_SOTIEN = true,
                                                        ForAll(
                                                            Datafield_ST.SelectedItems As st,
                                                            If(
                                                                ct.BH_SONGUOI = true,
                                                                ForAll(
                                                                    Datafield_SN.SelectedItems As sn,
                                                                    If(
                                                                        ct.BH_THOIHAN = true,
                                                                        ForAll(
                                                                            Datafield_TH.SelectedItems As th,
                                                                            If(
                                                                                ct.BH_PHUONG_THUC = true,
                                                                                ForAll(
                                                                                    Datafield_DP.SelectedItems As dp,
                                                                                    Patch(
                                                                                        DL_SAN_PHAM_MATRANPHI,
                                                                                        Defaults(DL_SAN_PHAM_MATRANPHI),
                                                                                        {ID: ct.ID,
                                                                                            MA_SAN_PHAM: valMaSP,
                                                                                            CHUONG_TRINH: ct.CHUONG_TRINH,
                                                                                            NHOM_TINH_PHI: ct.NHOM_TINH_PHI,
                                                                                            DO_TUOI: dt.MO_TA,
                                                                                            GIOI_TINH: "",
                                                                                            PHAM_VI_DL: If(
                                                                                                ct.PHAM_VI_DL = true,
                                                                                                Datafield_PV.Selected.TEN_PHAMVI,
                                                                                                ""
                                                                                            ),
                                                                                            NGANH_NGHE: nn.TEN_NGANH,
                                                                                            SO_TIEN: st.TEN_SOTIEN,
                                                                                            SO_NGUOI: sn.TEN_SO_NGUOI,
                                                                                            THOI_HAN: th.TEN_THOI_HAN,
                                                                                            PHUONG_THUC_DP: dp.TEN_PT
                                                                                        }
                                                                                    )
                                                                                ),
                                                                                Patch(
                                                                                    DL_SAN_PHAM_MATRANPHI,
                                                                                    Defaults(DL_SAN_PHAM_MATRANPHI),
                                                                                    {ID: ct.ID,
                                                                                        MA_SAN_PHAM: valMaSP,
                                                                                        CHUONG_TRINH: ct.CHUONG_TRINH,
                                                                                        NHOM_TINH_PHI: ct.NHOM_TINH_PHI,
                                                                                        DO_TUOI: dt.MO_TA,
                                                                                        GIOI_TINH: "",
                                                                                        PHAM_VI_DL: If(
                                                                                            ct.PHAM_VI_DL = true,
                                                                                            Datafield_PV.Selected.TEN_PHAMVI,
                                                                                            ""
                                                                                        ),
                                                                                        NGANH_NGHE: nn.TEN_NGANH,
                                                                                        SO_TIEN: st.TEN_SOTIEN,
                                                                                        SO_NGUOI: sn.TEN_SO_NGUOI,
                                                                                        THOI_HAN: th.TEN_THOI_HAN,
                                                                                        PHUONG_THUC_DP: ""
                                                                                    }
                                                                                )
                                                                            )
                                                                        ),
                                                                        If(
                                                                            ct.BH_PHUONG_THUC = true,
                                                                            ForAll(
                                                                                Datafield_DP.SelectedItems As dp,
                                                                                Patch(
                                                                                    DL_SAN_PHAM_MATRANPHI,
                                                                                    Defaults(DL_SAN_PHAM_MATRANPHI),
                                                                                    {ID: ct.ID,
                                                                                        MA_SAN_PHAM: valMaSP,
                                                                                        CHUONG_TRINH: ct.CHUONG_TRINH,
                                                                                        NHOM_TINH_PHI: ct.NHOM_TINH_PHI,
                                                                                        DO_TUOI: dt.MO_TA,
                                                                                        GIOI_TINH: "",
                                                                                        PHAM_VI_DL: If(
                                                                                            ct.PHAM_VI_DL = true,
                                                                                            Datafield_PV.Selected.TEN_PHAMVI,
                                                                                            ""
                                                                                        ),
                                                                                        NGANH_NGHE: nn.TEN_NGANH,
                                                                                        SO_TIEN: st.TEN_SOTIEN,
                                                                                        SO_NGUOI: sn.TEN_SO_NGUOI,
                                                                                        THOI_HAN: "",
                                                                                        PHUONG_THUC_DP: dp.TEN_PT
                                                                                    }
                                                                                )
                                                                            ),
                                                                            Patch(
                                                                                DL_SAN_PHAM_MATRANPHI,
                                                                                Defaults(DL_SAN_PHAM_MATRANPHI),
                                                                                {ID: ct.ID,
                                                                                    MA_SAN_PHAM: valMaSP,
                                                                                    CHUONG_TRINH: ct.CHUONG_TRINH,
                                                                                    NHOM_TINH_PHI: ct.NHOM_TINH_PHI,
                                                                                    DO_TUOI: dt.MO_TA,
                                                                                    GIOI_TINH: "",
                                                                                    PHAM_VI_DL: If(
                                                                                        ct.PHAM_VI_DL = true,
                                                                                        Datafield_PV.Selected.TEN_PHAMVI,
                                                                                        ""
                                                                                    ),
                                                                                    NGANH_NGHE: nn.TEN_NGANH,
                                                                                    SO_TIEN: st.TEN_SOTIEN,
                                                                                    SO_NGUOI: sn.TEN_SO_NGUOI,
                                                                                    THOI_HAN: "",
                                                                                    PHUONG_THUC_DP: ""
                                                                                }
                                                                            )
                                                                        )
                                                                    )
                                                                ),
                                                                If(
                                                                    ct.BH_THOIHAN = true,
                                                                    ForAll(
                                                                        Datafield_TH.SelectedItems As th,
                                                                        If(
                                                                            ct.BH_PHUONG_THUC = true,
                                                                            ForAll(
                                                                                Datafield_DP.SelectedItems As dp,
                                                                                Patch(
                                                                                    DL_SAN_PHAM_MATRANPHI,
                                                                                    Defaults(DL_SAN_PHAM_MATRANPHI),
                                                                                    {ID: ct.ID,
                                                                                        MA_SAN_PHAM: valMaSP,
                                                                                        CHUONG_TRINH: ct.CHUONG_TRINH,
                                                                                        NHOM_TINH_PHI: ct.NHOM_TINH_PHI,
                                                                                        DO_TUOI: dt.MO_TA,
                                                                                        GIOI_TINH: "",
                                                                                        PHAM_VI_DL: If(
                                                                                            ct.PHAM_VI_DL = true,
                                                                                            Datafield_PV.Selected.TEN_PHAMVI,
                                                                                            ""
                                                                                        ),
                                                                                        NGANH_NGHE: nn.TEN_NGANH,
                                                                                        SO_TIEN: st.TEN_SOTIEN,
                                                                                        SO_NGUOI: "",
                                                                                        THOI_HAN: th.TEN_THOI_HAN,
                                                                                        PHUONG_THUC_DP: dp.TEN_PT
                                                                                    }
                                                                                )
                                                                            ),
                                                                            Patch(
                                                                                DL_SAN_PHAM_MATRANPHI,
                                                                                Defaults(DL_SAN_PHAM_MATRANPHI),
                                                                                {ID: ct.ID,
                                                                                    MA_SAN_PHAM: valMaSP,
                                                                                    CHUONG_TRINH: ct.CHUONG_TRINH,
                                                                                    NHOM_TINH_PHI: ct.NHOM_TINH_PHI,
                                                                                    DO_TUOI: dt.MO_TA,
                                                                                    GIOI_TINH: "",
                                                                                    PHAM_VI_DL: If(
                                                                                        ct.PHAM_VI_DL = true,
                                                                                        Datafield_PV.Selected.TEN_PHAMVI,
                                                                                        ""
                                                                                    ),
                                                                                    NGANH_NGHE: nn.TEN_NGANH,
                                                                                    SO_TIEN: st.TEN_SOTIEN,
                                                                                    SO_NGUOI: "",
                                                                                    THOI_HAN: th.TEN_THOI_HAN,
                                                                                    PHUONG_THUC_DP: ""
                                                                                }
                                                                            )
                                                                        )
                                                                    ),
                                                                    If(
                                                                        ct.BH_PHUONG_THUC = true,
                                                                        ForAll(
                                                                            Datafield_DP.SelectedItems As dp,
                                                                            Patch(
                                                                                DL_SAN_PHAM_MATRANPHI,
                                                                                Defaults(DL_SAN_PHAM_MATRANPHI),
                                                                                {ID: ct.ID,
                                                                                    MA_SAN_PHAM: valMaSP,
                                                                                    CHUONG_TRINH: ct.CHUONG_TRINH,
                                                                                    NHOM_TINH_PHI: ct.NHOM_TINH_PHI,
                                                                                    DO_TUOI: dt.MO_TA,
                                                                                    GIOI_TINH: "",
                                                                                    PHAM_VI_DL: If(
                                                                                        ct.PHAM_VI_DL = true,
                                                                                        Datafield_PV.Selected.TEN_PHAMVI,
                                                                                        ""
                                                                                    ),
                                                                                    NGANH_NGHE: nn.TEN_NGANH,
                                                                                    SO_TIEN: st.TEN_SOTIEN,
                                                                                    SO_NGUOI: "",
                                                                                    THOI_HAN: "",
                                                                                    PHUONG_THUC_DP: dp.TEN_PT
                                                                                }
                                                                            )
                                                                        ),
                                                                        Patch(
                                                                            DL_SAN_PHAM_MATRANPHI,
                                                                            Defaults(DL_SAN_PHAM_MATRANPHI),
                                                                            {ID: ct.ID,
                                                                                MA_SAN_PHAM: valMaSP,
                                                                                CHUONG_TRINH: ct.CHUONG_TRINH,
                                                                                NHOM_TINH_PHI: ct.NHOM_TINH_PHI,
                                                                                DO_TUOI: dt.MO_TA,
                                                                                GIOI_TINH: "",
                                                                                PHAM_VI_DL: If(
                                                                                    ct.PHAM_VI_DL = true,
                                                                                    Datafield_PV.Selected.TEN_PHAMVI,
                                                                                    ""
                                                                                ),
                                                                                NGANH_NGHE: nn.TEN_NGANH,
                                                                                SO_TIEN: st.TEN_SOTIEN,
                                                                                SO_NGUOI: "",
                                                                                THOI_HAN: "",
                                                                                PHUONG_THUC_DP: ""
                                                                            }
                                                                        )
                                                                    )
                                                                )
                                                            )
                                                        ),
                                                        If(
                                                            ct.BH_SONGUOI = true,
                                                            ForAll(
                                                                Datafield_SN.SelectedItems As sn,
                                                                If(
                                                                    ct.BH_THOIHAN = true,
                                                                    ForAll(
                                                                        Datafield_TH.SelectedItems As th,
                                                                        If(
                                                                            ct.BH_PHUONG_THUC = true,
                                                                            ForAll(
                                                                                Datafield_DP.SelectedItems As dp,
                                                                                Patch(
                                                                                    DL_SAN_PHAM_MATRANPHI,
                                                                                    Defaults(DL_SAN_PHAM_MATRANPHI),
                                                                                    {ID: ct.ID,
                                                                                        MA_SAN_PHAM: valMaSP,
                                                                                        CHUONG_TRINH: ct.CHUONG_TRINH,
                                                                                        NHOM_TINH_PHI: ct.NHOM_TINH_PHI,
                                                                                        DO_TUOI: dt.MO_TA,
                                                                                        GIOI_TINH: "",
                                                                                        PHAM_VI_DL: If(
                                                                                            ct.PHAM_VI_DL = true,
                                                                                            Datafield_PV.Selected.TEN_PHAMVI,
                                                                                            ""
                                                                                        ),
                                                                                        NGANH_NGHE: nn.TEN_NGANH,
                                                                                        SO_TIEN: "",
                                                                                        SO_NGUOI: sn.TEN_SO_NGUOI,
                                                                                        THOI_HAN: th.TEN_THOI_HAN,
                                                                                        PHUONG_THUC_DP: dp.TEN_PT
                                                                                    }
                                                                                )
                                                                            ),
                                                                            Patch(
                                                                                DL_SAN_PHAM_MATRANPHI,
                                                                                Defaults(DL_SAN_PHAM_MATRANPHI),
                                                                                {ID: ct.ID,
                                                                                    MA_SAN_PHAM: valMaSP,
                                                                                    CHUONG_TRINH: ct.CHUONG_TRINH,
                                                                                    NHOM_TINH_PHI: ct.NHOM_TINH_PHI,
                                                                                    DO_TUOI: dt.MO_TA,
                                                                                    GIOI_TINH: "",
                                                                                    PHAM_VI_DL: If(
                                                                                        ct.PHAM_VI_DL = true,
                                                                                        Datafield_PV.Selected.TEN_PHAMVI,
                                                                                        ""
                                                                                    ),
                                                                                    NGANH_NGHE: nn.TEN_NGANH,
                                                                                    SO_TIEN: "",
                                                                                    SO_NGUOI: sn.TEN_SO_NGUOI,
                                                                                    THOI_HAN: th.TEN_THOI_HAN,
                                                                                    PHUONG_THUC_DP: ""
                                                                                }
                                                                            )
                                                                        )
                                                                    ),
                                                                    If(
                                                                        ct.BH_PHUONG_THUC = true,
                                                                        ForAll(
                                                                            Datafield_DP.SelectedItems As dp,
                                                                            Patch(
                                                                                DL_SAN_PHAM_MATRANPHI,
                                                                                Defaults(DL_SAN_PHAM_MATRANPHI),
                                                                                {ID: ct.ID,
                                                                                    MA_SAN_PHAM: valMaSP,
                                                                                    CHUONG_TRINH: ct.CHUONG_TRINH,
                                                                                    NHOM_TINH_PHI: ct.NHOM_TINH_PHI,
                                                                                    DO_TUOI: dt.MO_TA,
                                                                                    GIOI_TINH: "",
                                                                                    PHAM_VI_DL: If(
                                                                                        ct.PHAM_VI_DL = true,
                                                                                        Datafield_PV.Selected.TEN_PHAMVI,
                                                                                        ""
                                                                                    ),
                                                                                    NGANH_NGHE: nn.TEN_NGANH,
                                                                                    SO_TIEN: "",
                                                                                    SO_NGUOI: sn.TEN_SO_NGUOI,
                                                                                    THOI_HAN: "",
                                                                                    PHUONG_THUC_DP: dp.TEN_PT
                                                                                }
                                                                            )
                                                                        ),
                                                                        Patch(
                                                                            DL_SAN_PHAM_MATRANPHI,
                                                                            Defaults(DL_SAN_PHAM_MATRANPHI),
                                                                            {ID: ct.ID,
                                                                                MA_SAN_PHAM: valMaSP,
                                                                                CHUONG_TRINH: ct.CHUONG_TRINH,
                                                                                NHOM_TINH_PHI: ct.NHOM_TINH_PHI,
                                                                                DO_TUOI: dt.MO_TA,
                                                                                GIOI_TINH: "",
                                                                                PHAM_VI_DL: If(
                                                                                    ct.PHAM_VI_DL = true,
                                                                                    Datafield_PV.Selected.TEN_PHAMVI,
                                                                                    ""
                                                                                ),
                                                                                NGANH_NGHE: nn.TEN_NGANH,
                                                                                SO_TIEN: "",
                                                                                SO_NGUOI: sn.TEN_SO_NGUOI,
                                                                                THOI_HAN: "",
                                                                                PHUONG_THUC_DP: ""
                                                                            }
                                                                        )
                                                                    )
                                                                )
                                                            ),
                                                            If(
                                                                ct.BH_THOIHAN = true,
                                                                ForAll(
                                                                    Datafield_TH.SelectedItems As th,
                                                                    If(
                                                                        ct.BH_PHUONG_THUC = true,
                                                                        ForAll(
                                                                            Datafield_DP.SelectedItems As dp,
                                                                            Patch(
                                                                                DL_SAN_PHAM_MATRANPHI,
                                                                                Defaults(DL_SAN_PHAM_MATRANPHI),
                                                                                {ID: ct.ID,
                                                                                    MA_SAN_PHAM: valMaSP,
                                                                                    CHUONG_TRINH: ct.CHUONG_TRINH,
                                                                                    NHOM_TINH_PHI: ct.NHOM_TINH_PHI,
                                                                                    DO_TUOI: dt.MO_TA,
                                                                                    GIOI_TINH: "",
                                                                                    PHAM_VI_DL: If(
                                                                                        ct.PHAM_VI_DL = true,
                                                                                        Datafield_PV.Selected.TEN_PHAMVI,
                                                                                        ""
                                                                                    ),
                                                                                    NGANH_NGHE: nn.TEN_NGANH,
                                                                                    SO_TIEN: "",
                                                                                    SO_NGUOI: "",
                                                                                    THOI_HAN: th.TEN_THOI_HAN,
                                                                                    PHUONG_THUC_DP: dp.TEN_PT
                                                                                }
                                                                            )
                                                                        ),
                                                                        Patch(
                                                                            DL_SAN_PHAM_MATRANPHI,
                                                                            Defaults(DL_SAN_PHAM_MATRANPHI),
                                                                            {ID: ct.ID,
                                                                                MA_SAN_PHAM: valMaSP,
                                                                                CHUONG_TRINH: ct.CHUONG_TRINH,
                                                                                NHOM_TINH_PHI: ct.NHOM_TINH_PHI,
                                                                                DO_TUOI: dt.MO_TA,
                                                                                GIOI_TINH: "",
                                                                                PHAM_VI_DL: If(
                                                                                    ct.PHAM_VI_DL = true,
                                                                                    Datafield_PV.Selected.TEN_PHAMVI,
                                                                                    ""
                                                                                ),
                                                                                NGANH_NGHE: nn.TEN_NGANH,
                                                                                SO_TIEN: "",
                                                                                SO_NGUOI: "",
                                                                                THOI_HAN: th.TEN_THOI_HAN,
                                                                                PHUONG_THUC_DP: ""
                                                                            }
                                                                        )
                                                                    )
                                                                ),
                                                                If(
                                                                    ct.BH_PHUONG_THUC = true,
                                                                    ForAll(
                                                                        Datafield_DP.SelectedItems As dp,
                                                                        Patch(
                                                                            DL_SAN_PHAM_MATRANPHI,
                                                                            Defaults(DL_SAN_PHAM_MATRANPHI),
                                                                            {ID: ct.ID,
                                                                                MA_SAN_PHAM: valMaSP,
                                                                                CHUONG_TRINH: ct.CHUONG_TRINH,
                                                                                NHOM_TINH_PHI: ct.NHOM_TINH_PHI,
                                                                                DO_TUOI: dt.MO_TA,
                                                                                GIOI_TINH: "",
                                                                                PHAM_VI_DL: If(
                                                                                    ct.PHAM_VI_DL = true,
                                                                                    Datafield_PV.Selected.TEN_PHAMVI,
                                                                                    ""
                                                                                ),
                                                                                NGANH_NGHE: nn.TEN_NGANH,
                                                                                SO_TIEN: "",
                                                                                SO_NGUOI: "",
                                                                                THOI_HAN: "",
                                                                                PHUONG_THUC_DP: dp.TEN_PT
                                                                            }
                                                                        )
                                                                    ),
                                                                    Patch(
                                                                        DL_SAN_PHAM_MATRANPHI,
                                                                        Defaults(DL_SAN_PHAM_MATRANPHI),
                                                                        {ID: ct.ID,
                                                                            MA_SAN_PHAM: valMaSP,
                                                                            CHUONG_TRINH: ct.CHUONG_TRINH,
                                                                            NHOM_TINH_PHI: ct.NHOM_TINH_PHI,
                                                                            DO_TUOI: dt.MO_TA,
                                                                            GIOI_TINH: "",
                                                                            PHAM_VI_DL: If(
                                                                                ct.PHAM_VI_DL = true,
                                                                                Datafield_PV.Selected.TEN_PHAMVI,
                                                                                ""
                                                                            ),
                                                                            NGANH_NGHE: nn.TEN_NGANH,
                                                                            SO_TIEN: "",
                                                                            SO_NGUOI: "",
                                                                            THOI_HAN: "",
                                                                            PHUONG_THUC_DP: ""
                                                                        }
                                                                    )
                                                                )
                                                            )
                                                        )
                                                    )
                                                ),
                                                If(
                                                    ct.BH_SOTIEN = true,
                                                    ForAll(
                                                        Datafield_ST.SelectedItems As st,
                                                        If(
                                                            ct.BH_SONGUOI = true,
                                                            ForAll(
                                                                Datafield_SN.SelectedItems As sn,
                                                                If(
                                                                    ct.BH_THOIHAN = true,
                                                                    ForAll(
                                                                        Datafield_TH.SelectedItems As th,
                                                                        If(
                                                                            ct.BH_PHUONG_THUC = true,
                                                                            ForAll(
                                                                                Datafield_DP.SelectedItems As dp,
                                                                                Patch(
                                                                                    DL_SAN_PHAM_MATRANPHI,
                                                                                    Defaults(DL_SAN_PHAM_MATRANPHI),
                                                                                    {ID: ct.ID,
                                                                                        MA_SAN_PHAM: valMaSP,
                                                                                        CHUONG_TRINH: ct.CHUONG_TRINH,
                                                                                        NHOM_TINH_PHI: ct.NHOM_TINH_PHI,
                                                                                        DO_TUOI: dt.MO_TA,
                                                                                        GIOI_TINH: "",
                                                                                        PHAM_VI_DL: If(
                                                                                            ct.PHAM_VI_DL = true,
                                                                                            Datafield_PV.Selected.TEN_PHAMVI,
                                                                                            ""
                                                                                        ),
                                                                                        NGANH_NGHE: "",
                                                                                        SO_TIEN: st.TEN_SOTIEN,
                                                                                        SO_NGUOI: sn.TEN_SO_NGUOI,
                                                                                        THOI_HAN: th.TEN_THOI_HAN,
                                                                                        PHUONG_THUC_DP: dp.TEN_PT
                                                                                    }
                                                                                )
                                                                            ),
                                                                            Patch(
                                                                                DL_SAN_PHAM_MATRANPHI,
                                                                                Defaults(DL_SAN_PHAM_MATRANPHI),
                                                                                {ID: ct.ID,
                                                                                    MA_SAN_PHAM: valMaSP,
                                                                                    CHUONG_TRINH: ct.CHUONG_TRINH,
                                                                                    NHOM_TINH_PHI: ct.NHOM_TINH_PHI,
                                                                                    DO_TUOI: dt.MO_TA,
                                                                                    GIOI_TINH: "",
                                                                                    PHAM_VI_DL: If(
                                                                                        ct.PHAM_VI_DL = true,
                                                                                        Datafield_PV.Selected.TEN_PHAMVI,
                                                                                        ""
                                                                                    ),
                                                                                    NGANH_NGHE: "",
                                                                                    SO_TIEN: st.TEN_SOTIEN,
                                                                                    SO_NGUOI: sn.TEN_SO_NGUOI,
                                                                                    THOI_HAN: th.TEN_THOI_HAN,
                                                                                    PHUONG_THUC_DP: ""
                                                                                }
                                                                            )
                                                                        )
                                                                    ),
                                                                    If(
                                                                        ct.BH_PHUONG_THUC = true,
                                                                        ForAll(
                                                                            Datafield_DP.SelectedItems As dp,
                                                                            Patch(
                                                                                DL_SAN_PHAM_MATRANPHI,
                                                                                Defaults(DL_SAN_PHAM_MATRANPHI),
                                                                                {ID: ct.ID,
                                                                                    MA_SAN_PHAM: valMaSP,
                                                                                    CHUONG_TRINH: ct.CHUONG_TRINH,
                                                                                    NHOM_TINH_PHI: ct.NHOM_TINH_PHI,
                                                                                    DO_TUOI: dt.MO_TA,
                                                                                    GIOI_TINH: "",
                                                                                    PHAM_VI_DL: If(
                                                                                        ct.PHAM_VI_DL = true,
                                                                                        Datafield_PV.Selected.TEN_PHAMVI,
                                                                                        ""
                                                                                    ),
                                                                                    NGANH_NGHE: "",
                                                                                    SO_TIEN: st.TEN_SOTIEN,
                                                                                    SO_NGUOI: sn.TEN_SO_NGUOI,
                                                                                    THOI_HAN: "",
                                                                                    PHUONG_THUC_DP: dp.TEN_PT
                                                                                }
                                                                            )
                                                                        ),
                                                                        Patch(
                                                                            DL_SAN_PHAM_MATRANPHI,
                                                                            Defaults(DL_SAN_PHAM_MATRANPHI),
                                                                            {ID: ct.ID,
                                                                                MA_SAN_PHAM: valMaSP,
                                                                                CHUONG_TRINH: ct.CHUONG_TRINH,
                                                                                NHOM_TINH_PHI: ct.NHOM_TINH_PHI,
                                                                                DO_TUOI: dt.MO_TA,
                                                                                GIOI_TINH: "",
                                                                                PHAM_VI_DL: If(
                                                                                    ct.PHAM_VI_DL = true,
                                                                                    Datafield_PV.Selected.TEN_PHAMVI,
                                                                                    ""
                                                                                ),
                                                                                NGANH_NGHE: "",
                                                                                SO_TIEN: st.TEN_SOTIEN,
                                                                                SO_NGUOI: sn.TEN_SO_NGUOI,
                                                                                THOI_HAN: "",
                                                                                PHUONG_THUC_DP: ""
                                                                            }
                                                                        )
                                                                    )
                                                                )
                                                            ),
                                                            If(
                                                                ct.BH_THOIHAN = true,
                                                                ForAll(
                                                                    Datafield_TH.SelectedItems As th,
                                                                    If(
                                                                        ct.BH_PHUONG_THUC = true,
                                                                        ForAll(
                                                                            Datafield_DP.SelectedItems As dp,
                                                                            Patch(
                                                                                DL_SAN_PHAM_MATRANPHI,
                                                                                Defaults(DL_SAN_PHAM_MATRANPHI),
                                                                                {ID: ct.ID,
                                                                                    MA_SAN_PHAM: valMaSP,
                                                                                    CHUONG_TRINH: ct.CHUONG_TRINH,
                                                                                    NHOM_TINH_PHI: ct.NHOM_TINH_PHI,
                                                                                    DO_TUOI: dt.MO_TA,
                                                                                    GIOI_TINH: "",
                                                                                    PHAM_VI_DL: If(
                                                                                        ct.PHAM_VI_DL = true,
                                                                                        Datafield_PV.Selected.TEN_PHAMVI,
                                                                                        ""
                                                                                    ),
                                                                                    NGANH_NGHE: "",
                                                                                    SO_TIEN: st.TEN_SOTIEN,
                                                                                    SO_NGUOI: "",
                                                                                    THOI_HAN: th.TEN_THOI_HAN,
                                                                                    PHUONG_THUC_DP: dp.TEN_PT
                                                                                }
                                                                            )
                                                                        ),
                                                                        Patch(
                                                                            DL_SAN_PHAM_MATRANPHI,
                                                                            Defaults(DL_SAN_PHAM_MATRANPHI),
                                                                            {ID: ct.ID,
                                                                                MA_SAN_PHAM: valMaSP,
                                                                                CHUONG_TRINH: ct.CHUONG_TRINH,
                                                                                NHOM_TINH_PHI: ct.NHOM_TINH_PHI,
                                                                                DO_TUOI: dt.MO_TA,
                                                                                GIOI_TINH: "",
                                                                                PHAM_VI_DL: If(
                                                                                    ct.PHAM_VI_DL = true,
                                                                                    Datafield_PV.Selected.TEN_PHAMVI,
                                                                                    ""
                                                                                ),
                                                                                NGANH_NGHE: "",
                                                                                SO_TIEN: st.TEN_SOTIEN,
                                                                                SO_NGUOI: "",
                                                                                THOI_HAN: th.TEN_THOI_HAN,
                                                                                PHUONG_THUC_DP: ""
                                                                            }
                                                                        )
                                                                    )
                                                                ),
                                                                If(
                                                                    ct.BH_PHUONG_THUC = true,
                                                                    ForAll(
                                                                        Datafield_DP.SelectedItems As dp,
                                                                        Patch(
                                                                            DL_SAN_PHAM_MATRANPHI,
                                                                            Defaults(DL_SAN_PHAM_MATRANPHI),
                                                                            {ID: ct.ID,
                                                                                MA_SAN_PHAM: valMaSP,
                                                                                CHUONG_TRINH: ct.CHUONG_TRINH,
                                                                                NHOM_TINH_PHI: ct.NHOM_TINH_PHI,
                                                                                DO_TUOI: dt.MO_TA,
                                                                                GIOI_TINH: "",
                                                                                PHAM_VI_DL: If(
                                                                                    ct.PHAM_VI_DL = true,
                                                                                    Datafield_PV.Selected.TEN_PHAMVI,
                                                                                    ""
                                                                                ),
                                                                                NGANH_NGHE: "",
                                                                                SO_TIEN: st.TEN_SOTIEN,
                                                                                SO_NGUOI: "",
                                                                                THOI_HAN: "",
                                                                                PHUONG_THUC_DP: dp.TEN_PT
                                                                            }
                                                                        )
                                                                    ),
                                                                    Patch(
                                                                        DL_SAN_PHAM_MATRANPHI,
                                                                        Defaults(DL_SAN_PHAM_MATRANPHI),
                                                                        {ID: ct.ID,
                                                                            MA_SAN_PHAM: valMaSP,
                                                                            CHUONG_TRINH: ct.CHUONG_TRINH,
                                                                            NHOM_TINH_PHI: ct.NHOM_TINH_PHI,
                                                                            DO_TUOI: dt.MO_TA,
                                                                            GIOI_TINH: "",
                                                                            PHAM_VI_DL: If(
                                                                                ct.PHAM_VI_DL = true,
                                                                                Datafield_PV.Selected.TEN_PHAMVI,
                                                                                ""
                                                                            ),
                                                                            NGANH_NGHE: "",
                                                                            SO_TIEN: st.TEN_SOTIEN,
                                                                            SO_NGUOI: "",
                                                                            THOI_HAN: "",
                                                                            PHUONG_THUC_DP: ""
                                                                        }
                                                                    )
                                                                )
                                                            )
                                                        )
                                                    ),
                                                    If(
                                                        ct.BH_SONGUOI = true,
                                                        ForAll(
                                                            Datafield_SN.SelectedItems As sn,
                                                            If(
                                                                ct.BH_THOIHAN = true,
                                                                ForAll(
                                                                    Datafield_TH.SelectedItems As th,
                                                                    If(
                                                                        ct.BH_PHUONG_THUC = true,
                                                                        ForAll(
                                                                            Datafield_DP.SelectedItems As dp,
                                                                            Patch(
                                                                                DL_SAN_PHAM_MATRANPHI,
                                                                                Defaults(DL_SAN_PHAM_MATRANPHI),
                                                                                {ID: ct.ID,
                                                                                    MA_SAN_PHAM: valMaSP,
                                                                                    CHUONG_TRINH: ct.CHUONG_TRINH,
                                                                                    NHOM_TINH_PHI: ct.NHOM_TINH_PHI,
                                                                                    DO_TUOI: dt.MO_TA,
                                                                                    GIOI_TINH: "",
                                                                                    PHAM_VI_DL: If(
                                                                                        ct.PHAM_VI_DL = true,
                                                                                        Datafield_PV.Selected.TEN_PHAMVI,
                                                                                        ""
                                                                                    ),
                                                                                    NGANH_NGHE: "",
                                                                                    SO_TIEN: "",
                                                                                    SO_NGUOI: sn.TEN_SO_NGUOI,
                                                                                    THOI_HAN: th.TEN_THOI_HAN,
                                                                                    PHUONG_THUC_DP: dp.TEN_PT
                                                                                }
                                                                            )
                                                                        ),
                                                                        Patch(
                                                                            DL_SAN_PHAM_MATRANPHI,
                                                                            Defaults(DL_SAN_PHAM_MATRANPHI),
                                                                            {ID: ct.ID,
                                                                                MA_SAN_PHAM: valMaSP,
                                                                                CHUONG_TRINH: ct.CHUONG_TRINH,
                                                                                NHOM_TINH_PHI: ct.NHOM_TINH_PHI,
                                                                                DO_TUOI: dt.MO_TA,
                                                                                GIOI_TINH: "",
                                                                                PHAM_VI_DL: If(
                                                                                    ct.PHAM_VI_DL = true,
                                                                                    Datafield_PV.Selected.TEN_PHAMVI,
                                                                                    ""
                                                                                ),
                                                                                NGANH_NGHE: "",
                                                                                SO_TIEN: "",
                                                                                SO_NGUOI: sn.TEN_SO_NGUOI,
                                                                                THOI_HAN: th.TEN_THOI_HAN,
                                                                                PHUONG_THUC_DP: ""
                                                                            }
                                                                        )
                                                                    )
                                                                ),
                                                                If(
                                                                    ct.BH_PHUONG_THUC = true,
                                                                    ForAll(
                                                                        Datafield_DP.SelectedItems As dp,
                                                                        Patch(
                                                                            DL_SAN_PHAM_MATRANPHI,
                                                                            Defaults(DL_SAN_PHAM_MATRANPHI),
                                                                            {ID: ct.ID,
                                                                                MA_SAN_PHAM: valMaSP,
                                                                                CHUONG_TRINH: ct.CHUONG_TRINH,
                                                                                NHOM_TINH_PHI: ct.NHOM_TINH_PHI,
                                                                                DO_TUOI: dt.MO_TA,
                                                                                GIOI_TINH: "",
                                                                                PHAM_VI_DL: If(
                                                                                    ct.PHAM_VI_DL = true,
                                                                                    Datafield_PV.Selected.TEN_PHAMVI,
                                                                                    ""
                                                                                ),
                                                                                NGANH_NGHE: "",
                                                                                SO_TIEN: "",
                                                                                SO_NGUOI: sn.TEN_SO_NGUOI,
                                                                                THOI_HAN: "",
                                                                                PHUONG_THUC_DP: dp.TEN_PT
                                                                            }
                                                                        )
                                                                    ),
                                                                    Patch(
                                                                        DL_SAN_PHAM_MATRANPHI,
                                                                        Defaults(DL_SAN_PHAM_MATRANPHI),
                                                                        {ID: ct.ID,
                                                                            MA_SAN_PHAM: valMaSP,
                                                                            CHUONG_TRINH: ct.CHUONG_TRINH,
                                                                            NHOM_TINH_PHI: ct.NHOM_TINH_PHI,
                                                                            DO_TUOI: dt.MO_TA,
                                                                            GIOI_TINH: "",
                                                                            PHAM_VI_DL: If(
                                                                                ct.PHAM_VI_DL = true,
                                                                                Datafield_PV.Selected.TEN_PHAMVI,
                                                                                ""
                                                                            ),
                                                                            NGANH_NGHE: "",
                                                                            SO_TIEN: "",
                                                                            SO_NGUOI: sn.TEN_SO_NGUOI,
                                                                            THOI_HAN: "",
                                                                            PHUONG_THUC_DP: ""
                                                                        }
                                                                    )
                                                                )
                                                            )
                                                        ),
                                                        If(
                                                            ct.BH_THOIHAN = true,
                                                            ForAll(
                                                                Datafield_TH.SelectedItems As th,
                                                                If(
                                                                    ct.BH_PHUONG_THUC = true,
                                                                    ForAll(
                                                                        Datafield_DP.SelectedItems As dp,
                                                                        Patch(
                                                                            DL_SAN_PHAM_MATRANPHI,
                                                                            Defaults(DL_SAN_PHAM_MATRANPHI),
                                                                            {ID: ct.ID,
                                                                                MA_SAN_PHAM: valMaSP,
                                                                                CHUONG_TRINH: ct.CHUONG_TRINH,
                                                                                NHOM_TINH_PHI: ct.NHOM_TINH_PHI,
                                                                                DO_TUOI: dt.MO_TA,
                                                                                GIOI_TINH: "",
                                                                                PHAM_VI_DL: If(
                                                                                    ct.PHAM_VI_DL = true,
                                                                                    Datafield_PV.Selected.TEN_PHAMVI,
                                                                                    ""
                                                                                ),
                                                                                NGANH_NGHE: "",
                                                                                SO_TIEN: "",
                                                                                SO_NGUOI: "",
                                                                                THOI_HAN: th.TEN_THOI_HAN,
                                                                                PHUONG_THUC_DP: dp.TEN_PT
                                                                            }
                                                                        )
                                                                    ),
                                                                    Patch(
                                                                        DL_SAN_PHAM_MATRANPHI,
                                                                        Defaults(DL_SAN_PHAM_MATRANPHI),
                                                                        {ID: ct.ID,
                                                                            MA_SAN_PHAM: valMaSP,
                                                                            CHUONG_TRINH: ct.CHUONG_TRINH,
                                                                            NHOM_TINH_PHI: ct.NHOM_TINH_PHI,
                                                                            DO_TUOI: dt.MO_TA,
                                                                            GIOI_TINH: "",
                                                                            PHAM_VI_DL: If(
                                                                                ct.PHAM_VI_DL = true,
                                                                                Datafield_PV.Selected.TEN_PHAMVI,
                                                                                ""
                                                                            ),
                                                                            NGANH_NGHE: "",
                                                                            SO_TIEN: "",
                                                                            SO_NGUOI: "",
                                                                            THOI_HAN: th.TEN_THOI_HAN,
                                                                            PHUONG_THUC_DP: ""
                                                                        }
                                                                    )
                                                                )
                                                            ),
                                                            If(
                                                                ct.BH_PHUONG_THUC = true,
                                                                ForAll(
                                                                    Datafield_DP.SelectedItems As dp,
                                                                    Patch(
                                                                        DL_SAN_PHAM_MATRANPHI,
                                                                        Defaults(DL_SAN_PHAM_MATRANPHI),
                                                                        {ID: ct.ID,
                                                                            MA_SAN_PHAM: valMaSP,
                                                                            CHUONG_TRINH: ct.CHUONG_TRINH,
                                                                            NHOM_TINH_PHI: ct.NHOM_TINH_PHI,
                                                                            DO_TUOI: dt.MO_TA,
                                                                            GIOI_TINH: "",
                                                                            PHAM_VI_DL: If(
                                                                                ct.PHAM_VI_DL = true,
                                                                                Datafield_PV.Selected.TEN_PHAMVI,
                                                                                ""
                                                                            ),
                                                                            NGANH_NGHE: "",
                                                                            SO_TIEN: "",
                                                                            SO_NGUOI: "",
                                                                            THOI_HAN: "",
                                                                            PHUONG_THUC_DP: dp.TEN_PT
                                                                        }
                                                                    )
                                                                ),
                                                                Patch(
                                                                    DL_SAN_PHAM_MATRANPHI,
                                                                    Defaults(DL_SAN_PHAM_MATRANPHI),
                                                                    {ID: ct.ID,
                                                                        MA_SAN_PHAM: valMaSP,
                                                                        CHUONG_TRINH: ct.CHUONG_TRINH,
                                                                        NHOM_TINH_PHI: ct.NHOM_TINH_PHI,
                                                                        DO_TUOI: dt.MO_TA,
                                                                        GIOI_TINH: "",
                                                                        PHAM_VI_DL: If(
                                                                            ct.PHAM_VI_DL = true,
                                                                            Datafield_PV.Selected.TEN_PHAMVI,
                                                                            ""
                                                                        ),
                                                                        NGANH_NGHE: "",
                                                                        SO_TIEN: "",
                                                                        SO_NGUOI: "",
                                                                        THOI_HAN: "",
                                                                        PHUONG_THUC_DP: ""
                                                                    }
                                                                )
                                                            )
                                                        )
                                                    )
                                                )
                                            )
                                        )
                                    ),
                                    If(
                                        ct.GIOI_TINH = true,
                                        ForAll(
                                            Datafield_GT.SelectedItems As gt,
                                            If(
                                                ct.NGANH_NGHE = true,
                                                ForAll(
                                                    Datafield_NN.SelectedItems As nn,
                                                    If(
                                                        ct.BH_SOTIEN = true,
                                                        ForAll(
                                                            Datafield_ST.SelectedItems As st,
                                                            If(
                                                                ct.BH_SONGUOI = true,
                                                                ForAll(
                                                                    Datafield_SN.SelectedItems As sn,
                                                                    If(
                                                                        ct.BH_THOIHAN = true,
                                                                        ForAll(
                                                                            Datafield_TH.SelectedItems As th,
                                                                            If(
                                                                                ct.BH_PHUONG_THUC = true,
                                                                                ForAll(
                                                                                    Datafield_DP.SelectedItems As dp,
                                                                                    Patch(
                                                                                        DL_SAN_PHAM_MATRANPHI,
                                                                                        Defaults(DL_SAN_PHAM_MATRANPHI),
                                                                                        {ID: ct.ID,
                                                                                            MA_SAN_PHAM: valMaSP,
                                                                                            CHUONG_TRINH: ct.CHUONG_TRINH,
                                                                                            NHOM_TINH_PHI: ct.NHOM_TINH_PHI,
                                                                                            DO_TUOI: "",
                                                                                            GIOI_TINH: gt.TEN_GIOI_TINH,
                                                                                            PHAM_VI_DL: If(
                                                                                                ct.PHAM_VI_DL = true,
                                                                                                Datafield_PV.Selected.TEN_PHAMVI,
                                                                                                ""
                                                                                            ),
                                                                                            NGANH_NGHE: nn.TEN_NGANH,
                                                                                            SO_TIEN: st.TEN_SOTIEN,
                                                                                            SO_NGUOI: sn.TEN_SO_NGUOI,
                                                                                            THOI_HAN: th.TEN_THOI_HAN,
                                                                                            PHUONG_THUC_DP: dp.TEN_PT
                                                                                        }
                                                                                    )
                                                                                ),
                                                                                Patch(
                                                                                    DL_SAN_PHAM_MATRANPHI,
                                                                                    Defaults(DL_SAN_PHAM_MATRANPHI),
                                                                                    {ID: ct.ID,
                                                                                        MA_SAN_PHAM: valMaSP,
                                                                                        CHUONG_TRINH: ct.CHUONG_TRINH,
                                                                                        NHOM_TINH_PHI: ct.NHOM_TINH_PHI,
                                                                                        DO_TUOI: "",
                                                                                        GIOI_TINH: gt.TEN_GIOI_TINH,
                                                                                        PHAM_VI_DL: If(
                                                                                            ct.PHAM_VI_DL = true,
                                                                                            Datafield_PV.Selected.TEN_PHAMVI,
                                                                                            ""
                                                                                        ),
                                                                                        NGANH_NGHE: nn.TEN_NGANH,
                                                                                        SO_TIEN: st.TEN_SOTIEN,
                                                                                        SO_NGUOI: sn.TEN_SO_NGUOI,
                                                                                        THOI_HAN: th.TEN_THOI_HAN,
                                                                                        PHUONG_THUC_DP: ""
                                                                                    }
                                                                                )
                                                                            )
                                                                        ),
                                                                        If(
                                                                            ct.BH_PHUONG_THUC = true,
                                                                            ForAll(
                                                                                Datafield_DP.SelectedItems As dp,
                                                                                Patch(
                                                                                    DL_SAN_PHAM_MATRANPHI,
                                                                                    Defaults(DL_SAN_PHAM_MATRANPHI),
                                                                                    {ID: ct.ID,
                                                                                        MA_SAN_PHAM: valMaSP,
                                                                                        CHUONG_TRINH: ct.CHUONG_TRINH,
                                                                                        NHOM_TINH_PHI: ct.NHOM_TINH_PHI,
                                                                                        DO_TUOI: "",
                                                                                        GIOI_TINH: gt.TEN_GIOI_TINH,
                                                                                        PHAM_VI_DL: If(
                                                                                            ct.PHAM_VI_DL = true,
                                                                                            Datafield_PV.Selected.TEN_PHAMVI,
                                                                                            ""
                                                                                        ),
                                                                                        NGANH_NGHE: nn.TEN_NGANH,
                                                                                        SO_TIEN: st.TEN_SOTIEN,
                                                                                        SO_NGUOI: sn.TEN_SO_NGUOI,
                                                                                        THOI_HAN: "",
                                                                                        PHUONG_THUC_DP: dp.TEN_PT
                                                                                    }
                                                                                )
                                                                            ),
                                                                            Patch(
                                                                                DL_SAN_PHAM_MATRANPHI,
                                                                                Defaults(DL_SAN_PHAM_MATRANPHI),
                                                                                {ID: ct.ID,
                                                                                    MA_SAN_PHAM: valMaSP,
                                                                                    CHUONG_TRINH: ct.CHUONG_TRINH,
                                                                                    NHOM_TINH_PHI: ct.NHOM_TINH_PHI,
                                                                                    DO_TUOI: "",
                                                                                    GIOI_TINH: gt.TEN_GIOI_TINH,
                                                                                    PHAM_VI_DL: If(
                                                                                        ct.PHAM_VI_DL = true,
                                                                                        Datafield_PV.Selected.TEN_PHAMVI,
                                                                                        ""
                                                                                    ),
                                                                                    NGANH_NGHE: nn.TEN_NGANH,
                                                                                    SO_TIEN: st.TEN_SOTIEN,
                                                                                    SO_NGUOI: sn.TEN_SO_NGUOI,
                                                                                    THOI_HAN: "",
                                                                                    PHUONG_THUC_DP: ""
                                                                                }
                                                                            )
                                                                        )
                                                                    )
                                                                ),
                                                                If(
                                                                    ct.BH_THOIHAN = true,
                                                                    ForAll(
                                                                        Datafield_TH.SelectedItems As th,
                                                                        If(
                                                                            ct.BH_PHUONG_THUC = true,
                                                                            ForAll(
                                                                                Datafield_DP.SelectedItems As dp,
                                                                                Patch(
                                                                                    DL_SAN_PHAM_MATRANPHI,
                                                                                    Defaults(DL_SAN_PHAM_MATRANPHI),
                                                                                    {ID: ct.ID,
                                                                                        MA_SAN_PHAM: valMaSP,
                                                                                        CHUONG_TRINH: ct.CHUONG_TRINH,
                                                                                        NHOM_TINH_PHI: ct.NHOM_TINH_PHI,
                                                                                        DO_TUOI: "",
                                                                                        GIOI_TINH: gt.TEN_GIOI_TINH,
                                                                                        PHAM_VI_DL: If(
                                                                                            ct.PHAM_VI_DL = true,
                                                                                            Datafield_PV.Selected.TEN_PHAMVI,
                                                                                            ""
                                                                                        ),
                                                                                        NGANH_NGHE: nn.TEN_NGANH,
                                                                                        SO_TIEN: st.TEN_SOTIEN,
                                                                                        SO_NGUOI: "",
                                                                                        THOI_HAN: th.TEN_THOI_HAN,
                                                                                        PHUONG_THUC_DP: dp.TEN_PT
                                                                                    }
                                                                                )
                                                                            ),
                                                                            Patch(
                                                                                DL_SAN_PHAM_MATRANPHI,
                                                                                Defaults(DL_SAN_PHAM_MATRANPHI),
                                                                                {ID: ct.ID,
                                                                                    MA_SAN_PHAM: valMaSP,
                                                                                    CHUONG_TRINH: ct.CHUONG_TRINH,
                                                                                    NHOM_TINH_PHI: ct.NHOM_TINH_PHI,
                                                                                    DO_TUOI: "",
                                                                                    GIOI_TINH: gt.TEN_GIOI_TINH,
                                                                                    PHAM_VI_DL: If(
                                                                                        ct.PHAM_VI_DL = true,
                                                                                        Datafield_PV.Selected.TEN_PHAMVI,
                                                                                        ""
                                                                                    ),
                                                                                    NGANH_NGHE: nn.TEN_NGANH,
                                                                                    SO_TIEN: st.TEN_SOTIEN,
                                                                                    SO_NGUOI: "",
                                                                                    THOI_HAN: th.TEN_THOI_HAN,
                                                                                    PHUONG_THUC_DP: ""
                                                                                }
                                                                            )
                                                                        )
                                                                    ),
                                                                    If(
                                                                        ct.BH_PHUONG_THUC = true,
                                                                        ForAll(
                                                                            Datafield_DP.SelectedItems As dp,
                                                                            Patch(
                                                                                DL_SAN_PHAM_MATRANPHI,
                                                                                Defaults(DL_SAN_PHAM_MATRANPHI),
                                                                                {ID: ct.ID,
                                                                                    MA_SAN_PHAM: valMaSP,
                                                                                    CHUONG_TRINH: ct.CHUONG_TRINH,
                                                                                    NHOM_TINH_PHI: ct.NHOM_TINH_PHI,
                                                                                    DO_TUOI: "",
                                                                                    GIOI_TINH: gt.TEN_GIOI_TINH,
                                                                                    PHAM_VI_DL: If(
                                                                                        ct.PHAM_VI_DL = true,
                                                                                        Datafield_PV.Selected.TEN_PHAMVI,
                                                                                        ""
                                                                                    ),
                                                                                    NGANH_NGHE: nn.TEN_NGANH,
                                                                                    SO_TIEN: st.TEN_SOTIEN,
                                                                                    SO_NGUOI: "",
                                                                                    THOI_HAN: "",
                                                                                    PHUONG_THUC_DP: dp.TEN_PT
                                                                                }
                                                                            )
                                                                        ),
                                                                        Patch(
                                                                            DL_SAN_PHAM_MATRANPHI,
                                                                            Defaults(DL_SAN_PHAM_MATRANPHI),
                                                                            {ID: ct.ID,
                                                                                MA_SAN_PHAM: valMaSP,
                                                                                CHUONG_TRINH: ct.CHUONG_TRINH,
                                                                                NHOM_TINH_PHI: ct.NHOM_TINH_PHI,
                                                                                DO_TUOI: "",
                                                                                GIOI_TINH: gt.TEN_GIOI_TINH,
                                                                                PHAM_VI_DL: If(
                                                                                    ct.PHAM_VI_DL = true,
                                                                                    Datafield_PV.Selected.TEN_PHAMVI,
                                                                                    ""
                                                                                ),
                                                                                NGANH_NGHE: nn.TEN_NGANH,
                                                                                SO_TIEN: st.TEN_SOTIEN,
                                                                                SO_NGUOI: "",
                                                                                THOI_HAN: "",
                                                                                PHUONG_THUC_DP: ""
                                                                            }
                                                                        )
                                                                    )
                                                                )
                                                            )
                                                        ),
                                                        If(
                                                            ct.BH_SONGUOI = true,
                                                            ForAll(
                                                                Datafield_SN.SelectedItems As sn,
                                                                If(
                                                                    ct.BH_THOIHAN = true,
                                                                    ForAll(
                                                                        Datafield_TH.SelectedItems As th,
                                                                        If(
                                                                            ct.BH_PHUONG_THUC = true,
                                                                            ForAll(
                                                                                Datafield_DP.SelectedItems As dp,
                                                                                Patch(
                                                                                    DL_SAN_PHAM_MATRANPHI,
                                                                                    Defaults(DL_SAN_PHAM_MATRANPHI),
                                                                                    {ID: ct.ID,
                                                                                        MA_SAN_PHAM: valMaSP,
                                                                                        CHUONG_TRINH: ct.CHUONG_TRINH,
                                                                                        NHOM_TINH_PHI: ct.NHOM_TINH_PHI,
                                                                                        DO_TUOI: "",
                                                                                        GIOI_TINH: gt.TEN_GIOI_TINH,
                                                                                        PHAM_VI_DL: If(
                                                                                            ct.PHAM_VI_DL = true,
                                                                                            Datafield_PV.Selected.TEN_PHAMVI,
                                                                                            ""
                                                                                        ),
                                                                                        NGANH_NGHE: nn.TEN_NGANH,
                                                                                        SO_TIEN: "",
                                                                                        SO_NGUOI: sn.TEN_SO_NGUOI,
                                                                                        THOI_HAN: th.TEN_THOI_HAN,
                                                                                        PHUONG_THUC_DP: dp.TEN_PT
                                                                                    }
                                                                                )
                                                                            ),
                                                                            Patch(
                                                                                DL_SAN_PHAM_MATRANPHI,
                                                                                Defaults(DL_SAN_PHAM_MATRANPHI),
                                                                                {ID: ct.ID,
                                                                                    MA_SAN_PHAM: valMaSP,
                                                                                    CHUONG_TRINH: ct.CHUONG_TRINH,
                                                                                    NHOM_TINH_PHI: ct.NHOM_TINH_PHI,
                                                                                    DO_TUOI: "",
                                                                                    GIOI_TINH: gt.TEN_GIOI_TINH,
                                                                                    PHAM_VI_DL: If(
                                                                                        ct.PHAM_VI_DL = true,
                                                                                        Datafield_PV.Selected.TEN_PHAMVI,
                                                                                        ""
                                                                                    ),
                                                                                    NGANH_NGHE: nn.TEN_NGANH,
                                                                                    SO_TIEN: "",
                                                                                    SO_NGUOI: sn.TEN_SO_NGUOI,
                                                                                    THOI_HAN: th.TEN_THOI_HAN,
                                                                                    PHUONG_THUC_DP: ""
                                                                                }
                                                                            )
                                                                        )
                                                                    ),
                                                                    If(
                                                                        ct.BH_PHUONG_THUC = true,
                                                                        ForAll(
                                                                            Datafield_DP.SelectedItems As dp,
                                                                            Patch(
                                                                                DL_SAN_PHAM_MATRANPHI,
                                                                                Defaults(DL_SAN_PHAM_MATRANPHI),
                                                                                {ID: ct.ID,
                                                                                    MA_SAN_PHAM: valMaSP,
                                                                                    CHUONG_TRINH: ct.CHUONG_TRINH,
                                                                                    NHOM_TINH_PHI: ct.NHOM_TINH_PHI,
                                                                                    DO_TUOI: "",
                                                                                    GIOI_TINH: gt.TEN_GIOI_TINH,
                                                                                    PHAM_VI_DL: If(
                                                                                        ct.PHAM_VI_DL = true,
                                                                                        Datafield_PV.Selected.TEN_PHAMVI,
                                                                                        ""
                                                                                    ),
                                                                                    NGANH_NGHE: nn.TEN_NGANH,
                                                                                    SO_TIEN: "",
                                                                                    SO_NGUOI: sn.TEN_SO_NGUOI,
                                                                                    THOI_HAN: "",
                                                                                    PHUONG_THUC_DP: dp.TEN_PT
                                                                                }
                                                                            )
                                                                        ),
                                                                        Patch(
                                                                            DL_SAN_PHAM_MATRANPHI,
                                                                            Defaults(DL_SAN_PHAM_MATRANPHI),
                                                                            {ID: ct.ID,
                                                                                MA_SAN_PHAM: valMaSP,
                                                                                CHUONG_TRINH: ct.CHUONG_TRINH,
                                                                                NHOM_TINH_PHI: ct.NHOM_TINH_PHI,
                                                                                DO_TUOI: "",
                                                                                GIOI_TINH: gt.TEN_GIOI_TINH,
                                                                                PHAM_VI_DL: If(
                                                                                    ct.PHAM_VI_DL = true,
                                                                                    Datafield_PV.Selected.TEN_PHAMVI,
                                                                                    ""
                                                                                ),
                                                                                NGANH_NGHE: nn.TEN_NGANH,
                                                                                SO_TIEN: "",
                                                                                SO_NGUOI: sn.TEN_SO_NGUOI,
                                                                                THOI_HAN: "",
                                                                                PHUONG_THUC_DP: ""
                                                                            }
                                                                        )
                                                                    )
                                                                )
                                                            ),
                                                            If(
                                                                ct.BH_THOIHAN = true,
                                                                ForAll(
                                                                    Datafield_TH.SelectedItems As th,
                                                                    If(
                                                                        ct.BH_PHUONG_THUC = true,
                                                                        ForAll(
                                                                            Datafield_DP.SelectedItems As dp,
                                                                            Patch(
                                                                                DL_SAN_PHAM_MATRANPHI,
                                                                                Defaults(DL_SAN_PHAM_MATRANPHI),
                                                                                {ID: ct.ID,
                                                                                    MA_SAN_PHAM: valMaSP,
                                                                                    CHUONG_TRINH: ct.CHUONG_TRINH,
                                                                                    NHOM_TINH_PHI: ct.NHOM_TINH_PHI,
                                                                                    DO_TUOI: "",
                                                                                    GIOI_TINH: gt.TEN_GIOI_TINH,
                                                                                    PHAM_VI_DL: If(
                                                                                        ct.PHAM_VI_DL = true,
                                                                                        Datafield_PV.Selected.TEN_PHAMVI,
                                                                                        ""
                                                                                    ),
                                                                                    NGANH_NGHE: nn.TEN_NGANH,
                                                                                    SO_TIEN: "",
                                                                                    SO_NGUOI: "",
                                                                                    THOI_HAN: th.TEN_THOI_HAN,
                                                                                    PHUONG_THUC_DP: dp.TEN_PT
                                                                                }
                                                                            )
                                                                        ),
                                                                        Patch(
                                                                            DL_SAN_PHAM_MATRANPHI,
                                                                            Defaults(DL_SAN_PHAM_MATRANPHI),
                                                                            {ID: ct.ID,
                                                                                MA_SAN_PHAM: valMaSP,
                                                                                CHUONG_TRINH: ct.CHUONG_TRINH,
                                                                                NHOM_TINH_PHI: ct.NHOM_TINH_PHI,
                                                                                DO_TUOI: "",
                                                                                GIOI_TINH: gt.TEN_GIOI_TINH,
                                                                                PHAM_VI_DL: If(
                                                                                    ct.PHAM_VI_DL = true,
                                                                                    Datafield_PV.Selected.TEN_PHAMVI,
                                                                                    ""
                                                                                ),
                                                                                NGANH_NGHE: nn.TEN_NGANH,
                                                                                SO_TIEN: "",
                                                                                SO_NGUOI: "",
                                                                                THOI_HAN: th.TEN_THOI_HAN,
                                                                                PHUONG_THUC_DP: ""
                                                                            }
                                                                        )
                                                                    )
                                                                ),
                                                                If(
                                                                    ct.BH_PHUONG_THUC = true,
                                                                    ForAll(
                                                                        Datafield_DP.SelectedItems As dp,
                                                                        Patch(
                                                                            DL_SAN_PHAM_MATRANPHI,
                                                                            Defaults(DL_SAN_PHAM_MATRANPHI),
                                                                            {ID: ct.ID,
                                                                                MA_SAN_PHAM: valMaSP,
                                                                                CHUONG_TRINH: ct.CHUONG_TRINH,
                                                                                NHOM_TINH_PHI: ct.NHOM_TINH_PHI,
                                                                                DO_TUOI: "",
                                                                                GIOI_TINH: gt.TEN_GIOI_TINH,
                                                                                PHAM_VI_DL: If(
                                                                                    ct.PHAM_VI_DL = true,
                                                                                    Datafield_PV.Selected.TEN_PHAMVI,
                                                                                    ""
                                                                                ),
                                                                                NGANH_NGHE: nn.TEN_NGANH,
                                                                                SO_TIEN: "",
                                                                                SO_NGUOI: "",
                                                                                THOI_HAN: "",
                                                                                PHUONG_THUC_DP: dp.TEN_PT
                                                                            }
                                                                        )
                                                                    ),
                                                                    Patch(
                                                                        DL_SAN_PHAM_MATRANPHI,
                                                                        Defaults(DL_SAN_PHAM_MATRANPHI),
                                                                        {ID: ct.ID,
                                                                            MA_SAN_PHAM: valMaSP,
                                                                            CHUONG_TRINH: ct.CHUONG_TRINH,
                                                                            NHOM_TINH_PHI: ct.NHOM_TINH_PHI,
                                                                            DO_TUOI: "",
                                                                            GIOI_TINH: gt.TEN_GIOI_TINH,
                                                                            PHAM_VI_DL: If(
                                                                                ct.PHAM_VI_DL = true,
                                                                                Datafield_PV.Selected.TEN_PHAMVI,
                                                                                ""
                                                                            ),
                                                                            NGANH_NGHE: nn.TEN_NGANH,
                                                                            SO_TIEN: "",
                                                                            SO_NGUOI: "",
                                                                            THOI_HAN: "",
                                                                            PHUONG_THUC_DP: ""
                                                                        }
                                                                    )
                                                                )
                                                            )
                                                        )
                                                    )
                                                ),
                                                If(
                                                    ct.BH_SOTIEN = true,
                                                    ForAll(
                                                        Datafield_ST.SelectedItems As st,
                                                        If(
                                                            ct.BH_SONGUOI = true,
                                                            ForAll(
                                                                Datafield_SN.SelectedItems As sn,
                                                                If(
                                                                    ct.BH_THOIHAN = true,
                                                                    ForAll(
                                                                        Datafield_TH.SelectedItems As th,
                                                                        If(
                                                                            ct.BH_PHUONG_THUC = true,
                                                                            ForAll(
                                                                                Datafield_DP.SelectedItems As dp,
                                                                                Patch(
                                                                                    DL_SAN_PHAM_MATRANPHI,
                                                                                    Defaults(DL_SAN_PHAM_MATRANPHI),
                                                                                    {ID: ct.ID,
                                                                                        MA_SAN_PHAM: valMaSP,
                                                                                        CHUONG_TRINH: ct.CHUONG_TRINH,
                                                                                        NHOM_TINH_PHI: ct.NHOM_TINH_PHI,
                                                                                        DO_TUOI: "",
                                                                                        GIOI_TINH: gt.TEN_GIOI_TINH,
                                                                                        PHAM_VI_DL: If(
                                                                                            ct.PHAM_VI_DL = true,
                                                                                            Datafield_PV.Selected.TEN_PHAMVI,
                                                                                            ""
                                                                                        ),
                                                                                        NGANH_NGHE: "",
                                                                                        SO_TIEN: st.TEN_SOTIEN,
                                                                                        SO_NGUOI: sn.TEN_SO_NGUOI,
                                                                                        THOI_HAN: th.TEN_THOI_HAN,
                                                                                        PHUONG_THUC_DP: dp.TEN_PT
                                                                                    }
                                                                                )
                                                                            ),
                                                                            Patch(
                                                                                DL_SAN_PHAM_MATRANPHI,
                                                                                Defaults(DL_SAN_PHAM_MATRANPHI),
                                                                                {ID: ct.ID,
                                                                                    MA_SAN_PHAM: valMaSP,
                                                                                    CHUONG_TRINH: ct.CHUONG_TRINH,
                                                                                    NHOM_TINH_PHI: ct.NHOM_TINH_PHI,
                                                                                    DO_TUOI: "",
                                                                                    GIOI_TINH: gt.TEN_GIOI_TINH,
                                                                                    PHAM_VI_DL: If(
                                                                                        ct.PHAM_VI_DL = true,
                                                                                        Datafield_PV.Selected.TEN_PHAMVI,
                                                                                        ""
                                                                                    ),
                                                                                    NGANH_NGHE: "",
                                                                                    SO_TIEN: st.TEN_SOTIEN,
                                                                                    SO_NGUOI: sn.TEN_SO_NGUOI,
                                                                                    THOI_HAN: th.TEN_THOI_HAN,
                                                                                    PHUONG_THUC_DP: ""
                                                                                }
                                                                            )
                                                                        )
                                                                    ),
                                                                    If(
                                                                        ct.BH_PHUONG_THUC = true,
                                                                        ForAll(
                                                                            Datafield_DP.SelectedItems As dp,
                                                                            Patch(
                                                                                DL_SAN_PHAM_MATRANPHI,
                                                                                Defaults(DL_SAN_PHAM_MATRANPHI),
                                                                                {ID: ct.ID,
                                                                                    MA_SAN_PHAM: valMaSP,
                                                                                    CHUONG_TRINH: ct.CHUONG_TRINH,
                                                                                    NHOM_TINH_PHI: ct.NHOM_TINH_PHI,
                                                                                    DO_TUOI: "",
                                                                                    GIOI_TINH: gt.TEN_GIOI_TINH,
                                                                                    PHAM_VI_DL: If(
                                                                                        ct.PHAM_VI_DL = true,
                                                                                        Datafield_PV.Selected.TEN_PHAMVI,
                                                                                        ""
                                                                                    ),
                                                                                    NGANH_NGHE: "",
                                                                                    SO_TIEN: st.TEN_SOTIEN,
                                                                                    SO_NGUOI: sn.TEN_SO_NGUOI,
                                                                                    THOI_HAN: "",
                                                                                    PHUONG_THUC_DP: dp.TEN_PT
                                                                                }
                                                                            )
                                                                        ),
                                                                        Patch(
                                                                            DL_SAN_PHAM_MATRANPHI,
                                                                            Defaults(DL_SAN_PHAM_MATRANPHI),
                                                                            {ID: ct.ID,
                                                                                MA_SAN_PHAM: valMaSP,
                                                                                CHUONG_TRINH: ct.CHUONG_TRINH,
                                                                                NHOM_TINH_PHI: ct.NHOM_TINH_PHI,
                                                                                DO_TUOI: "",
                                                                                GIOI_TINH: gt.TEN_GIOI_TINH,
                                                                                PHAM_VI_DL: If(
                                                                                    ct.PHAM_VI_DL = true,
                                                                                    Datafield_PV.Selected.TEN_PHAMVI,
                                                                                    ""
                                                                                ),
                                                                                NGANH_NGHE: "",
                                                                                SO_TIEN: st.TEN_SOTIEN,
                                                                                SO_NGUOI: sn.TEN_SO_NGUOI,
                                                                                THOI_HAN: "",
                                                                                PHUONG_THUC_DP: ""
                                                                            }
                                                                        )
                                                                    )
                                                                )
                                                            ),
                                                            If(
                                                                ct.BH_THOIHAN = true,
                                                                ForAll(
                                                                    Datafield_TH.SelectedItems As th,
                                                                    If(
                                                                        ct.BH_PHUONG_THUC = true,
                                                                        ForAll(
                                                                            Datafield_DP.SelectedItems As dp,
                                                                            Patch(
                                                                                DL_SAN_PHAM_MATRANPHI,
                                                                                Defaults(DL_SAN_PHAM_MATRANPHI),
                                                                                {ID: ct.ID,
                                                                                    MA_SAN_PHAM: valMaSP,
                                                                                    CHUONG_TRINH: ct.CHUONG_TRINH,
                                                                                    NHOM_TINH_PHI: ct.NHOM_TINH_PHI,
                                                                                    DO_TUOI: "",
                                                                                    GIOI_TINH: gt.TEN_GIOI_TINH,
                                                                                    PHAM_VI_DL: If(
                                                                                        ct.PHAM_VI_DL = true,
                                                                                        Datafield_PV.Selected.TEN_PHAMVI,
                                                                                        ""
                                                                                    ),
                                                                                    NGANH_NGHE: "",
                                                                                    SO_TIEN: st.TEN_SOTIEN,
                                                                                    SO_NGUOI: "",
                                                                                    THOI_HAN: th.TEN_THOI_HAN,
                                                                                    PHUONG_THUC_DP: dp.TEN_PT
                                                                                }
                                                                            )
                                                                        ),
                                                                        Patch(
                                                                            DL_SAN_PHAM_MATRANPHI,
                                                                            Defaults(DL_SAN_PHAM_MATRANPHI),
                                                                            {ID: ct.ID,
                                                                                MA_SAN_PHAM: valMaSP,
                                                                                CHUONG_TRINH: ct.CHUONG_TRINH,
                                                                                NHOM_TINH_PHI: ct.NHOM_TINH_PHI,
                                                                                DO_TUOI: "",
                                                                                GIOI_TINH: gt.TEN_GIOI_TINH,
                                                                                PHAM_VI_DL: If(
                                                                                    ct.PHAM_VI_DL = true,
                                                                                    Datafield_PV.Selected.TEN_PHAMVI,
                                                                                    ""
                                                                                ),
                                                                                NGANH_NGHE: "",
                                                                                SO_TIEN: st.TEN_SOTIEN,
                                                                                SO_NGUOI: "",
                                                                                THOI_HAN: th.TEN_THOI_HAN,
                                                                                PHUONG_THUC_DP: ""
                                                                            }
                                                                        )
                                                                    )
                                                                ),
                                                                If(
                                                                    ct.BH_PHUONG_THUC = true,
                                                                    ForAll(
                                                                        Datafield_DP.SelectedItems As dp,
                                                                        Patch(
                                                                            DL_SAN_PHAM_MATRANPHI,
                                                                            Defaults(DL_SAN_PHAM_MATRANPHI),
                                                                            {ID: ct.ID,
                                                                                MA_SAN_PHAM: valMaSP,
                                                                                CHUONG_TRINH: ct.CHUONG_TRINH,
                                                                                NHOM_TINH_PHI: ct.NHOM_TINH_PHI,
                                                                                DO_TUOI: "",
                                                                                GIOI_TINH: gt.TEN_GIOI_TINH,
                                                                                PHAM_VI_DL: If(
                                                                                    ct.PHAM_VI_DL = true,
                                                                                    Datafield_PV.Selected.TEN_PHAMVI,
                                                                                    ""
                                                                                ),
                                                                                NGANH_NGHE: "",
                                                                                SO_TIEN: st.TEN_SOTIEN,
                                                                                SO_NGUOI: "",
                                                                                THOI_HAN: "",
                                                                                PHUONG_THUC_DP: dp.TEN_PT
                                                                            }
                                                                        )
                                                                    ),
                                                                    Patch(
                                                                        DL_SAN_PHAM_MATRANPHI,
                                                                        Defaults(DL_SAN_PHAM_MATRANPHI),
                                                                        {ID: ct.ID,
                                                                            MA_SAN_PHAM: valMaSP,
                                                                            CHUONG_TRINH: ct.CHUONG_TRINH,
                                                                            NHOM_TINH_PHI: ct.NHOM_TINH_PHI,
                                                                            DO_TUOI: "",
                                                                            GIOI_TINH: gt.TEN_GIOI_TINH,
                                                                            PHAM_VI_DL: If(
                                                                                ct.PHAM_VI_DL = true,
                                                                                Datafield_PV.Selected.TEN_PHAMVI,
                                                                                ""
                                                                            ),
                                                                            NGANH_NGHE: "",
                                                                            SO_TIEN: st.TEN_SOTIEN,
                                                                            SO_NGUOI: "",
                                                                            THOI_HAN: "",
                                                                            PHUONG_THUC_DP: ""
                                                                        }
                                                                    )
                                                                )
                                                            )
                                                        )
                                                    ),
                                                    If(
                                                        ct.BH_SONGUOI = true,
                                                        ForAll(
                                                            Datafield_SN.SelectedItems As sn,
                                                            If(
                                                                ct.BH_THOIHAN = true,
                                                                ForAll(
                                                                    Datafield_TH.SelectedItems As th,
                                                                    If(
                                                                        ct.BH_PHUONG_THUC = true,
                                                                        ForAll(
                                                                            Datafield_DP.SelectedItems As dp,
                                                                            Patch(
                                                                                DL_SAN_PHAM_MATRANPHI,
                                                                                Defaults(DL_SAN_PHAM_MATRANPHI),
                                                                                {ID: ct.ID,
                                                                                    MA_SAN_PHAM: valMaSP,
                                                                                    CHUONG_TRINH: ct.CHUONG_TRINH,
                                                                                    NHOM_TINH_PHI: ct.NHOM_TINH_PHI,
                                                                                    DO_TUOI: "",
                                                                                    GIOI_TINH: gt.TEN_GIOI_TINH,
                                                                                    PHAM_VI_DL: If(
                                                                                        ct.PHAM_VI_DL = true,
                                                                                        Datafield_PV.Selected.TEN_PHAMVI,
                                                                                        ""
                                                                                    ),
                                                                                    NGANH_NGHE: "",
                                                                                    SO_TIEN: "",
                                                                                    SO_NGUOI: sn.TEN_SO_NGUOI,
                                                                                    THOI_HAN: th.TEN_THOI_HAN,
                                                                                    PHUONG_THUC_DP: dp.TEN_PT
                                                                                }
                                                                            )
                                                                        ),
                                                                        Patch(
                                                                            DL_SAN_PHAM_MATRANPHI,
                                                                            Defaults(DL_SAN_PHAM_MATRANPHI),
                                                                            {ID: ct.ID,
                                                                                MA_SAN_PHAM: valMaSP,
                                                                                CHUONG_TRINH: ct.CHUONG_TRINH,
                                                                                NHOM_TINH_PHI: ct.NHOM_TINH_PHI,
                                                                                DO_TUOI: "",
                                                                                GIOI_TINH: gt.TEN_GIOI_TINH,
                                                                                PHAM_VI_DL: If(
                                                                                    ct.PHAM_VI_DL = true,
                                                                                    Datafield_PV.Selected.TEN_PHAMVI,
                                                                                    ""
                                                                                ),
                                                                                NGANH_NGHE: "",
                                                                                SO_TIEN: "",
                                                                                SO_NGUOI: sn.TEN_SO_NGUOI,
                                                                                THOI_HAN: th.TEN_THOI_HAN,
                                                                                PHUONG_THUC_DP: ""
                                                                            }
                                                                        )
                                                                    )
                                                                ),
                                                                If(
                                                                    ct.BH_PHUONG_THUC = true,
                                                                    ForAll(
                                                                        Datafield_DP.SelectedItems As dp,
                                                                        Patch(
                                                                            DL_SAN_PHAM_MATRANPHI,
                                                                            Defaults(DL_SAN_PHAM_MATRANPHI),
                                                                            {ID: ct.ID,
                                                                                MA_SAN_PHAM: valMaSP,
                                                                                CHUONG_TRINH: ct.CHUONG_TRINH,
                                                                                NHOM_TINH_PHI: ct.NHOM_TINH_PHI,
                                                                                DO_TUOI: "",
                                                                                GIOI_TINH: gt.TEN_GIOI_TINH,
                                                                                PHAM_VI_DL: If(
                                                                                    ct.PHAM_VI_DL = true,
                                                                                    Datafield_PV.Selected.TEN_PHAMVI,
                                                                                    ""
                                                                                ),
                                                                                NGANH_NGHE: "",
                                                                                SO_TIEN: "",
                                                                                SO_NGUOI: sn.TEN_SO_NGUOI,
                                                                                THOI_HAN: "",
                                                                                PHUONG_THUC_DP: dp.TEN_PT
                                                                            }
                                                                        )
                                                                    ),
                                                                    Patch(
                                                                        DL_SAN_PHAM_MATRANPHI,
                                                                        Defaults(DL_SAN_PHAM_MATRANPHI),
                                                                        {ID: ct.ID,
                                                                            MA_SAN_PHAM: valMaSP,
                                                                            CHUONG_TRINH: ct.CHUONG_TRINH,
                                                                            NHOM_TINH_PHI: ct.NHOM_TINH_PHI,
                                                                            DO_TUOI: "",
                                                                            GIOI_TINH: gt.TEN_GIOI_TINH,
                                                                            PHAM_VI_DL: If(
                                                                                ct.PHAM_VI_DL = true,
                                                                                Datafield_PV.Selected.TEN_PHAMVI,
                                                                                ""
                                                                            ),
                                                                            NGANH_NGHE: "",
                                                                            SO_TIEN: "",
                                                                            SO_NGUOI: sn.TEN_SO_NGUOI,
                                                                            THOI_HAN: "",
                                                                            PHUONG_THUC_DP: ""
                                                                        }
                                                                    )
                                                                )
                                                            )
                                                        ),
                                                        If(
                                                            ct.BH_THOIHAN = true,
                                                            ForAll(
                                                                Datafield_TH.SelectedItems As th,
                                                                If(
                                                                    ct.BH_PHUONG_THUC = true,
                                                                    ForAll(
                                                                        Datafield_DP.SelectedItems As dp,
                                                                        Patch(
                                                                            DL_SAN_PHAM_MATRANPHI,
                                                                            Defaults(DL_SAN_PHAM_MATRANPHI),
                                                                            {ID: ct.ID,
                                                                                MA_SAN_PHAM: valMaSP,
                                                                                CHUONG_TRINH: ct.CHUONG_TRINH,
                                                                                NHOM_TINH_PHI: ct.NHOM_TINH_PHI,
                                                                                DO_TUOI: "",
                                                                                GIOI_TINH: gt.TEN_GIOI_TINH,
                                                                                PHAM_VI_DL: If(
                                                                                    ct.PHAM_VI_DL = true,
                                                                                    Datafield_PV.Selected.TEN_PHAMVI,
                                                                                    ""
                                                                                ),
                                                                                NGANH_NGHE: "",
                                                                                SO_TIEN: "",
                                                                                SO_NGUOI: "",
                                                                                THOI_HAN: th.TEN_THOI_HAN,
                                                                                PHUONG_THUC_DP: dp.TEN_PT
                                                                            }
                                                                        )
                                                                    ),
                                                                    Patch(
                                                                        DL_SAN_PHAM_MATRANPHI,
                                                                        Defaults(DL_SAN_PHAM_MATRANPHI),
                                                                        {ID: ct.ID,
                                                                            MA_SAN_PHAM: valMaSP,
                                                                            CHUONG_TRINH: ct.CHUONG_TRINH,
                                                                            NHOM_TINH_PHI: ct.NHOM_TINH_PHI,
                                                                            DO_TUOI: "",
                                                                            GIOI_TINH: gt.TEN_GIOI_TINH,
                                                                            PHAM_VI_DL: If(
                                                                                ct.PHAM_VI_DL = true,
                                                                                Datafield_PV.Selected.TEN_PHAMVI,
                                                                                ""
                                                                            ),
                                                                            NGANH_NGHE: "",
                                                                            SO_TIEN: "",
                                                                            SO_NGUOI: "",
                                                                            THOI_HAN: th.TEN_THOI_HAN,
                                                                            PHUONG_THUC_DP: ""
                                                                        }
                                                                    )
                                                                )
                                                            ),
                                                            If(
                                                                ct.BH_PHUONG_THUC = true,
                                                                ForAll(
                                                                    Datafield_DP.SelectedItems As dp,
                                                                    Patch(
                                                                        DL_SAN_PHAM_MATRANPHI,
                                                                        Defaults(DL_SAN_PHAM_MATRANPHI),
                                                                        {ID: ct.ID,
                                                                            MA_SAN_PHAM: valMaSP,
                                                                            CHUONG_TRINH: ct.CHUONG_TRINH,
                                                                            NHOM_TINH_PHI: ct.NHOM_TINH_PHI,
                                                                            DO_TUOI: "",
                                                                            GIOI_TINH: gt.TEN_GIOI_TINH,
                                                                            PHAM_VI_DL: If(
                                                                                ct.PHAM_VI_DL = true,
                                                                                Datafield_PV.Selected.TEN_PHAMVI,
                                                                                ""
                                                                            ),
                                                                            NGANH_NGHE: "",
                                                                            SO_TIEN: "",
                                                                            SO_NGUOI: "",
                                                                            THOI_HAN: "",
                                                                            PHUONG_THUC_DP: dp.TEN_PT
                                                                        }
                                                                    )
                                                                ),
                                                                Patch(
                                                                    DL_SAN_PHAM_MATRANPHI,
                                                                    Defaults(DL_SAN_PHAM_MATRANPHI),
                                                                    {ID: ct.ID,
                                                                        MA_SAN_PHAM: valMaSP,
                                                                        CHUONG_TRINH: ct.CHUONG_TRINH,
                                                                        NHOM_TINH_PHI: ct.NHOM_TINH_PHI,
                                                                        DO_TUOI: "",
                                                                        GIOI_TINH: gt.TEN_GIOI_TINH,
                                                                        PHAM_VI_DL: If(
                                                                            ct.PHAM_VI_DL = true,
                                                                            Datafield_PV.Selected.TEN_PHAMVI,
                                                                            ""
                                                                        ),
                                                                        NGANH_NGHE: "",
                                                                        SO_TIEN: "",
                                                                        SO_NGUOI: "",
                                                                        THOI_HAN: "",
                                                                        PHUONG_THUC_DP: ""
                                                                    }
                                                                )
                                                            )
                                                        )
                                                    )
                                                )
                                            )
                                        ),
                                        If(
                                            ct.NGANH_NGHE = true,
                                            ForAll(
                                                Datafield_NN.SelectedItems As nn,
                                                If(
                                                    ct.BH_SOTIEN = true,
                                                    ForAll(
                                                        Datafield_ST.SelectedItems As st,
                                                        If(
                                                            ct.BH_SONGUOI = true,
                                                            ForAll(
                                                                Datafield_SN.SelectedItems As sn,
                                                                If(
                                                                    ct.BH_THOIHAN = true,
                                                                    ForAll(
                                                                        Datafield_TH.SelectedItems As th,
                                                                        If(
                                                                            ct.BH_PHUONG_THUC = true,
                                                                            ForAll(
                                                                                Datafield_DP.SelectedItems As dp,
                                                                                Patch(
                                                                                    DL_SAN_PHAM_MATRANPHI,
                                                                                    Defaults(DL_SAN_PHAM_MATRANPHI),
                                                                                    {ID: ct.ID,
                                                                                        MA_SAN_PHAM: valMaSP,
                                                                                        CHUONG_TRINH: ct.CHUONG_TRINH,
                                                                                        NHOM_TINH_PHI: ct.NHOM_TINH_PHI,
                                                                                        DO_TUOI: "",
                                                                                        GIOI_TINH: "",
                                                                                        PHAM_VI_DL: If(
                                                                                            ct.PHAM_VI_DL = true,
                                                                                            Datafield_PV.Selected.TEN_PHAMVI,
                                                                                            ""
                                                                                        ),
                                                                                        NGANH_NGHE: nn.TEN_NGANH,
                                                                                        SO_TIEN: st.TEN_SOTIEN,
                                                                                        SO_NGUOI: sn.TEN_SO_NGUOI,
                                                                                        THOI_HAN: th.TEN_THOI_HAN,
                                                                                        PHUONG_THUC_DP: dp.TEN_PT
                                                                                    }
                                                                                )
                                                                            ),
                                                                            Patch(
                                                                                DL_SAN_PHAM_MATRANPHI,
                                                                                Defaults(DL_SAN_PHAM_MATRANPHI),
                                                                                {ID: ct.ID,
                                                                                    MA_SAN_PHAM: valMaSP,
                                                                                    CHUONG_TRINH: ct.CHUONG_TRINH,
                                                                                    NHOM_TINH_PHI: ct.NHOM_TINH_PHI,
                                                                                    DO_TUOI: "",
                                                                                    GIOI_TINH: "",
                                                                                    PHAM_VI_DL: If(
                                                                                        ct.PHAM_VI_DL = true,
                                                                                        Datafield_PV.Selected.TEN_PHAMVI,
                                                                                        ""
                                                                                    ),
                                                                                    NGANH_NGHE: nn.TEN_NGANH,
                                                                                    SO_TIEN: st.TEN_SOTIEN,
                                                                                    SO_NGUOI: sn.TEN_SO_NGUOI,
                                                                                    THOI_HAN: th.TEN_THOI_HAN,
                                                                                    PHUONG_THUC_DP: ""
                                                                                }
                                                                            )
                                                                        )
                                                                    ),
                                                                    If(
                                                                        ct.BH_PHUONG_THUC = true,
                                                                        ForAll(
                                                                            Datafield_DP.SelectedItems As dp,
                                                                            Patch(
                                                                                DL_SAN_PHAM_MATRANPHI,
                                                                                Defaults(DL_SAN_PHAM_MATRANPHI),
                                                                                {ID: ct.ID,
                                                                                    MA_SAN_PHAM: valMaSP,
                                                                                    CHUONG_TRINH: ct.CHUONG_TRINH,
                                                                                    NHOM_TINH_PHI: ct.NHOM_TINH_PHI,
                                                                                    DO_TUOI: "",
                                                                                    GIOI_TINH: "",
                                                                                    PHAM_VI_DL: If(
                                                                                        ct.PHAM_VI_DL = true,
                                                                                        Datafield_PV.Selected.TEN_PHAMVI,
                                                                                        ""
                                                                                    ),
                                                                                    NGANH_NGHE: nn.TEN_NGANH,
                                                                                    SO_TIEN: st.TEN_SOTIEN,
                                                                                    SO_NGUOI: sn.TEN_SO_NGUOI,
                                                                                    THOI_HAN: "",
                                                                                    PHUONG_THUC_DP: dp.TEN_PT
                                                                                }
                                                                            )
                                                                        ),
                                                                        Patch(
                                                                            DL_SAN_PHAM_MATRANPHI,
                                                                            Defaults(DL_SAN_PHAM_MATRANPHI),
                                                                            {ID: ct.ID,
                                                                                MA_SAN_PHAM: valMaSP,
                                                                                CHUONG_TRINH: ct.CHUONG_TRINH,
                                                                                NHOM_TINH_PHI: ct.NHOM_TINH_PHI,
                                                                                DO_TUOI: "",
                                                                                GIOI_TINH: "",
                                                                                PHAM_VI_DL: If(
                                                                                    ct.PHAM_VI_DL = true,
                                                                                    Datafield_PV.Selected.TEN_PHAMVI,
                                                                                    ""
                                                                                ),
                                                                                NGANH_NGHE: nn.TEN_NGANH,
                                                                                SO_TIEN: st.TEN_SOTIEN,
                                                                                SO_NGUOI: sn.TEN_SO_NGUOI,
                                                                                THOI_HAN: "",
                                                                                PHUONG_THUC_DP: ""
                                                                            }
                                                                        )
                                                                    )
                                                                )
                                                            ),
                                                            If(
                                                                ct.BH_THOIHAN = true,
                                                                ForAll(
                                                                    Datafield_TH.SelectedItems As th,
                                                                    If(
                                                                        ct.BH_PHUONG_THUC = true,
                                                                        ForAll(
                                                                            Datafield_DP.SelectedItems As dp,
                                                                            Patch(
                                                                                DL_SAN_PHAM_MATRANPHI,
                                                                                Defaults(DL_SAN_PHAM_MATRANPHI),
                                                                                {ID: ct.ID,
                                                                                    MA_SAN_PHAM: valMaSP,
                                                                                    CHUONG_TRINH: ct.CHUONG_TRINH,
                                                                                    NHOM_TINH_PHI: ct.NHOM_TINH_PHI,
                                                                                    DO_TUOI: "",
                                                                                    GIOI_TINH: "",
                                                                                    PHAM_VI_DL: If(
                                                                                        ct.PHAM_VI_DL = true,
                                                                                        Datafield_PV.Selected.TEN_PHAMVI,
                                                                                        ""
                                                                                    ),
                                                                                    NGANH_NGHE: nn.TEN_NGANH,
                                                                                    SO_TIEN: st.TEN_SOTIEN,
                                                                                    SO_NGUOI: "",
                                                                                    THOI_HAN: th.TEN_THOI_HAN,
                                                                                    PHUONG_THUC_DP: dp.TEN_PT
                                                                                }
                                                                            )
                                                                        ),
                                                                        Patch(
                                                                            DL_SAN_PHAM_MATRANPHI,
                                                                            Defaults(DL_SAN_PHAM_MATRANPHI),
                                                                            {ID: ct.ID,
                                                                                MA_SAN_PHAM: valMaSP,
                                                                                CHUONG_TRINH: ct.CHUONG_TRINH,
                                                                                NHOM_TINH_PHI: ct.NHOM_TINH_PHI,
                                                                                DO_TUOI: "",
                                                                                GIOI_TINH: "",
                                                                                PHAM_VI_DL: If(
                                                                                    ct.PHAM_VI_DL = true,
                                                                                    Datafield_PV.Selected.TEN_PHAMVI,
                                                                                    ""
                                                                                ),
                                                                                NGANH_NGHE: nn.TEN_NGANH,
                                                                                SO_TIEN: st.TEN_SOTIEN,
                                                                                SO_NGUOI: "",
                                                                                THOI_HAN: th.TEN_THOI_HAN,
                                                                                PHUONG_THUC_DP: ""
                                                                            }
                                                                        )
                                                                    )
                                                                ),
                                                                If(
                                                                    ct.BH_PHUONG_THUC = true,
                                                                    ForAll(
                                                                        Datafield_DP.SelectedItems As dp,
                                                                        Patch(
                                                                            DL_SAN_PHAM_MATRANPHI,
                                                                            Defaults(DL_SAN_PHAM_MATRANPHI),
                                                                            {ID: ct.ID,
                                                                                MA_SAN_PHAM: valMaSP,
                                                                                CHUONG_TRINH: ct.CHUONG_TRINH,
                                                                                NHOM_TINH_PHI: ct.NHOM_TINH_PHI,
                                                                                DO_TUOI: "",
                                                                                GIOI_TINH: "",
                                                                                PHAM_VI_DL: If(
                                                                                    ct.PHAM_VI_DL = true,
                                                                                    Datafield_PV.Selected.TEN_PHAMVI,
                                                                                    ""
                                                                                ),
                                                                                NGANH_NGHE: nn.TEN_NGANH,
                                                                                SO_TIEN: st.TEN_SOTIEN,
                                                                                SO_NGUOI: "",
                                                                                THOI_HAN: "",
                                                                                PHUONG_THUC_DP: dp.TEN_PT
                                                                            }
                                                                        )
                                                                    ),
                                                                    Patch(
                                                                        DL_SAN_PHAM_MATRANPHI,
                                                                        Defaults(DL_SAN_PHAM_MATRANPHI),
                                                                        {ID: ct.ID,
                                                                            MA_SAN_PHAM: valMaSP,
                                                                            CHUONG_TRINH: ct.CHUONG_TRINH,
                                                                            NHOM_TINH_PHI: ct.NHOM_TINH_PHI,
                                                                            DO_TUOI: "",
                                                                            GIOI_TINH: "",
                                                                            PHAM_VI_DL: If(
                                                                                ct.PHAM_VI_DL = true,
                                                                                Datafield_PV.Selected.TEN_PHAMVI,
                                                                                ""
                                                                            ),
                                                                            NGANH_NGHE: nn.TEN_NGANH,
                                                                            SO_TIEN: st.TEN_SOTIEN,
                                                                            SO_NGUOI: "",
                                                                            THOI_HAN: "",
                                                                            PHUONG_THUC_DP: ""
                                                                        }
                                                                    )
                                                                )
                                                            )
                                                        )
                                                    ),
                                                    If(
                                                        ct.BH_SONGUOI = true,
                                                        ForAll(
                                                            Datafield_SN.SelectedItems As sn,
                                                            If(
                                                                ct.BH_THOIHAN = true,
                                                                ForAll(
                                                                    Datafield_TH.SelectedItems As th,
                                                                    If(
                                                                        ct.BH_PHUONG_THUC = true,
                                                                        ForAll(
                                                                            Datafield_DP.SelectedItems As dp,
                                                                            Patch(
                                                                                DL_SAN_PHAM_MATRANPHI,
                                                                                Defaults(DL_SAN_PHAM_MATRANPHI),
                                                                                {ID: ct.ID,
                                                                                    MA_SAN_PHAM: valMaSP,
                                                                                    CHUONG_TRINH: ct.CHUONG_TRINH,
                                                                                    NHOM_TINH_PHI: ct.NHOM_TINH_PHI,
                                                                                    DO_TUOI: "",
                                                                                    GIOI_TINH: "",
                                                                                    PHAM_VI_DL: If(
                                                                                        ct.PHAM_VI_DL = true,
                                                                                        Datafield_PV.Selected.TEN_PHAMVI,
                                                                                        ""
                                                                                    ),
                                                                                    NGANH_NGHE: nn.TEN_NGANH,
                                                                                    SO_TIEN: "",
                                                                                    SO_NGUOI: sn.TEN_SO_NGUOI,
                                                                                    THOI_HAN: th.TEN_THOI_HAN,
                                                                                    PHUONG_THUC_DP: dp.TEN_PT
                                                                                }
                                                                            )
                                                                        ),
                                                                        Patch(
                                                                            DL_SAN_PHAM_MATRANPHI,
                                                                            Defaults(DL_SAN_PHAM_MATRANPHI),
                                                                            {ID: ct.ID,
                                                                                MA_SAN_PHAM: valMaSP,
                                                                                CHUONG_TRINH: ct.CHUONG_TRINH,
                                                                                NHOM_TINH_PHI: ct.NHOM_TINH_PHI,
                                                                                DO_TUOI: "",
                                                                                GIOI_TINH: "",
                                                                                PHAM_VI_DL: If(
                                                                                    ct.PHAM_VI_DL = true,
                                                                                    Datafield_PV.Selected.TEN_PHAMVI,
                                                                                    ""
                                                                                ),
                                                                                NGANH_NGHE: nn.TEN_NGANH,
                                                                                SO_TIEN: "",
                                                                                SO_NGUOI: sn.TEN_SO_NGUOI,
                                                                                THOI_HAN: th.TEN_THOI_HAN,
                                                                                PHUONG_THUC_DP: ""
                                                                            }
                                                                        )
                                                                    )
                                                                ),
                                                                If(
                                                                    ct.BH_PHUONG_THUC = true,
                                                                    ForAll(
                                                                        Datafield_DP.SelectedItems As dp,
                                                                        Patch(
                                                                            DL_SAN_PHAM_MATRANPHI,
                                                                            Defaults(DL_SAN_PHAM_MATRANPHI),
                                                                            {ID: ct.ID,
                                                                                MA_SAN_PHAM: valMaSP,
                                                                                CHUONG_TRINH: ct.CHUONG_TRINH,
                                                                                NHOM_TINH_PHI: ct.NHOM_TINH_PHI,
                                                                                DO_TUOI: "",
                                                                                GIOI_TINH: "",
                                                                                PHAM_VI_DL: If(
                                                                                    ct.PHAM_VI_DL = true,
                                                                                    Datafield_PV.Selected.TEN_PHAMVI,
                                                                                    ""
                                                                                ),
                                                                                NGANH_NGHE: nn.TEN_NGANH,
                                                                                SO_TIEN: "",
                                                                                SO_NGUOI: sn.TEN_SO_NGUOI,
                                                                                THOI_HAN: "",
                                                                                PHUONG_THUC_DP: dp.TEN_PT
                                                                            }
                                                                        )
                                                                    ),
                                                                    Patch(
                                                                        DL_SAN_PHAM_MATRANPHI,
                                                                        Defaults(DL_SAN_PHAM_MATRANPHI),
                                                                        {ID: ct.ID,
                                                                            MA_SAN_PHAM: valMaSP,
                                                                            CHUONG_TRINH: ct.CHUONG_TRINH,
                                                                            NHOM_TINH_PHI: ct.NHOM_TINH_PHI,
                                                                            DO_TUOI: "",
                                                                            GIOI_TINH: "",
                                                                            PHAM_VI_DL: If(
                                                                                ct.PHAM_VI_DL = true,
                                                                                Datafield_PV.Selected.TEN_PHAMVI,
                                                                                ""
                                                                            ),
                                                                            NGANH_NGHE: nn.TEN_NGANH,
                                                                            SO_TIEN: "",
                                                                            SO_NGUOI: sn.TEN_SO_NGUOI,
                                                                            THOI_HAN: "",
                                                                            PHUONG_THUC_DP: ""
                                                                        }
                                                                    )
                                                                )
                                                            )
                                                        ),
                                                        If(
                                                            ct.BH_THOIHAN = true,
                                                            ForAll(
                                                                Datafield_TH.SelectedItems As th,
                                                                If(
                                                                    ct.BH_PHUONG_THUC = true,
                                                                    ForAll(
                                                                        Datafield_DP.SelectedItems As dp,
                                                                        Patch(
                                                                            DL_SAN_PHAM_MATRANPHI,
                                                                            Defaults(DL_SAN_PHAM_MATRANPHI),
                                                                            {ID: ct.ID,
                                                                                MA_SAN_PHAM: valMaSP,
                                                                                CHUONG_TRINH: ct.CHUONG_TRINH,
                                                                                NHOM_TINH_PHI: ct.NHOM_TINH_PHI,
                                                                                DO_TUOI: "",
                                                                                GIOI_TINH: "",
                                                                                PHAM_VI_DL: If(
                                                                                    ct.PHAM_VI_DL = true,
                                                                                    Datafield_PV.Selected.TEN_PHAMVI,
                                                                                    ""
                                                                                ),
                                                                                NGANH_NGHE: nn.TEN_NGANH,
                                                                                SO_TIEN: "",
                                                                                SO_NGUOI: "",
                                                                                THOI_HAN: th.TEN_THOI_HAN,
                                                                                PHUONG_THUC_DP: dp.TEN_PT
                                                                            }
                                                                        )
                                                                    ),
                                                                    Patch(
                                                                        DL_SAN_PHAM_MATRANPHI,
                                                                        Defaults(DL_SAN_PHAM_MATRANPHI),
                                                                        {ID: ct.ID,
                                                                            MA_SAN_PHAM: valMaSP,
                                                                            CHUONG_TRINH: ct.CHUONG_TRINH,
                                                                            NHOM_TINH_PHI: ct.NHOM_TINH_PHI,
                                                                            DO_TUOI: "",
                                                                            GIOI_TINH: "",
                                                                            PHAM_VI_DL: If(
                                                                                ct.PHAM_VI_DL = true,
                                                                                Datafield_PV.Selected.TEN_PHAMVI,
                                                                                ""
                                                                            ),
                                                                            NGANH_NGHE: nn.TEN_NGANH,
                                                                            SO_TIEN: "",
                                                                            SO_NGUOI: "",
                                                                            THOI_HAN: th.TEN_THOI_HAN,
                                                                            PHUONG_THUC_DP: ""
                                                                        }
                                                                    )
                                                                )
                                                            ),
                                                            If(
                                                                ct.BH_PHUONG_THUC = true,
                                                                ForAll(
                                                                    Datafield_DP.SelectedItems As dp,
                                                                    Patch(
                                                                        DL_SAN_PHAM_MATRANPHI,
                                                                        Defaults(DL_SAN_PHAM_MATRANPHI),
                                                                        {ID: ct.ID,
                                                                            MA_SAN_PHAM: valMaSP,
                                                                            CHUONG_TRINH: ct.CHUONG_TRINH,
                                                                            NHOM_TINH_PHI: ct.NHOM_TINH_PHI,
                                                                            DO_TUOI: "",
                                                                            GIOI_TINH: "",
                                                                            PHAM_VI_DL: If(
                                                                                ct.PHAM_VI_DL = true,
                                                                                Datafield_PV.Selected.TEN_PHAMVI,
                                                                                ""
                                                                            ),
                                                                            NGANH_NGHE: nn.TEN_NGANH,
                                                                            SO_TIEN: "",
                                                                            SO_NGUOI: "",
                                                                            THOI_HAN: "",
                                                                            PHUONG_THUC_DP: dp.TEN_PT
                                                                        }
                                                                    )
                                                                ),
                                                                Patch(
                                                                    DL_SAN_PHAM_MATRANPHI,
                                                                    Defaults(DL_SAN_PHAM_MATRANPHI),
                                                                    {ID: ct.ID,
                                                                        MA_SAN_PHAM: valMaSP,
                                                                        CHUONG_TRINH: ct.CHUONG_TRINH,
                                                                        NHOM_TINH_PHI: ct.NHOM_TINH_PHI,
                                                                        DO_TUOI: "",
                                                                        GIOI_TINH: "",
                                                                        PHAM_VI_DL: If(
                                                                            ct.PHAM_VI_DL = true,
                                                                            Datafield_PV.Selected.TEN_PHAMVI,
                                                                            ""
                                                                        ),
                                                                        NGANH_NGHE: nn.TEN_NGANH,
                                                                        SO_TIEN: "",
                                                                        SO_NGUOI: "",
                                                                        THOI_HAN: "",
                                                                        PHUONG_THUC_DP: ""
                                                                    }
                                                                )
                                                            )
                                                        )
                                                    )
                                                )
                                            ),
                                            If(
                                                ct.BH_SOTIEN = true,
                                                ForAll(
                                                    Datafield_ST.SelectedItems As st,
                                                    If(
                                                        ct.BH_SONGUOI = true,
                                                        ForAll(
                                                            Datafield_SN.SelectedItems As sn,
                                                            If(
                                                                ct.BH_THOIHAN = true,
                                                                ForAll(
                                                                    Datafield_TH.SelectedItems As th,
                                                                    If(
                                                                        ct.BH_PHUONG_THUC = true,
                                                                        ForAll(
                                                                            Datafield_DP.SelectedItems As dp,
                                                                            Patch(
                                                                                DL_SAN_PHAM_MATRANPHI,
                                                                                Defaults(DL_SAN_PHAM_MATRANPHI),
                                                                                {ID: ct.ID,
                                                                                    MA_SAN_PHAM: valMaSP,
                                                                                    CHUONG_TRINH: ct.CHUONG_TRINH,
                                                                                    NHOM_TINH_PHI: ct.NHOM_TINH_PHI,
                                                                                    DO_TUOI: "",
                                                                                    GIOI_TINH: "",
                                                                                    PHAM_VI_DL: If(
                                                                                        ct.PHAM_VI_DL = true,
                                                                                        Datafield_PV.Selected.TEN_PHAMVI,
                                                                                        ""
                                                                                    ),
                                                                                    NGANH_NGHE: "",
                                                                                    SO_TIEN: st.TEN_SOTIEN,
                                                                                    SO_NGUOI: sn.TEN_SO_NGUOI,
                                                                                    THOI_HAN: th.TEN_THOI_HAN,
                                                                                    PHUONG_THUC_DP: dp.TEN_PT
                                                                                }
                                                                            )
                                                                        ),
                                                                        Patch(
                                                                            DL_SAN_PHAM_MATRANPHI,
                                                                            Defaults(DL_SAN_PHAM_MATRANPHI),
                                                                            {ID: ct.ID,
                                                                                MA_SAN_PHAM: valMaSP,
                                                                                CHUONG_TRINH: ct.CHUONG_TRINH,
                                                                                NHOM_TINH_PHI: ct.NHOM_TINH_PHI,
                                                                                DO_TUOI: "",
                                                                                GIOI_TINH: "",
                                                                                PHAM_VI_DL: If(
                                                                                    ct.PHAM_VI_DL = true,
                                                                                    Datafield_PV.Selected.TEN_PHAMVI,
                                                                                    ""
                                                                                ),
                                                                                NGANH_NGHE: "",
                                                                                SO_TIEN: st.TEN_SOTIEN,
                                                                                SO_NGUOI: sn.TEN_SO_NGUOI,
                                                                                THOI_HAN: th.TEN_THOI_HAN,
                                                                                PHUONG_THUC_DP: ""
                                                                            }
                                                                        )
                                                                    )
                                                                ),
                                                                If(
                                                                    ct.BH_PHUONG_THUC = true,
                                                                    ForAll(
                                                                        Datafield_DP.SelectedItems As dp,
                                                                        Patch(
                                                                            DL_SAN_PHAM_MATRANPHI,
                                                                            Defaults(DL_SAN_PHAM_MATRANPHI),
                                                                            {ID: ct.ID,
                                                                                MA_SAN_PHAM: valMaSP,
                                                                                CHUONG_TRINH: ct.CHUONG_TRINH,
                                                                                NHOM_TINH_PHI: ct.NHOM_TINH_PHI,
                                                                                DO_TUOI: "",
                                                                                GIOI_TINH: "",
                                                                                PHAM_VI_DL: If(
                                                                                    ct.PHAM_VI_DL = true,
                                                                                    Datafield_PV.Selected.TEN_PHAMVI,
                                                                                    ""
                                                                                ),
                                                                                NGANH_NGHE: "",
                                                                                SO_TIEN: st.TEN_SOTIEN,
                                                                                SO_NGUOI: sn.TEN_SO_NGUOI,
                                                                                THOI_HAN: "",
                                                                                PHUONG_THUC_DP: dp.TEN_PT
                                                                            }
                                                                        )
                                                                    ),
                                                                    Patch(
                                                                        DL_SAN_PHAM_MATRANPHI,
                                                                        Defaults(DL_SAN_PHAM_MATRANPHI),
                                                                        {ID: ct.ID,
                                                                            MA_SAN_PHAM: valMaSP,
                                                                            CHUONG_TRINH: ct.CHUONG_TRINH,
                                                                            NHOM_TINH_PHI: ct.NHOM_TINH_PHI,
                                                                            DO_TUOI: "",
                                                                            GIOI_TINH: "",
                                                                            PHAM_VI_DL: If(
                                                                                ct.PHAM_VI_DL = true,
                                                                                Datafield_PV.Selected.TEN_PHAMVI,
                                                                                ""
                                                                            ),
                                                                            NGANH_NGHE: "",
                                                                            SO_TIEN: st.TEN_SOTIEN,
                                                                            SO_NGUOI: sn.TEN_SO_NGUOI,
                                                                            THOI_HAN: "",
                                                                            PHUONG_THUC_DP: ""
                                                                        }
                                                                    )
                                                                )
                                                            )
                                                        ),
                                                        If(
                                                            ct.BH_THOIHAN = true,
                                                            ForAll(
                                                                Datafield_TH.SelectedItems As th,
                                                                If(
                                                                    ct.BH_PHUONG_THUC = true,
                                                                    ForAll(
                                                                        Datafield_DP.SelectedItems As dp,
                                                                        Patch(
                                                                            DL_SAN_PHAM_MATRANPHI,
                                                                            Defaults(DL_SAN_PHAM_MATRANPHI),
                                                                            {ID: ct.ID,
                                                                                MA_SAN_PHAM: valMaSP,
                                                                                CHUONG_TRINH: ct.CHUONG_TRINH,
                                                                                NHOM_TINH_PHI: ct.NHOM_TINH_PHI,
                                                                                DO_TUOI: "",
                                                                                GIOI_TINH: "",
                                                                                PHAM_VI_DL: If(
                                                                                    ct.PHAM_VI_DL = true,
                                                                                    Datafield_PV.Selected.TEN_PHAMVI,
                                                                                    ""
                                                                                ),
                                                                                NGANH_NGHE: "",
                                                                                SO_TIEN: st.TEN_SOTIEN,
                                                                                SO_NGUOI: "",
                                                                                THOI_HAN: th.TEN_THOI_HAN,
                                                                                PHUONG_THUC_DP: dp.TEN_PT
                                                                            }
                                                                        )
                                                                    ),
                                                                    Patch(
                                                                        DL_SAN_PHAM_MATRANPHI,
                                                                        Defaults(DL_SAN_PHAM_MATRANPHI),
                                                                        {ID: ct.ID,
                                                                            MA_SAN_PHAM: valMaSP,
                                                                            CHUONG_TRINH: ct.CHUONG_TRINH,
                                                                            NHOM_TINH_PHI: ct.NHOM_TINH_PHI,
                                                                            DO_TUOI: "",
                                                                            GIOI_TINH: "",
                                                                            PHAM_VI_DL: If(
                                                                                ct.PHAM_VI_DL = true,
                                                                                Datafield_PV.Selected.TEN_PHAMVI,
                                                                                ""
                                                                            ),
                                                                            NGANH_NGHE: "",
                                                                            SO_TIEN: st.TEN_SOTIEN,
                                                                            SO_NGUOI: "",
                                                                            THOI_HAN: th.TEN_THOI_HAN,
                                                                            PHUONG_THUC_DP: ""
                                                                        }
                                                                    )
                                                                )
                                                            ),
                                                            If(
                                                                ct.BH_PHUONG_THUC = true,
                                                                ForAll(
                                                                    Datafield_DP.SelectedItems As dp,
                                                                    Patch(
                                                                        DL_SAN_PHAM_MATRANPHI,
                                                                        Defaults(DL_SAN_PHAM_MATRANPHI),
                                                                        {ID: ct.ID,
                                                                            MA_SAN_PHAM: valMaSP,
                                                                            CHUONG_TRINH: ct.CHUONG_TRINH,
                                                                            NHOM_TINH_PHI: ct.NHOM_TINH_PHI,
                                                                            DO_TUOI: "",
                                                                            GIOI_TINH: "",
                                                                            PHAM_VI_DL: If(
                                                                                ct.PHAM_VI_DL = true,
                                                                                Datafield_PV.Selected.TEN_PHAMVI,
                                                                                ""
                                                                            ),
                                                                            NGANH_NGHE: "",
                                                                            SO_TIEN: st.TEN_SOTIEN,
                                                                            SO_NGUOI: "",
                                                                            THOI_HAN: "",
                                                                            PHUONG_THUC_DP: dp.TEN_PT
                                                                        }
                                                                    )
                                                                ),
                                                                Patch(
                                                                    DL_SAN_PHAM_MATRANPHI,
                                                                    Defaults(DL_SAN_PHAM_MATRANPHI),
                                                                    {ID: ct.ID,
                                                                        MA_SAN_PHAM: valMaSP,
                                                                        CHUONG_TRINH: ct.CHUONG_TRINH,
                                                                        NHOM_TINH_PHI: ct.NHOM_TINH_PHI,
                                                                        DO_TUOI: "",
                                                                        GIOI_TINH: "",
                                                                        PHAM_VI_DL: If(
                                                                            ct.PHAM_VI_DL = true,
                                                                            Datafield_PV.Selected.TEN_PHAMVI,
                                                                            ""
                                                                        ),
                                                                        NGANH_NGHE: "",
                                                                        SO_TIEN: st.TEN_SOTIEN,
                                                                        SO_NGUOI: "",
                                                                        THOI_HAN: "",
                                                                        PHUONG_THUC_DP: ""
                                                                    }
                                                                )
                                                            )
                                                        )
                                                    )
                                                ),
                                                If(
                                                    ct.BH_SONGUOI = true,
                                                    ForAll(
                                                        Datafield_SN.SelectedItems As sn,
                                                        If(
                                                            ct.BH_THOIHAN = true,
                                                            ForAll(
                                                                Datafield_TH.SelectedItems As th,
                                                                If(
                                                                    ct.BH_PHUONG_THUC = true,
                                                                    ForAll(
                                                                        Datafield_DP.SelectedItems As dp,
                                                                        Patch(
                                                                            DL_SAN_PHAM_MATRANPHI,
                                                                            Defaults(DL_SAN_PHAM_MATRANPHI),
                                                                            {ID: ct.ID,
                                                                                MA_SAN_PHAM: valMaSP,
                                                                                CHUONG_TRINH: ct.CHUONG_TRINH,
                                                                                NHOM_TINH_PHI: ct.NHOM_TINH_PHI,
                                                                                DO_TUOI: "",
                                                                                GIOI_TINH: "",
                                                                                PHAM_VI_DL: If(
                                                                                    ct.PHAM_VI_DL = true,
                                                                                    Datafield_PV.Selected.TEN_PHAMVI,
                                                                                    ""
                                                                                ),
                                                                                NGANH_NGHE: "",
                                                                                SO_TIEN: "",
                                                                                SO_NGUOI: sn.TEN_SO_NGUOI,
                                                                                THOI_HAN: th.TEN_THOI_HAN,
                                                                                PHUONG_THUC_DP: dp.TEN_PT
                                                                            }
                                                                        )
                                                                    ),
                                                                    Patch(
                                                                        DL_SAN_PHAM_MATRANPHI,
                                                                        Defaults(DL_SAN_PHAM_MATRANPHI),
                                                                        {ID: ct.ID,
                                                                            MA_SAN_PHAM: valMaSP,
                                                                            CHUONG_TRINH: ct.CHUONG_TRINH,
                                                                            NHOM_TINH_PHI: ct.NHOM_TINH_PHI,
                                                                            DO_TUOI: "",
                                                                            GIOI_TINH: "",
                                                                            PHAM_VI_DL: If(
                                                                                ct.PHAM_VI_DL = true,
                                                                                Datafield_PV.Selected.TEN_PHAMVI,
                                                                                ""
                                                                            ),
                                                                            NGANH_NGHE: "",
                                                                            SO_TIEN: "",
                                                                            SO_NGUOI: sn.TEN_SO_NGUOI,
                                                                            THOI_HAN: th.TEN_THOI_HAN,
                                                                            PHUONG_THUC_DP: ""
                                                                        }
                                                                    )
                                                                )
                                                            ),
                                                            If(
                                                                ct.BH_PHUONG_THUC = true,
                                                                ForAll(
                                                                    Datafield_DP.SelectedItems As dp,
                                                                    Patch(
                                                                        DL_SAN_PHAM_MATRANPHI,
                                                                        Defaults(DL_SAN_PHAM_MATRANPHI),
                                                                        {ID: ct.ID,
                                                                            MA_SAN_PHAM: valMaSP,
                                                                            CHUONG_TRINH: ct.CHUONG_TRINH,
                                                                            NHOM_TINH_PHI: ct.NHOM_TINH_PHI,
                                                                            DO_TUOI: "",
                                                                            GIOI_TINH: "",
                                                                            PHAM_VI_DL: If(
                                                                                ct.PHAM_VI_DL = true,
                                                                                Datafield_PV.Selected.TEN_PHAMVI,
                                                                                ""
                                                                            ),
                                                                            NGANH_NGHE: "",
                                                                            SO_TIEN: "",
                                                                            SO_NGUOI: sn.TEN_SO_NGUOI,
                                                                            THOI_HAN: "",
                                                                            PHUONG_THUC_DP: dp.TEN_PT
                                                                        }
                                                                    )
                                                                ),
                                                                Patch(
                                                                    DL_SAN_PHAM_MATRANPHI,
                                                                    Defaults(DL_SAN_PHAM_MATRANPHI),
                                                                    {ID: ct.ID,
                                                                        MA_SAN_PHAM: valMaSP,
                                                                        CHUONG_TRINH: ct.CHUONG_TRINH,
                                                                        NHOM_TINH_PHI: ct.NHOM_TINH_PHI,
                                                                        DO_TUOI: "",
                                                                        GIOI_TINH: "",
                                                                        PHAM_VI_DL: If(
                                                                            ct.PHAM_VI_DL = true,
                                                                            Datafield_PV.Selected.TEN_PHAMVI,
                                                                            ""
                                                                        ),
                                                                        NGANH_NGHE: "",
                                                                        SO_TIEN: "",
                                                                        SO_NGUOI: sn.TEN_SO_NGUOI,
                                                                        THOI_HAN: "",
                                                                        PHUONG_THUC_DP: ""
                                                                    }
                                                                )
                                                            )
                                                        )
                                                    ),
                                                    If(
                                                        ct.BH_THOIHAN = true,
                                                        ForAll(
                                                            Datafield_TH.SelectedItems As th,
                                                            If(
                                                                ct.BH_PHUONG_THUC = true,
                                                                ForAll(
                                                                    Datafield_DP.SelectedItems As dp,
                                                                    Patch(
                                                                        DL_SAN_PHAM_MATRANPHI,
                                                                        Defaults(DL_SAN_PHAM_MATRANPHI),
                                                                        {ID: ct.ID,
                                                                            MA_SAN_PHAM: valMaSP,
                                                                            CHUONG_TRINH: ct.CHUONG_TRINH,
                                                                            NHOM_TINH_PHI: ct.NHOM_TINH_PHI,
                                                                            DO_TUOI: "",
                                                                            GIOI_TINH: "",
                                                                            PHAM_VI_DL: If(
                                                                                ct.PHAM_VI_DL = true,
                                                                                Datafield_PV.Selected.TEN_PHAMVI,
                                                                                ""
                                                                            ),
                                                                            NGANH_NGHE: "",
                                                                            SO_TIEN: "",
                                                                            SO_NGUOI: "",
                                                                            THOI_HAN: th.TEN_THOI_HAN,
                                                                            PHUONG_THUC_DP: dp.TEN_PT
                                                                        }
                                                                    )
                                                                ),
                                                                Patch(
                                                                    DL_SAN_PHAM_MATRANPHI,
                                                                    Defaults(DL_SAN_PHAM_MATRANPHI),
                                                                    {ID: ct.ID,
                                                                        MA_SAN_PHAM: valMaSP,
                                                                        CHUONG_TRINH: ct.CHUONG_TRINH,
                                                                        NHOM_TINH_PHI: ct.NHOM_TINH_PHI,
                                                                        DO_TUOI: "",
                                                                        GIOI_TINH: "",
                                                                        PHAM_VI_DL: If(
                                                                            ct.PHAM_VI_DL = true,
                                                                            Datafield_PV.Selected.TEN_PHAMVI,
                                                                            ""
                                                                        ),
                                                                        NGANH_NGHE: "",
                                                                        SO_TIEN: "",
                                                                        SO_NGUOI: "",
                                                                        THOI_HAN: th.TEN_THOI_HAN,
                                                                        PHUONG_THUC_DP: ""
                                                                    }
                                                                )
                                                            )
                                                        ),
                                                        If(
                                                            ct.BH_PHUONG_THUC = true,
                                                            ForAll(
                                                                Datafield_DP.SelectedItems As dp,
                                                                Patch(
                                                                    DL_SAN_PHAM_MATRANPHI,
                                                                    Defaults(DL_SAN_PHAM_MATRANPHI),
                                                                    {ID: ct.ID,
                                                                        MA_SAN_PHAM: valMaSP,
                                                                        CHUONG_TRINH: ct.CHUONG_TRINH,
                                                                        NHOM_TINH_PHI: ct.NHOM_TINH_PHI,
                                                                        DO_TUOI: "",
                                                                        GIOI_TINH: "",
                                                                        PHAM_VI_DL: If(
                                                                            ct.PHAM_VI_DL = true,
                                                                            Datafield_PV.Selected.TEN_PHAMVI,
                                                                            ""
                                                                        ),
                                                                        NGANH_NGHE: "",
                                                                        SO_TIEN: "",
                                                                        SO_NGUOI: "",
                                                                        THOI_HAN: "",
                                                                        PHUONG_THUC_DP: dp.TEN_PT
                                                                    }
                                                                )
                                                            ),
                                                            Patch(
                                                                DL_SAN_PHAM_MATRANPHI,
                                                                Defaults(DL_SAN_PHAM_MATRANPHI),
                                                                {ID: ct.ID,
                                                                    MA_SAN_PHAM: valMaSP,
                                                                    CHUONG_TRINH: ct.CHUONG_TRINH,
                                                                    NHOM_TINH_PHI: ct.NHOM_TINH_PHI,
                                                                    DO_TUOI: "",
                                                                    GIOI_TINH: "",
                                                                    PHAM_VI_DL: If(
                                                                        ct.PHAM_VI_DL = true,
                                                                        Datafield_PV.Selected.TEN_PHAMVI,
                                                                        ""
                                                                    ),
                                                                    NGANH_NGHE: "",
                                                                    SO_TIEN: "",
                                                                    SO_NGUOI: "",
                                                                    THOI_HAN: "",
                                                                    PHUONG_THUC_DP: ""
                                                                }
                                                            )
                                                        )
                                                    )
                                                )
                                            )
                                        )
                                    )
                                )
                            )
                        );
                    Text: ="Lưu yếu tố"
                    X: =1047
                    Y: =471
                    ZIndex: =14

                Label1_6 As label:
                    Align: =Align.Justify
                    FontWeight: =FontWeight.Bold
                    Size: =16
                    Text: ="4.1.2. Bảng thông tin "
                    Width: =1207
                    ZIndex: =15

                Label_sn As label:
                    Height: =44
                    Text: |-
                        ="Số người 
                        được BH"
                    Visible: =showGrid
                    Width: =95
                    X: =801
                    Y: =122
                    ZIndex: =16

        DataCard4 As dataCard.blankCard:
            BorderColor: =RGBA(0, 0, 0, 1)
            BorderStyle: =BorderStyle.Solid
            DisplayMode: =DisplayMode.Edit
            Fill: =RGBA(0, 0, 0, 0)
            Height: =561
            Width: =1366
            X: =0
            Y: =3
            ZIndex: =4

            "'2. Dieukhoanchung' As groupContainer.manualLayoutContainer":
                Height: =555
                Width: =1213
                X: =150
                ZIndex: =1

                GalleryCT_1 As gallery.galleryVertical:
                    DelayItemLoading: =true
                    Height: =415
                    Items: =tmpDKCCollect
                    Layout: =Layout.Vertical
                    LoadingSpinner: =LoadingSpinner.Data
                    NavigationStep: =0
                    TemplateSize: =40
                    Width: =1218
                    Y: =134
                    ZIndex: =1

                    TxtThongTin As text:
                        BorderColor: =RGBA(72, 163, 62, 1)
                        Default: =ThisItem.cr282_thong_tin
                        DisabledBorderColor: =RGBA(180, 214, 250, 1)
                        DisabledColor: =RGBA(0, 0, 0, 1)
                        DisabledFill: =RGBA(255, 255, 255, 1)
                        DisplayMode: =If(ThisItem.edited=0,DisplayMode.Disabled,DisplayMode.Edit) 
                        OnChange: =
                        OnSelect: =Select(Parent)
                        Width: =215
                        X: =305
                        ZIndex: =9

                    Btn_SuaCT_1 As button:
                        OnSelect: |-
                            =If(
                                Or(maAddedDKC<>"",maUpdatedDKC<>""),
                                Notify("Có dữ liệu chưa được lưu",NotificationType.Warning,800),
                                UpdateIf(
                                    tmpDKCCollect,
                                    cr282_id_dkc=ThisItem.cr282_id_dkc,
                                    {
                                        edited:1
                                    }
                                );
                                UpdateContext({
                                    maUpdated:ThisItem.cr282_id_dkc
                                })
                            )
                        Text: ="Sửa"
                        Visible: =ThisItem.edited=0
                        Width: =75
                        X: =1035
                        ZIndex: =17

                    Btn_XoaCT_1 As button:
                        OnSelect: |-
                            =If(
                                Or(maAddedDKC<>"",maUpdatedDKC<>""),
                                Notify("Có dữ liệu chưa được lưu",NotificationType.Warning,800),
                                Refresh(DL_SAN_PHAM_DKCHUNGS);
                                RemoveIf(
                                    DL_SAN_PHAM_DKCHUNGS,
                                    id_dkc=ThisItem.cr282_id_dkc
                                );
                                Remove(tmpDKCCollect,ThisItem);
                                Notify("Xóa dữ liệu thành công", NotificationType.Success,800) 
                            )
                        Text: ="Xóa"
                        Visible: =ThisItem.edited=0
                        Width: =85
                        X: =1123
                        ZIndex: =18

                    Btn_LuuCT_1 As button:
                        OnSelect: |
                            =
                                If( ThisItem.cr282_id_dkc=maAddedDKC,
                                    Patch(
                                        DL_SAN_PHAM_DKCHUNGS,
                                        {
                                            id_dkc:ThisItem.cr282_id_dkc,
                                            ma_san_pham:valMaSP,
                                            nhom_thong_tin:CbxNhomTT.Selected.Value,
                                            thong_tin:TxtThongTin.Text,
                                            noi_dung:TxtND.Text
                                        }
                                    ),
                                    UpdateIf(
                                         DL_SAN_PHAM_DKCHUNGS,
                                        id_dkc=ThisItem.cr282_id_dkc,
                                        {
                                            nhom_thong_tin:CbxNhomTT.Selected.Value,
                                            ma_san_pham:valMaSP,
                                            thong_tin:TxtThongTin.Text,
                                            noi_dung:TxtND.Text
                                        }
                                    )
                                );
                                UpdateIf(
                                    tmpDKCCollect,
                                    cr282_id_dkc=ThisItem.cr282_id_dkc,
                                    {
                                        cr282_nhom_thong_tin:CbxNhomTT.Selected.Value,
                                        cr282_thong_tin:TxtThongTin.Text,
                                        cr282_noi_dung:TxtND.Text,
                                        edited:0
                                    }
                                );
                                Notify("Lưu dữ liệu thành công", NotificationType.Success,800);
                                ClearCollect(
                                    tmpDKCCollect,
                                    ShowColumns(
                                        AddColumns(
                                            SortByColumns(
                                                Filter(DL_SAN_PHAM_DKCHUNGS,ma_san_pham=valMaSP),
                                                "cr282_id_dkc",
                                                SortOrder.Ascending
                                            ),
                                            "edited",
                                            0
                                        ),
                                        "cr282_id_dkc",
                                        "cr282_ma_san_pham",
                                        "cr282_nhom_thong_tin",
                                        "cr282_thong_tin",
                                        "cr282_noi_dung",
                                        "edited"
                                    )
                                );
                                UpdateContext({
                                    maAddedDKC:"",
                                    maUpdatedDKC:""
                                });
                        Text: ="Lưu"
                        Visible: =ThisItem.edited=1
                        Width: =75
                        X: =1035
                        ZIndex: =19

                    Btn_HuyCT_1 As button:
                        OnSelect: |-
                            =If(
                                ThisItem.cr282_id_dkc=maAddedDKC,
                                Remove(tmpDKCCollect,ThisItem),
                                UpdateIf(
                                    tmpDKCCollect,
                                    cr282_id_dkc=ThisItem.cr282_id_dkc,
                                    {
                                        edited:0
                                    }
                                )
                            );
                             Set(   maAddedDKC, "");
                              Set(  maUpdatedDKC,"");
                        Text: ="Hủy"
                        Visible: =ThisItem.edited=1
                        Width: =85
                        X: =1123
                        ZIndex: =20

                    TxtID_DKC As text:
                        BorderColor: =RGBA(72, 163, 62, 1)
                        Default: =ThisItem.cr282_id_dkc
                        DisabledBorderColor: =RGBA(180, 214, 250, 1)
                        DisabledColor: =RGBA(0, 0, 0, 1)
                        DisabledFill: =RGBA(255, 255, 255, 1)
                        DisplayMode: =If(ThisItem.edited=0,DisplayMode.Disabled,DisplayMode.Edit) 
                        OnChange: =
                        OnSelect: =Select(Parent)
                        Visible: =false
                        Width: =134
                        X: =3
                        ZIndex: =21

                    TxtND As text:
                        BorderColor: =RGBA(72, 163, 62, 1)
                        Default: =ThisItem.cr282_noi_dung
                        DisabledBorderColor: =RGBA(180, 214, 250, 1)
                        DisabledColor: =RGBA(0, 0, 0, 1)
                        DisabledFill: =RGBA(255, 255, 255, 1)
                        DisplayMode: =If(ThisItem.edited=0,DisplayMode.Disabled,DisplayMode.Edit) 
                        OnChange: =
                        OnSelect: =Select(Parent)
                        Width: =490
                        X: =532
                        ZIndex: =22

                    CbxNhomTT As combobox:
                        BorderColor: =RGBA(72, 163, 62, 1)
                        ChevronBackground: =RGBA(255, 255, 255, 1)
                        ChevronDisabledBackground: =RGBA(180, 214, 250, 1)
                        ChevronDisabledFill: =RGBA(255, 255, 255, 1)
                        ChevronFill: =RGBA(72, 163, 62, 1)
                        ChevronHoverBackground: =RGBA(255, 255, 255, 1)
                        ChevronHoverFill: =RGBA(72, 163, 62, 1)
                        DefaultSelectedItems: =If(IsBlank(ThisItem.cr282_nhom_thong_tin),Blank(),LookUp(dsNhomTT,Value=Value(ThisItem.cr282_nhom_thong_tin)))
                        DisabledBorderColor: =RGBA(180, 214, 250, 1)
                        DisabledColor: =RGBA(0, 0, 0, 1)
                        DisabledFill: =RGBA(255, 255, 255, 1)
                        DisplayFields: =["Key"]
                        DisplayMode: =If(ThisItem.edited=0,DisplayMode.Disabled,DisplayMode.Edit) 
                        HoverBorderColor: =RGBA(9, 33, 98, 1)
                        HoverFill: =RGBA(180, 214, 250, 1)
                        InputTextPlaceholder: ="Chọn đơn vị tuổi"
                        IsSearchable: =false
                        Items: =SortByColumns(dsNhomTT,"Value",SortOrder.Ascending)
                        OnSelect: =Select(Parent)
                        PressedColor: =RGBA(72, 163, 62, 1)
                        PressedFill: =RGBA(255, 255, 255, 1)
                        SearchFields: =["Key"]
                        SearchItems: =[]
                        SelectionColor: =RGBA(0, 0, 0, 1)
                        SelectionFill: =RGBA(214, 221, 224, 1)
                        SelectMultiple: =false
                        Width: =290
                        X: =3
                        ZIndex: =24

                BadgeCanvas1_11 As Badge:
                    BasePaletteColor: =
                    Content: =""
                    DisplayMode: =DisplayMode.Edit
                    FontColor: =
                    Height: =32
                    Visible: =true
                    Width: =1218
                    X: =0
                    Y: =100
                    ZIndex: =2

                TextCanvas2_54 As Text:
                    DisplayMode: =DisplayMode.Edit
                    FontColor: =
                    Height: =38
                    Size: =14
                    Text: ="Thông tin"
                    Weight: ='TextCanvas.Weight'.Bold
                    Width: =185
                    X: =305
                    Y: =98
                    ZIndex: =3

                TextCanvas2_57 As Text:
                    DisplayMode: =DisplayMode.Edit
                    FontColor: =
                    Height: =34
                    Size: =14
                    Text: ="Nội dung"
                    Weight: ='TextCanvas.Weight'.Bold
                    Width: =96
                    X: =540
                    Y: =101
                    ZIndex: =4

                TextCanvas2_56 As Text:
                    DisplayMode: =DisplayMode.Edit
                    FontColor: =
                    Height: =34
                    Size: =14
                    Text: ="Thao tác"
                    Weight: ='TextCanvas.Weight'.Bold
                    Width: =96
                    X: =1089
                    Y: =100
                    ZIndex: =5

                TextCanvas2_55 As Text:
                    DisplayMode: =DisplayMode.Edit
                    FontColor: =
                    Height: =39
                    Size: =14
                    Text: ="Nhóm thông tin"
                    Weight: ='TextCanvas.Weight'.Bold
                    Width: =162
                    X: =13
                    Y: =100
                    ZIndex: =10

                ThemMoiCT_1 As button:
                    Height: =36
                    OnSelect: |
                        =If( Or(maAddedDKC<>"",maUpdatedDKC<>""),
                            Notify("Có dữ liệu chưa được lưu",NotificationType.Warning,800),
                            UpdateContext({
                                idMa:If(
                                    CountRows(tmpDKCCollect) = 0,
                                    1000,
                                    Max(DL_SAN_PHAM_DKCHUNGS, id_dkc) + 1
                                )
                            });
                            Collect(
                                tmpDKCCollect,
                                {
                                    cr282_id_dkc:Text(idMa),
                                    cr282_ma_san_pham:valMaSP,
                                    cr282_nhom_thong_tin:"",
                                    cr282_thong_tin:"",
                                    cr282_noi_dung:"",
                                    edited:1
                                }
                            );
                          UpdateContext({maAddedDKC:Text(idMa)})
                        )
                    Text: ="Thêm mới"
                    Y: =48
                    ZIndex: =11

                Label1_4 As label:
                    Align: =Align.Justify
                    FontWeight: =FontWeight.Bold
                    Height: =44
                    Size: =16
                    Text: ="2. Điều khoản chung (Trừ quyền lợi, phí)"
                    Width: =1076
                    Y: =4
                    ZIndex: =13

        DataCard5 As dataCard.blankCard:
            BorderColor: =RGBA(0, 0, 0, 1)
            BorderStyle: =BorderStyle.Solid
            DisplayMode: =DisplayMode.Edit
            Fill: =RGBA(0, 0, 0, 0)
            Height: =765
            Width: =1366
            X: =0
            Y: =4
            ZIndex: =5

            "'4.2Giamtruphi_1' As groupContainer.manualLayoutContainer":
                Height: =442
                Width: =1208
                X: =155
                Y: =20
                ZIndex: =1

                GalleryCT_2 As gallery.galleryVertical:
                    DelayItemLoading: =true
                    Height: =303
                    Items: =tmpGPCCollect
                    Layout: =Layout.Vertical
                    LoadingSpinner: =LoadingSpinner.Data
                    NavigationStep: =0
                    TemplateSize: =40
                    Width: =1218
                    Y: =139
                    ZIndex: =1

                    Btn_SuaCT_2 As button:
                        OnSelect: |-
                            =If(
                                Or(maAddedGP<>"",maUpdatedGP<>""),
                                Notify("Có dữ liệu chưa được lưu",NotificationType.Warning,800),
                                UpdateIf(
                                    tmpGPCCollect,
                                    cr282_id_giamphi=ThisItem.cr282_id_giamphi,
                                    {
                                        edited:1
                                    }
                                );
                                UpdateContext({
                                    maUpdatedGP:ThisItem.cr282_id_giamphi
                                })
                            )
                        Text: ="Sửa"
                        Visible: =ThisItem.edited=0
                        Width: =75
                        X: =1035
                        ZIndex: =17

                    Btn_XoaCT_2 As button:
                        OnSelect: |-
                            =If(
                                Or(maAddedGP<>"",maUpdatedGP<>""),
                                Notify("Có dữ liệu chưa được lưu",NotificationType.Warning,800),
                                Refresh(DL_SAN_PHAM_GPS);
                                RemoveIf(
                                    DL_SAN_PHAM_GPS,
                                    ID_GIAMPHI=ThisItem.cr282_id_giamphi
                                );
                                Remove(tmpGPCCollect,ThisItem);
                                Notify("Xóa dữ liệu thành công", NotificationType.Success,800) 
                            )
                        Text: ="Xóa"
                        Visible: =ThisItem.edited=0
                        Width: =85
                        X: =1123
                        ZIndex: =18

                    Btn_LuuCT_2 As button:
                        OnSelect: |
                            =
                                If( ThisItem.cr282_id_giamphi=maAddedGP,
                                    Patch(
                                        DL_SAN_PHAM_GPS,
                                        {
                                            ID_GIAMPHI:ThisItem.cr282_id_giamphi,
                                            MA_SAN_PHAM:valMaSP,
                                            THONG_TIN:TxtThongtin.Text,
                                            MO_TA:TxtMota_1.Text,
                                            SO_TIEN:Value(TxtSo_tien_1.Text),
                                            DONVI_TIEN: TxtDonvi_tien_1.Text,
                                            TY_LE:TxtTy_le_1.Text
                                        }
                                    ),
                                    UpdateIf(
                                        DL_SAN_PHAM_GPS,
                                        ID_GIAMPHI=ThisItem.cr282_id_giamphi,
                                        {
                                            THONG_TIN:TxtThongtin.Text,
                                            MA_SAN_PHAM:valMaSP,
                                            MO_TA:TxtMota_1.Text,
                                            SO_TIEN:Value(TxtSo_tien_1.Text),
                                            DONVI_TIEN: TxtDonvi_tien_1.Text,
                                            TY_LE:TxtTy_le_1.Text
                                        }
                                    )
                                );
                                UpdateIf(
                                    tmpGPCCollect,
                                    cr282_id_giamphi=ThisItem.cr282_id_giamphi,
                                    {
                                            cr282_thong_tin:TxtThongtin.Text,
                                            cr282_mo_ta:TxtMota_1.Text,
                                            cr282_so_tien:Value(TxtSo_tien_1.Text),
                                            cr282_donvi_tien: TxtDonvi_tien_1.Text,
                                            cr282_ty_le:TxtTy_le_1.Text,
                                        edited:0
                                    }
                                );
                                Notify("Lưu dữ liệu thành công", NotificationType.Success,800);
                                ClearCollect(
                                    tmpGPCCollect,
                                    ShowColumns(
                                        AddColumns(
                                            SortByColumns(
                                                Filter(DL_SAN_PHAM_GPS,MA_SAN_PHAM=valMaSP),
                                                "cr282_id_giamphi",
                                                SortOrder.Ascending
                                            ),
                                            "edited",
                                            0
                                        ),
                                    "cr282_id_giamphi",
                                    "cr282_ma_san_pham",
                                    "cr282_thong_tin",
                                    "cr282_mo_ta",
                                    "cr282_so_tien",
                                    "cr282_donvi_tien",
                                    "cr282_ty_le",
                                    "edited"
                                    )
                                );
                                UpdateContext({
                                    maAddedGP:"",
                                    maUpdatedGP:""
                                });
                        Text: ="Lưu"
                        Visible: =ThisItem.edited=1
                        Width: =75
                        X: =1035
                        ZIndex: =19

                    Btn_HuyCT_2 As button:
                        OnSelect: |-
                            =If(
                                ThisItem.cr282_id_giamphi=maAddedGP,
                                Remove(tmpGPCCollect,ThisItem),
                                UpdateIf(
                                    tmpGPCCollect,
                                    cr282_id_giamphi=ThisItem.cr282_id_giamphi,
                                    {
                                        edited:0
                                    }
                                )
                            );
                             Set(   maAddedGP, "");
                              Set(  maUpdated,"");
                        Text: ="Hủy"
                        Visible: =ThisItem.edited=1
                        Width: =85
                        X: =1123
                        ZIndex: =20

                    TxtID_GP_1 As text:
                        BorderColor: =RGBA(72, 163, 62, 1)
                        Default: =ThisItem.cr282_id_giamphi
                        DisabledBorderColor: =RGBA(180, 214, 250, 1)
                        DisabledColor: =RGBA(0, 0, 0, 1)
                        DisabledFill: =RGBA(255, 255, 255, 1)
                        DisplayMode: =If(ThisItem.edited=0,DisplayMode.Disabled,DisplayMode.Edit) 
                        OnChange: =
                        OnSelect: =Select(Parent)
                        Visible: =false
                        Width: =134
                        X: =3
                        ZIndex: =21

                    TxtThongtin As text:
                        BorderColor: =RGBA(72, 163, 62, 1)
                        Default: =ThisItem.cr282_thong_tin
                        DisabledBorderColor: =RGBA(180, 214, 250, 1)
                        DisabledColor: =RGBA(0, 0, 0, 1)
                        DisabledFill: =RGBA(255, 255, 255, 1)
                        DisplayMode: =If(ThisItem.edited=0,DisplayMode.Disabled,DisplayMode.Edit) 
                        OnChange: =
                        OnSelect: =Select(Parent)
                        Width: =205
                        X: =3
                        ZIndex: =22

                    TxtMota_1 As text:
                        BorderColor: =RGBA(72, 163, 62, 1)
                        Default: =ThisItem.cr282_mo_ta
                        DisabledBorderColor: =RGBA(180, 214, 250, 1)
                        DisabledColor: =RGBA(0, 0, 0, 1)
                        DisabledFill: =RGBA(255, 255, 255, 1)
                        DisplayMode: =If(ThisItem.edited=0,DisplayMode.Disabled,DisplayMode.Edit) 
                        OnChange: =
                        OnSelect: =Select(Parent)
                        Width: =227
                        X: =219
                        ZIndex: =23

                    TxtSo_tien_1 As text:
                        BorderColor: =RGBA(72, 163, 62, 1)
                        Default: =ThisItem.cr282_so_tien
                        DisabledBorderColor: =RGBA(180, 214, 250, 1)
                        DisabledColor: =RGBA(0, 0, 0, 1)
                        DisabledFill: =RGBA(255, 255, 255, 1)
                        DisplayMode: =If(ThisItem.edited=0,DisplayMode.Disabled,DisplayMode.Edit) 
                        Format: =TextFormat.Number
                        OnChange: =
                        OnSelect: =Select(Parent)
                        Width: =127
                        X: =457
                        ZIndex: =24

                    TxtDonvi_tien_1 As text:
                        BorderColor: =RGBA(72, 163, 62, 1)
                        Default: =ThisItem.cr282_donvi_tien
                        DisabledBorderColor: =RGBA(180, 214, 250, 1)
                        DisabledColor: =RGBA(0, 0, 0, 1)
                        DisabledFill: =RGBA(255, 255, 255, 1)
                        DisplayMode: =If(ThisItem.edited=0,DisplayMode.Disabled,DisplayMode.Edit) 
                        OnChange: =
                        OnSelect: =Select(Parent)
                        Width: =191
                        X: =595
                        ZIndex: =25

                    TxtTy_le_1 As text:
                        BorderColor: =RGBA(72, 163, 62, 1)
                        Default: =ThisItem.cr282_ty_le
                        DisabledBorderColor: =RGBA(180, 214, 250, 1)
                        DisabledColor: =RGBA(0, 0, 0, 1)
                        DisabledFill: =RGBA(255, 255, 255, 1)
                        DisplayMode: =If(ThisItem.edited=0,DisplayMode.Disabled,DisplayMode.Edit) 
                        OnChange: =
                        OnSelect: =Select(Parent)
                        Width: =191
                        X: =800
                        ZIndex: =26

                BadgeCanvas1_12 As Badge:
                    BasePaletteColor: =
                    Content: =""
                    DisplayMode: =DisplayMode.Edit
                    FontColor: =
                    Height: =30
                    Visible: =true
                    Width: =1197
                    X: =0
                    Y: =102
                    ZIndex: =2

                TextCanvas2_58 As Text:
                    DisplayMode: =DisplayMode.Edit
                    FontColor: =
                    Height: =38
                    Size: =14
                    Text: ="Thông tin"
                    Weight: ='TextCanvas.Weight'.Bold
                    Width: =185
                    X: =19
                    Y: =98
                    ZIndex: =3

                TextCanvas2_61 As Text:
                    DisplayMode: =DisplayMode.Edit
                    FontColor: =
                    Height: =34
                    Size: =14
                    Text: ="Mô tả"
                    Weight: ='TextCanvas.Weight'.Bold
                    Width: =96
                    X: =224
                    Y: =98
                    ZIndex: =4

                TextCanvas2_63 As Text:
                    DisplayMode: =DisplayMode.Edit
                    FontColor: =
                    Height: =34
                    Size: =14
                    Text: ="Thao tác"
                    Weight: ='TextCanvas.Weight'.Bold
                    Width: =96
                    X: =1089
                    Y: =100
                    ZIndex: =5

                ThemMoiCT_2 As button:
                    Height: =36
                    OnSelect: |
                        =If( Or(maAddedGP<>"",maUpdatedGP<>""),
                            Notify("Có dữ liệu chưa được lưu",NotificationType.Warning,800),
                            UpdateContext({
                                idMa:If(
                                    CountRows(tmpGPCCollect) = 0,
                                    1000,
                                    Max(DL_SAN_PHAM_GPS, ID_GIAMPHI) + 1
                                )
                            });
                            Collect(
                                tmpGPCCollect,
                                {
                                    cr282_id_giamphi:Text(idMa),
                                    cr282_ma_san_pham:valMaSP,
                                    cr282_thong_tin:"",
                                    cr282_mo_ta:"",
                                    cr282_so_tien:0,
                                    cr282_donvi_tien:"",
                                    cr282_donvi_ty_le:"",
                                    edited:1
                                }
                            );
                          UpdateContext({maAddedGP:Text(idMa)})
                        )
                    Text: ="Thêm mới"
                    Y: =48
                    ZIndex: =11

                Label1_7 As label:
                    Align: =Align.Justify
                    FontWeight: =FontWeight.Bold
                    Height: =44
                    Size: =16
                    Text: ="4.2. Thông tin giảm trừ phí"
                    Width: =1076
                    Y: =4
                    ZIndex: =13

                TextCanvas2_64 As Text:
                    DisplayMode: =DisplayMode.Edit
                    FontColor: =
                    Height: =34
                    Size: =14
                    Text: ="Số tiền"
                    Weight: ='TextCanvas.Weight'.Bold
                    Width: =96
                    X: =464
                    Y: =102
                    ZIndex: =14

                TextCanvas2_65 As Text:
                    DisplayMode: =DisplayMode.Edit
                    FontColor: =
                    Height: =34
                    Size: =14
                    Text: ="Đơn vị tiền"
                    Weight: ='TextCanvas.Weight'.Bold
                    Width: =96
                    X: =598
                    Y: =102
                    ZIndex: =15

                TextCanvas2_62 As Text:
                    DisplayMode: =DisplayMode.Edit
                    FontColor: =
                    Height: =34
                    Size: =14
                    Text: ="Tỷ lệ"
                    Weight: ='TextCanvas.Weight'.Bold
                    Width: =96
                    X: =799
                    Y: =99
                    ZIndex: =16

        DataCard6 As dataCard.blankCard:
            BorderColor: =RGBA(0, 0, 0, 1)
            BorderStyle: =BorderStyle.Solid
            DisplayMode: =DisplayMode.Edit
            Fill: =RGBA(0, 0, 0, 0)
            Height: =1000
            Width: =1366
            X: =0
            Y: =5
            ZIndex: =6

            ContainerNQLSP As groupContainer.manualLayoutContainer:
                Height: =404
                Width: =1288
                X: =78
                Y: =4
                ZIndex: =1

                GalleryNQLSP As gallery.galleryVertical:
                    DelayItemLoading: =true
                    Height: =265
                    Items: =SortByColumns(tmpNQLSPCollect,"cr282_ma_dl",SortOrder.Ascending)
                    Layout: =Layout.Vertical
                    LoadingSpinner: =LoadingSpinner.Data
                    NavigationStep: =0
                    TemplateSize: =41
                    Width: =1273
                    X: =5
                    Y: =139
                    ZIndex: =1

                    IconXoaNQLSP As icon.Trash:
                        Color: =RGBA(233, 79, 76, 1)
                        Height: =40
                        Icon: =Icon.Trash
                        OnSelect: |-
                            =If(
                                Or(maAddedNQLSP<>"",maUpdatedNQLSP<>""),
                                Notify("Có dữ liệu chưa được lưu",NotificationType.Warning,800),
                                Refresh(DL_SAN_PHAM_QLCT_CHONS);
                                RemoveIf(
                                    DL_SAN_PHAM_QLCT_CHONS,
                                    MA_NHOMQL_SP=ThisItem.cr282_ma_dl
                                );
                                ClearCollect(
                                    tmpQLCTTBCollect,
                                    ShowColumns(
                                        SortByColumns(
                                            DL_SAN_PHAM_QLCT_CHONS,
                                            "cr282_ma_ql_chitiet",
                                            SortOrder.Ascending
                                        ),
                                        "cr282_ma_ql_chitiet",
                                        "cr282_ma_nhomql_sp",
                                        "cr282_ten_hien_thi"
                                    )
                                );
                                Refresh(DL_SAN_PHAM_NHOMQLS);
                                RemoveIf(
                                    DL_SAN_PHAM_NHOMQLS,
                                    MA_DL=ThisItem.cr282_ma_dl
                                );
                                Remove(tmpNQLSPCollect,ThisItem);
                                Notify("Xóa dữ liệu thành công", NotificationType.Success,800)
                            )
                        Tooltip: ="Xóa"
                        Visible: =ThisItem.edited=0
                        Width: =37
                        X: =1218
                        ZIndex: =7

                    IconSuaNQLSP As icon.Edit:
                        Color: =RGBA(83, 144, 164, 1)
                        Height: =40
                        Icon: =Icon.Edit
                        OnSelect: |-
                            =If(
                                Or(maAddedNQLSP<>"",maUpdatedNQLSP<>""),
                                Notify("Có dữ liệu chưa được lưu",NotificationType.Warning,800),
                                UpdateIf(
                                    tmpNQLSPCollect,
                                    cr282_ma_dl=ThisItem.cr282_ma_dl,
                                    {
                                        edited:1
                                    }
                                );
                                UpdateContext({
                                    maUpdatedNQLSP:ThisItem.cr282_ma_dl
                                })
                            )
                        Tooltip: ="Sửa"
                        Visible: =ThisItem.edited=0
                        Width: =29
                        X: =1189
                        ZIndex: =14

                    IconLuuNQLSP As icon.Save:
                        Color: =RGBA(72, 163, 62, 1)
                        Height: =40
                        Icon: =Icon.Save
                        OnSelect: |
                            =If(
                                IsBlank(CbxNhomQLNQLSP.Selected.MA_NHOM_QL),
                                Notify("Bắt buộc nhập nhóm tính phí", NotificationType.Error,800),
                                IsBlank(CbxLoaiNQLSP.Selected.Value),
                                Notify("Bắt buộc nhập loại", NotificationType.Error,800),
                                IsBlank(CbxNhomTPNQLSP.Selected.Ma),
                                Notify("Bắt buộc nhập nhóm tính phí", NotificationType.Error,800),
                                IsBlank(CbxCTADNQLSP.Selected.Ma),
                                Notify("Bắt buộc nhập chương trình áp dụng", NotificationType.Error,800),
                                CountIf(DL_SAN_PHAM_NHOMQLS,MA_SP="1000" && MA_NHOM_QL=CbxNhomQLNQLSP.Selected.MA_NHOM_QL)>0,
                                Notify("Đã tồn tại nhóm quyền lợi này trong sản phẩm", NotificationType.Error,800),
                                If(
                                    ThisItem.cr282_ma_dl=maAddedNQLSP,
                                    Patch(
                                        DL_SAN_PHAM_NHOMQLS,
                                        {
                                            MA_DL:ThisItem.cr282_ma_dl,
                                            CHUONGTRINH_APDUNG:Concat(CbxCTADNQLSP.SelectedItems,Ma,"|"),
                                            LOAI:CbxLoaiNQLSP.Selected.Value,
                                            MA_NHOM_QL:CbxNhomQLNQLSP.Selected.MA_NHOM_QL,
                                            PHAMVI_DIALY:CbxPVDLNQLSP.Selected.MA_PHAMVI,
                                            MA_NHOM_TINHPHI:CbxNhomTPNQLSP.Selected.Ma,
                                            MA_SP:"1000",
                                            TEN_HIEN_THI:If(IsBlank(TextTenHTNQLSP.Text),LookUp(DM_NHOM_QUYENLOIS,MA_NHOM_QL=CbxNhomQLNQLSP.Selected.MA_NHOM_QL,TEN_NHOM_QL),TextTenHTNQLSP.Text)
                                        }
                                    ),
                                    UpdateIf(
                                        DL_SAN_PHAM_NHOMQLS,
                                        MA_DL=ThisItem.cr282_ma_dl,
                                        {
                                            CHUONGTRINH_APDUNG:CbxCTADNQLSP.Selected.Ma,
                                            LOAI:CbxLoaiNQLSP.Selected.Value,
                                            MA_NHOM_QL:CbxNhomQLNQLSP.Selected.MA_NHOM_QL,
                                            PHAMVI_DIALY:CbxPVDLNQLSP.Selected.MA_PHAMVI,
                                            MA_NHOM_TINHPHI:CbxNhomTPNQLSP.Selected.Ma,
                                            MA_SP:"1000",
                                            TEN_HIEN_THI:If(IsBlank(TextTenHTNQLSP.Text),LookUp(DM_NHOM_QUYENLOIS,MA_NHOM_QL=CbxNhomQLNQLSP.Selected.MA_NHOM_QL,TEN_NHOM_QL),TextTenHTNQLSP.Text)
                                        }
                                    )
                                );
                                UpdateIf(
                                    tmpNQLSPCollect,
                                    cr282_ma_dl=ThisItem.cr282_ma_dl,
                                    {
                                        cr282_ma_dl:ThisItem.cr282_ma_dl,
                                        cr282_chuongtrinh_apdung:CbxCTADNQLSP.Selected.Ma,
                                        cr282_loai:CbxLoaiNQLSP.Selected.Value,
                                        cr282_ma_nhom_ql:CbxNhomQLNQLSP.Selected.MA_NHOM_QL,
                                        cr282_phamvi_dialy:CbxPVDLNQLSP.Selected.MA_PHAMVI,
                                        cr282_ma_nhom_tinhphi:CbxNhomTPNQLSP.Selected.Ma,
                                        cr282_ten_hien_thi:If(IsBlank(TextTenHTNQLSP.Text),LookUp(DM_NHOM_QUYENLOIS,MA_NHOM_QL=CbxNhomQLNQLSP.Selected.MA_NHOM_QL,TEN_NHOM_QL),TextTenHTNQLSP.Text),
                                        cr282_ma_sp:"1000",
                                        edited:0
                                    }
                                );
                                Notify("Lưu dữ liệu thành công", NotificationType.Success,800);
                                ClearCollect(
                                    tmpNQLSPCollect,
                                    ShowColumns(
                                        AddColumns(
                                            SortByColumns(
                                                DL_SAN_PHAM_NHOMQLS,
                                                "cr282_ma_dl",
                                                SortOrder.Ascending
                                            ),
                                            "edited",
                                            0
                                        ),
                                        "cr282_ma_dl",
                                        "cr282_chuongtrinh_apdung",
                                        "cr282_loai",
                                        "cr282_ma_nhom_ql",
                                        "cr282_ma_nhom_tinhphi",
                                        "cr282_ma_sp",
                                        "cr282_phamvi_dialy",
                                        "cr282_ten_hien_thi",
                                        "edited"
                                    )
                                );
                                UpdateContext({
                                    maAddedNQLSP:"",
                                    maUpdatedNQLSP:""
                                });
                                Reset(TextFilterNQLSP); Reset(CbxFilterNQLSP);Reset(CbxFilterValueNQLSP1);Reset(CbxFilterValueNQLSP)
                            )
                        Tooltip: ="Lưu"
                        Visible: =ThisItem.edited=1
                        Width: =33
                        X: =1187
                        ZIndex: =15

                    IconHuyNQLSP As icon.CancelBadge:
                        Color: =RGBA(139, 154, 159, 1)
                        Height: =40
                        Icon: =Icon.CancelBadge
                        OnSelect: |-
                            =If(
                                ThisItem.cr282_ma_dl=maAddedNQLSP,
                                Remove(tmpNQLSPCollect,ThisItem),
                                UpdateIf(
                                    tmpNQLSPCollect,
                                    cr282_ma_dl=ThisItem.cr282_ma_dl,
                                    {
                                        edited:0
                                    }
                                )
                            );
                            UpdateContext({
                                maAddedNQLSP:"",
                                maUpdatedNQLSP:""
                            });
                        Tooltip: ="Hủy"
                        Visible: =ThisItem.edited=1
                        Width: =28
                        X: =1225
                        ZIndex: =16

                    CbxNhomTPNQLSP As combobox:
                        BorderColor: =RGBA(72, 163, 62, 1)
                        ChevronBackground: =RGBA(255, 255, 255, 1)
                        ChevronDisabledBackground: =RGBA(180, 214, 250, 1)
                        ChevronDisabledFill: =RGBA(255, 255, 255, 1)
                        ChevronFill: =RGBA(72, 163, 62, 1)
                        ChevronHoverBackground: =RGBA(255, 255, 255, 1)
                        ChevronHoverFill: =RGBA(72, 163, 62, 1)
                        DefaultSelectedItems: =LookUp(DL_NhomTPS,Ma=ThisItem.cr282_ma_nhom_tinhphi)
                        DisabledBorderColor: =RGBA(180, 214, 250, 1)
                        DisabledColor: =RGBA(0, 0, 0, 1)
                        DisabledFill: =RGBA(255, 255, 255, 1)
                        DisplayFields: =["cr282_ten"]
                        DisplayMode: =If(ThisItem.edited=0,DisplayMode.Disabled,DisplayMode.Edit) 
                        HoverBorderColor: =RGBA(9, 33, 98, 1)
                        HoverFill: =RGBA(180, 214, 250, 1)
                        InputTextPlaceholder: ="Chọn nhóm quyền lợi"
                        IsSearchable: =false
                        Items: =SortByColumns(DL_NhomTPS,"cr282_ma",SortOrder.Ascending)
                        OnSelect: =Select(Parent)
                        PressedColor: =RGBA(72, 163, 62, 1)
                        PressedFill: =RGBA(255, 255, 255, 1)
                        SearchFields: =["cr282_ten"]
                        SearchItems: =[]
                        SelectionColor: =RGBA(0, 0, 0, 1)
                        SelectionFill: =RGBA(214, 221, 224, 1)
                        SelectMultiple: =false
                        Width: =172
                        X: =586
                        ZIndex: =19

                    CbxNhomQLNQLSP As combobox:
                        BorderColor: =RGBA(72, 163, 62, 1)
                        ChevronBackground: =RGBA(255, 255, 255, 1)
                        ChevronDisabledBackground: =RGBA(180, 214, 250, 1)
                        ChevronDisabledFill: =RGBA(255, 255, 255, 1)
                        ChevronFill: =RGBA(72, 163, 62, 1)
                        ChevronHoverBackground: =RGBA(255, 255, 255, 1)
                        ChevronHoverFill: =RGBA(72, 163, 62, 1)
                        DefaultSelectedItems: =LookUp(DM_NHOM_QUYENLOIS,MA_NHOM_QL=ThisItem.cr282_ma_nhom_ql)
                        DisabledBorderColor: =RGBA(180, 214, 250, 1)
                        DisabledColor: =RGBA(0, 0, 0, 1)
                        DisabledFill: =RGBA(255, 255, 255, 1)
                        DisplayFields: =["cr282_ten_nhom_ql"]
                        DisplayMode: =If(ThisItem.cr282_ma_dl=maAddedNQLSP,DisplayMode.Edit,DisplayMode.Disabled) 
                        HoverBorderColor: =RGBA(9, 33, 98, 1)
                        HoverFill: =RGBA(180, 214, 250, 1)
                        InputTextPlaceholder: ="Chọn nhóm quyền lợi"
                        IsSearchable: =false
                        Items: =SortByColumns(DM_NHOM_QUYENLOIS,"cr282_ma_nhom_ql",SortOrder.Ascending)
                        OnSelect: =Select(Parent)
                        PressedColor: =RGBA(72, 163, 62, 1)
                        PressedFill: =RGBA(255, 255, 255, 1)
                        SearchFields: =["cr282_ten_nhom_ql"]
                        SearchItems: =[]
                        SelectionColor: =RGBA(0, 0, 0, 1)
                        SelectionFill: =RGBA(214, 221, 224, 1)
                        SelectMultiple: =false
                        Width: =182
                        X: =11
                        ZIndex: =22

                    CbxLoaiNQLSP As combobox:
                        BorderColor: =RGBA(72, 163, 62, 1)
                        ChevronBackground: =RGBA(255, 255, 255, 1)
                        ChevronDisabledBackground: =RGBA(180, 214, 250, 1)
                        ChevronDisabledFill: =RGBA(255, 255, 255, 1)
                        ChevronFill: =RGBA(72, 163, 62, 1)
                        ChevronHoverBackground: =RGBA(255, 255, 255, 1)
                        ChevronHoverFill: =RGBA(72, 163, 62, 1)
                        DefaultSelectedItems: =LookUp(["Chính","Bổ sung"],Value=ThisItem.cr282_loai)
                        DisabledBorderColor: =RGBA(180, 214, 250, 1)
                        DisabledColor: =RGBA(0, 0, 0, 1)
                        DisabledFill: =RGBA(255, 255, 255, 1)
                        DisplayFields: =["Value"]
                        DisplayMode: =If(ThisItem.edited=0,DisplayMode.Disabled,DisplayMode.Edit) 
                        HoverBorderColor: =RGBA(9, 33, 98, 1)
                        HoverFill: =RGBA(180, 214, 250, 1)
                        InputTextPlaceholder: ="Chọn nhóm quyền lợi"
                        IsSearchable: =false
                        Items: =["Chính","Bổ sung"]
                        OnSelect: =Select(Parent)
                        PressedColor: =RGBA(72, 163, 62, 1)
                        PressedFill: =RGBA(255, 255, 255, 1)
                        SearchFields: =["Value"]
                        SearchItems: =[]
                        SelectionColor: =RGBA(0, 0, 0, 1)
                        SelectionFill: =RGBA(214, 221, 224, 1)
                        SelectMultiple: =false
                        Width: =135
                        X: =199
                        ZIndex: =24

                    TextTenHTNQLSP As text:
                        BorderColor: =RGBA(72, 163, 62, 1)
                        Default: =ThisItem.cr282_ten_hien_thi
                        DisabledBorderColor: =RGBA(180, 214, 250, 1)
                        DisabledColor: =RGBA(0, 0, 0, 1)
                        DisabledFill: =RGBA(255, 255, 255, 1)
                        DisplayMode: =If(ThisItem.edited=0,DisplayMode.Disabled,DisplayMode.Edit)
                        OnChange: =
                        OnSelect: =Select(Parent)
                        Width: =240
                        X: =340
                        ZIndex: =25

                    CbxPVDLNQLSP As combobox:
                        BorderColor: =RGBA(72, 163, 62, 1)
                        ChevronBackground: =RGBA(255, 255, 255, 1)
                        ChevronDisabledBackground: =RGBA(180, 214, 250, 1)
                        ChevronDisabledFill: =RGBA(255, 255, 255, 1)
                        ChevronFill: =RGBA(72, 163, 62, 1)
                        ChevronHoverBackground: =RGBA(255, 255, 255, 1)
                        ChevronHoverFill: =RGBA(72, 163, 62, 1)
                        DefaultSelectedItems: =LookUp(DM_PHAMVI_DIALYS,MA_PHAMVI=ThisItem.cr282_phamvi_dialy)
                        DisabledBorderColor: =RGBA(180, 214, 250, 1)
                        DisabledColor: =RGBA(0, 0, 0, 1)
                        DisabledFill: =RGBA(255, 255, 255, 1)
                        DisplayFields: =["cr282_ten_phamvi"]
                        DisplayMode: =If(ThisItem.edited=0,DisplayMode.Disabled,DisplayMode.Edit) 
                        HoverBorderColor: =RGBA(9, 33, 98, 1)
                        HoverFill: =RGBA(180, 214, 250, 1)
                        InputTextPlaceholder: ="Chọn nhóm quyền lợi"
                        IsSearchable: =false
                        Items: =SortByColumns(DM_PHAMVI_DIALYS,"cr282_ma_phamvi",SortOrder.Ascending)
                        OnSelect: =Select(Parent)
                        PressedColor: =RGBA(72, 163, 62, 1)
                        PressedFill: =RGBA(255, 255, 255, 1)
                        SearchFields: =["cr282_ten_phamvi"]
                        SearchItems: =[]
                        SelectionColor: =RGBA(0, 0, 0, 1)
                        SelectionFill: =RGBA(214, 221, 224, 1)
                        SelectMultiple: =false
                        Width: =178
                        X: =764
                        ZIndex: =26

                    CbxCTADNQLSP As combobox:
                        BorderColor: =RGBA(72, 163, 62, 1)
                        ChevronBackground: =RGBA(255, 255, 255, 1)
                        ChevronDisabledBackground: =RGBA(180, 214, 250, 1)
                        ChevronDisabledFill: =RGBA(255, 255, 255, 1)
                        ChevronFill: =RGBA(72, 163, 62, 1)
                        ChevronHoverBackground: =RGBA(255, 255, 255, 1)
                        ChevronHoverFill: =RGBA(72, 163, 62, 1)
                        DefaultSelectedItems: =Filter(DL_CTADS,Ma in Split(ThisItem.cr282_chuongtrinh_apdung,"|"))
                        DisabledBorderColor: =RGBA(180, 214, 250, 1)
                        DisabledColor: =RGBA(0, 0, 0, 1)
                        DisabledFill: =RGBA(255, 255, 255, 1)
                        DisplayFields: =["cr282_tenct"]
                        DisplayMode: =If(ThisItem.edited=0,DisplayMode.Disabled,DisplayMode.Edit) 
                        HoverBorderColor: =RGBA(9, 33, 98, 1)
                        HoverFill: =RGBA(180, 214, 250, 1)
                        InputTextPlaceholder: ="Chọn nhóm quyền lợi"
                        IsSearchable: =false
                        Items: =SortByColumns(DL_CTADS,"cr282_ma",SortOrder.Ascending)
                        OnSelect: =Select(Parent)
                        PressedColor: =RGBA(72, 163, 62, 1)
                        PressedFill: =RGBA(255, 255, 255, 1)
                        SearchFields: =["cr282_tenct"]
                        SearchItems: =[]
                        SelectionColor: =RGBA(0, 0, 0, 1)
                        SelectionFill: =RGBA(214, 221, 224, 1)
                        Tooltip: =Concat(Filter(DL_CTADS,!IsBlank(Find(Ma,ThisItem.cr282_chuongtrinh_apdung))),TenCT,", ")
                        Width: =187
                        X: =948
                        ZIndex: =27

                    IconCTNQLSP As icon.DetailList:
                        Color: =RGBA(72, 163, 62, 1)
                        Height: =40
                        Icon: =Icon.DetailList
                        OnSelect: |-
                            =Navigate(DLSanPhamQLCT);
                            Set(maDLNhomQLFwd,ThisItem.cr282_ma_dl);
                            Set(maNQLFwd,CbxNhomQLNQLSP.Selected.MA_NHOM_QL)
                        Tooltip: ="Nhập chi tiết"
                        Visible: =ThisItem.edited=0
                        Width: =30
                        X: =1148
                        ZIndex: =28

                BadgeCanvas1_13 As Badge:
                    BasePaletteColor: =
                    Content: =""
                    DisplayMode: =DisplayMode.Edit
                    FontColor: =
                    Height: =38
                    Width: =1132
                    X: =17
                    Y: =97
                    ZIndex: =2

                TextCanvas2_48 As Text:
                    DisplayMode: =DisplayMode.Edit
                    FontColor: =
                    Height: =38
                    Size: =14
                    Text: ="Nhóm quyền lợi"
                    Weight: ='TextCanvas.Weight'.Bold
                    Width: =121
                    X: =28
                    Y: =97
                    ZIndex: =4

                TextCanvas2_49 As Text:
                    DisplayMode: =DisplayMode.Edit
                    FontColor: =
                    Height: =38
                    Size: =14
                    Text: ="Tên hiển thị"
                    Weight: ='TextCanvas.Weight'.Bold
                    Width: =88
                    X: =348
                    Y: =97
                    ZIndex: =5

                TextCanvas2_47 As Text:
                    DisplayMode: =DisplayMode.Edit
                    FontColor: =
                    Height: =36
                    Size: =14
                    Text: ="Chương trình áp dụng"
                    Weight: ='TextCanvas.Weight'.Bold
                    Width: =162
                    X: =962
                    Y: =98
                    ZIndex: =6

                "TextFilterNQLSP As 'Text input'":
                    BasePaletteColor: =
                    DisplayMode: =DisplayMode.Edit
                    FontColor: =
                    Height: =43
                    OnChange: =
                    Placeholder: ="Nhập giá trị lọc"
                    Visible: =false
                    Width: =204
                    X: =509
                    Y: =35
                    ZIndex: =7

                IconTaiLaiNQLSP As icon.Sync:
                    Color: =RGBA(83, 144, 164, 1)
                    Height: =36
                    Icon: =Icon.Sync
                    OnSelect: |-
                        =ClearCollect(
                            tmpNQLSPCollect,
                            ShowColumns(
                                AddColumns(
                                    SortByColumns(
                                        Filter(
                                            DL_SAN_PHAM_NHOMQLS,
                                            MA_SP="1000"
                                        ),
                                        "cr282_ma_dl",
                                        SortOrder.Ascending
                                    ),
                                    "edited",
                                    0
                                ),
                                "cr282_ma_dl",
                                "cr282_chuongtrinh_apdung",
                                "cr282_loai",
                                "cr282_ma_nhom_ql",
                                "cr282_ma_nhom_tinhphi",
                                "cr282_ma_sp",
                                "cr282_phamvi_dialy",
                                "cr282_ten_hien_thi",
                                "edited"
                            )
                        );
                        ClearCollect(
                            tmpQLCTTBCollect,
                            ShowColumns(
                                SortByColumns(
                                    DL_SAN_PHAM_QLCT_CHONS,
                                    "cr282_ma_ql_chitiet",
                                    SortOrder.Ascending
                                ),
                                "cr282_ma_ql_chitiet",
                                "cr282_ma_nhomql_sp",
                                "cr282_ten_hien_thi"
                            )
                        );
                        UpdateContext({
                            maAddedNQLSP:"",
                            maUpdatedNQLSP:"",
                            loaiFilterQLCTTB:1,
                            loaiFilterNQLSP:1
                        });
                        Reset(TextFilterNQLSP); Reset(CbxFilterNQLSP);Reset(CbxFilterValueNQLSP1);Reset(CbxFilterValueNQLSP)
                    Tooltip: ="Tải lại"
                    Width: =32
                    X: =40
                    Y: =44
                    ZIndex: =8

                IconThemNQLSP As icon.AddDocument:
                    Color: =RGBA(72, 163, 62, 1)
                    DisplayMode: =If(And(maAddedNQLSP="",maUpdatedNQLSP=""), DisplayMode.Edit,DisplayMode.Disabled)
                    Height: =42
                    Icon: =Icon.AddDocument
                    OnSelect: |
                        =If(
                            Or(maAddedNQLSP<>"",maUpdatedNQLSP<>""),
                            Notify("Có dữ liệu chưa được lưu",NotificationType.Warning,800),
                            UpdateContext({
                                idMaNQLSP:If(
                                    CountIf(DL_SAN_PHAM_NHOMQLS,MA_SP="1000")=0,
                                    1000,
                                    Value(Last(SortByColumns(Filter(DL_SAN_PHAM_NHOMQLS,MA_SP="1000"),"cr282_ma_dl",SortOrder.Ascending)).MA_DL)+1
                                )
                            });
                            Collect(
                                tmpNQLSPCollect,
                                {
                                    cr282_ma_dl:Text(idMaNQLSP),
                                    cr282_chuongtrinh_apdung:Blank(),
                                    cr282_loai:Blank(),
                                    cr282_ma_nhom_ql:Blank(),
                                    cr282_ma_nhom_tinhphi:Blank(),
                                    cr282_ma_sp:"1000",
                                    cr282_phamvi_dialy:Blank(),
                                    cr282_ten_hien_thi:Blank(),
                                    edited:1
                                }
                            );
                            UpdateContext({maAddedNQLSP:Text(idMaNQLSP)})
                        )
                    Tooltip: ="Thêm mới"
                    Width: =40
                    X: =91
                    Y: =40
                    ZIndex: =9

                IconFilterNQLSP As icon.FilterFlat:
                    Color: =RGBA(71, 158, 245, 1)
                    DisplayMode: =If(Or(maAddedNQL<>"",maUpdatedNQL<>""),DisplayMode.Disabled,DisplayMode.Edit)
                    Height: =47
                    Icon: =Icon.FilterFlat
                    OnSelect: |-
                        =ClearCollect(
                            tmpNQLLHNVCollect,
                            ShowColumns(
                                AddColumns(
                                    SortByColumns(
                                        Filter(
                                            DM_NHOMQL_LHNVS,
                                            Or(
                                                And(
                                                    TextFilterNQLSP.Value="",
                                                    loaiFilterNQL=0
                                                ),
                                                And(
                                                    IsBlank(CbxFilterValueNQLSP1.Selected.MA_NHOM_QL),
                                                    loaiFilterNQL=1
                                                ),
                                                And(
                                                    IsBlank(CbxFilterValueNQLSP.Selected.Value),
                                                    loaiFilterNQL=2
                                                ),
                                                And(
                                                    CbxFilterNQLSP.Selected.Value="Mã dữ liệu",
                                                    StartsWith(MA_NHOMQL_LHNV,TextFilterNQLSP.Value)
                                                ),
                                                And(
                                                    CbxFilterNQLSP.Selected.Value="Nhóm quyền lợi",
                                                    MA_NHOM_QL=CbxFilterValueNQLSP1.Selected.MA_NHOM_QL
                                                ),
                                                And(
                                                    CbxFilterNQLSP.Selected.Value="Loại hình nghiệp vụ",
                                                    !IsBlank(Find(CbxFilterValueNQLSP.Selected.Value,LHNV))
                                                )
                                            )
                                        ),
                                        "cr282_ma_nhomql_lhnv",
                                        SortOrder.Ascending
                                    ),
                                    "edited",
                                    0
                                ),
                                "cr282_ma_nhomql_lhnv",
                                "cr282_ma_nhom_ql",
                                "cr282_lhnv",
                                "cr282_hieu_luc_tu",
                                "cr282_hieu_luc_den",
                                "edited"
                            )
                        );
                    Tooltip: ="Lọc"
                    Visible: =false
                    Width: =32
                    X: =724
                    Y: =33
                    ZIndex: =10

                CbxFilterNQLSP As Combobox.pcfdataset:
                    DefaultSelectedItems: =Filter(["Mã dữ liệu", "Nhóm quyền lợi","Loại hình nghiệp vụ"],Value="Mã dữ liệu")
                    DisplayMode: =DisplayMode.Edit
                    Height: =43
                    InputTextPlaceholder: ="Chọn chỉ tiêu lọc"
                    Items: =["Mã dữ liệu", "Nhóm quyền lợi","Loại hình nghiệp vụ"]
                    OnChange: |-
                        =If(
                            CbxFilterNQLSP.Selected.Value="Mã dữ liệu",
                            UpdateContext({loaiFilterNQL:0}),
                            CbxFilterNQLSP.Selected.Value="Nhóm quyền lợi",
                            UpdateContext({loaiFilterNQL:1}),
                            UpdateContext({loaiFilterNQL:2})
                        );
                        Reset(TextFilterNQLSP);Reset(CbxFilterValueNQLSP1);Reset(CbxFilterValueNQLSP);
                    Visible: =false
                    Width: =152
                    X: =348
                    Y: =35
                    ZIndex: =11

                CbxFilterValueNQLSP1 As Combobox.pcfdataset:
                    DisplayMode: =DisplayMode.Edit
                    Height: =43
                    InputTextPlaceholder: |+
                        ="Chọn nhóm quyền lợi"
                        
                        
                    Items: |+
                        =SortByColumns(DM_NHOM_QUYENLOIS,"cr282_ma_nhom_ql",SortOrder.Ascending)
                        
                    Visible: =false
                    Width: =204
                    X: =509
                    Y: =35
                    ZIndex: =13

                    MA_NHOM_QL1_6 As pcfDataField.textualColumn:
                        FieldDisplayName: ="MA_NHOM_QL"
                        FieldName: ="cr282_ma_nhom_ql"
                        FieldType: ="s"
                        FieldVariantName: ="textualColumn"
                        Order: =2
                        ZIndex: =20

                    TEN_NHOM_QL1_6 As pcfDataField.textualColumn:
                        FieldDisplayName: ="TEN_NHOM_QL"
                        FieldName: ="cr282_ten_nhom_ql"
                        FieldType: ="s"
                        FieldVariantName: ="textualColumn"
                        Order: =1
                        ZIndex: =21

                    GHI_CHU1_6 As pcfDataField.textualColumn:
                        FieldDisplayName: ="GHI_CHU"
                        FieldName: ="cr282_ghi_chu"
                        FieldType: ="s"
                        FieldVariantName: ="textualColumn"
                        Order: =3
                        ZIndex: =22

                TextCanvas1_5 As Text:
                    DisplayMode: =DisplayMode.Edit
                    FontColor: =
                    Height: =29
                    Size: =16
                    Text: ="Danh mục nhóm quyền lợi"
                    Weight: ='TextCanvas.Weight'.Bold
                    Width: =451
                    X: =17
                    Y: =4
                    ZIndex: =14

                TextCanvas2_60 As Text:
                    DisplayMode: =DisplayMode.Edit
                    FontColor: =
                    Height: =37
                    Size: =14
                    Text: ="Nhóm tính phí"
                    Weight: ='TextCanvas.Weight'.Bold
                    Width: =109
                    X: =593
                    Y: =98
                    ZIndex: =15

                CbxFilterValueNQLSP As Combobox.pcfdataset:
                    DisplayMode: =DisplayMode.Edit
                    Height: =43
                    InputTextPlaceholder: |+
                        ="Chọn loại hình nghiệp vụ"
                        
                        
                    Items: |+
                        =["Sức khỏe","Tai nạn","Trách nhiệm dân sự"]
                        
                    Visible: =false
                    Width: =204
                    X: =510
                    Y: =35
                    ZIndex: =16

                    Value2_1 As pcfDataField.textualColumn:
                        FieldDisplayName: ="Value"
                        FieldName: ="Value"
                        FieldType: ="s"
                        FieldVariantName: ="textualColumn"
                        Order: =1
                        ZIndex: =24

                TextCanvas2_59 As Text:
                    DisplayMode: =DisplayMode.Edit
                    FontColor: =
                    Height: =38
                    Size: =14
                    Text: ="Loại"
                    Weight: ='TextCanvas.Weight'.Bold
                    Width: =44
                    X: =207
                    Y: =98
                    ZIndex: =17

                TextCanvas2_66 As Text:
                    DisplayMode: =DisplayMode.Edit
                    FontColor: =
                    Height: =37
                    Size: =14
                    Text: ="Phạm vi địa lý"
                    Weight: ='TextCanvas.Weight'.Bold
                    Width: =109
                    X: =782
                    Y: =97
                    ZIndex: =18

            ContainerQLCTTB As groupContainer.manualLayoutContainer:
                Height: =563
                Width: =1288
                X: =78
                Y: =408
                ZIndex: =2

                GalleryYTAH_1 As gallery.galleryVertical:
                    DelayItemLoading: =true
                    Height: =417
                    Items: =SortByColumns(tmpQLCTTBCollect,"cr282_ma_ql_chitiet",SortOrder.Ascending)
                    Layout: =Layout.Vertical
                    LoadingSpinner: =LoadingSpinner.Data
                    NavigationStep: =0
                    TemplateSize: =41
                    Width: =1273
                    X: =8
                    Y: =146
                    ZIndex: =1

                    TextTenYTAH_1 As text:
                        BorderColor: =RGBA(72, 163, 62, 1)
                        Default: =LookUp(DM_NHOM_QUYENLOIS,MA_NHOM_QL=LookUp(DM_QUYENLOI_CHITIETS,MA_QL_CHITIET=ThisItem.cr282_ma_ql_chitiet,MA_NHOM_QL),TEN_NHOM_QL)
                        DisabledBorderColor: =RGBA(180, 214, 250, 1)
                        DisabledColor: =RGBA(0, 0, 0, 1)
                        DisabledFill: =RGBA(255, 255, 255, 1)
                        DisplayMode: =DisplayMode.Disabled
                        OnChange: =
                        OnSelect: =Select(Parent)
                        Width: =265
                        X: =8
                        ZIndex: =9

                    TextTenYTAH_2 As text:
                        BorderColor: =RGBA(72, 163, 62, 1)
                        Default: =LookUp(DM_QUYENLOI_CHITIETS,MA_QL_CHITIET=ThisItem.cr282_ma_ql_chitiet,TEN_QL_CHITIET)
                        DisabledBorderColor: =RGBA(180, 214, 250, 1)
                        DisabledColor: =RGBA(0, 0, 0, 1)
                        DisabledFill: =RGBA(255, 255, 255, 1)
                        DisplayMode: =DisplayMode.Disabled
                        OnChange: =
                        OnSelect: =Select(Parent)
                        Width: =498
                        X: =280
                        ZIndex: =10

                    TextTenYTAH_3 As text:
                        BorderColor: =RGBA(72, 163, 62, 1)
                        Default: =ThisItem.cr282_ten_hien_thi
                        DisabledBorderColor: =RGBA(180, 214, 250, 1)
                        DisabledColor: =RGBA(0, 0, 0, 1)
                        DisabledFill: =RGBA(255, 255, 255, 1)
                        DisplayMode: =DisplayMode.Disabled
                        OnChange: =
                        OnSelect: =Select(Parent)
                        Width: =468
                        X: =784
                        ZIndex: =11

                BadgeCanvas1_14 As Badge:
                    BasePaletteColor: =
                    Content: =""
                    DisplayMode: =DisplayMode.Edit
                    FontColor: =
                    Height: =39
                    Width: =1249
                    X: =20
                    Y: =104
                    ZIndex: =2

                TextCanvas2_46 As Text:
                    DisplayMode: =DisplayMode.Edit
                    FontColor: =
                    Height: =38
                    Size: =14
                    Text: ="Nhóm quyền lợi"
                    Weight: ='TextCanvas.Weight'.Bold
                    Width: =123
                    X: =38
                    Y: =104
                    ZIndex: =3

                TextCanvas2_68 As Text:
                    DisplayMode: =DisplayMode.Edit
                    FontColor: =
                    Height: =38
                    Size: =14
                    Text: ="Tên quyền lợi"
                    Weight: ='TextCanvas.Weight'.Bold
                    Width: =128
                    X: =294
                    Y: =104
                    ZIndex: =5

                TextCanvas2_67 As Text:
                    DisplayMode: =DisplayMode.Edit
                    FontColor: =
                    Height: =38
                    Size: =14
                    Text: ="Tên hiển thị"
                    Weight: ='TextCanvas.Weight'.Bold
                    Width: =96
                    X: =803
                    Y: =104
                    ZIndex: =6

                TextCanvas1_4 As Text:
                    DisplayMode: =DisplayMode.Edit
                    FontColor: =
                    Height: =29
                    Size: =16
                    Text: ="Danh sách quyền lợi chi tiết"
                    Weight: ='TextCanvas.Weight'.Bold
                    Width: =451
                    X: =20
                    Y: =0
                    ZIndex: =14

                "TextFilterQLCTTB As 'Text input'":
                    BasePaletteColor: =
                    DisplayMode: =DisplayMode.Edit
                    FontColor: =
                    Height: =43
                    OnChange: =
                    Placeholder: ="Nhập giá trị lọc"
                    Visible: =loaiFilterQLCTTB=0
                    Width: =204
                    X: =556
                    Y: =40
                    ZIndex: =15

                IconFilterQLCTTB As icon.FilterFlat:
                    Color: =RGBA(71, 158, 245, 1)
                    Height: =47
                    Icon: =Icon.FilterFlat
                    OnSelect: |-
                        =ClearCollect(
                            tmpQLCTTBCollect,
                            ShowColumns(
                                SortByColumns(
                                    Filter(
                                        DL_SAN_PHAM_QLCT_CHONS,
                                        Or(
                                            And(
                                                TextFilterQLCTTB.Value="",
                                                loaiFilterQLCTTB=0
                                            ),
                                            And(
                                                IsBlank(CbxFilterValueQLCTTB.Selected.MA_NHOM_QL),
                                                loaiFilterQLCTTB=1
                                            ),
                                            And(
                                                CbxFilterQLCTTB.Selected.Value="Tên quyền lợi",
                                                MA_QL_CHITIET in Filter(DM_QUYENLOI_CHITIETS,!IsBlank(Find(TextFilterQLCTTB.Value,TEN_QL_CHITIET)),MA_QL_CHITIET)
                                            )
                                        )
                                    ),
                                    "cr282_ma_ql_chitiet",
                                    SortOrder.Ascending
                                ),
                                "cr282_ma_ql_chitiet",
                                "cr282_ma_nhomql_sp",
                                "cr282_ten_hien_thi"
                            )
                        )
                    Tooltip: ="Lọc"
                    Width: =32
                    X: =771
                    Y: =40
                    ZIndex: =16

                CbxFilterQLCTTB As Combobox.pcfdataset:
                    DefaultSelectedItems: =Filter(["Nhóm quyền lợi", "Tên quyền lợi"],Value="Nhóm quyền lợi")
                    DisplayMode: =DisplayMode.Edit
                    Height: =43
                    InputTextPlaceholder: ="Chọn chỉ tiêu lọc"
                    Items: =["Nhóm quyền lợi", "Tên quyền lợi"]
                    OnChange: |-
                        =If(
                            CbxFilterQLCTTB.Selected.Value="Nhóm quyền lợi",
                            UpdateContext({loaiFilterQLCTTB:1}),
                            UpdateContext({loaiFilterQLCTTB:0})
                        );
                        Reset(TextFilterQLCTTB);Reset(CbxFilterValueQLCTTB)
                    Width: =188
                    X: =358
                    Y: =40
                    ZIndex: =17

                CbxFilterValueQLCTTB As Combobox.pcfdataset:
                    DisplayMode: =DisplayMode.Edit
                    Height: =43
                    InputTextPlaceholder: ="Chọn nhóm quyền lợi"
                    Items: =SortByColumns(DM_NHOM_QUYENLOIS,"cr282_ma_nhom_ql",SortOrder.Ascending)
                    Visible: =loaiFilterQLCTTB=1
                    Width: =204
                    X: =556
                    Y: =40
                    ZIndex: =18

                    TEN_NHOM_QL2 As pcfDataField.textualColumn:
                        FieldDisplayName: ="TEN_NHOM_QL"
                        FieldName: ="cr282_ten_nhom_ql"
                        FieldType: ="s"
                        FieldVariantName: ="textualColumn"
                        Order: =1
                        ZIndex: =19

                    MA_NHOM_QL2 As pcfDataField.textualColumn:
                        FieldDisplayName: ="MA_NHOM_QL"
                        FieldName: ="cr282_ma_nhom_ql"
                        FieldType: ="s"
                        FieldVariantName: ="textualColumn"
                        Order: =2
                        ZIndex: =20

        DataCard8 As dataCard.blankCard:
            BorderColor: =RGBA(0, 0, 0, 1)
            BorderStyle: =BorderStyle.Solid
            DisplayMode: =DisplayMode.Edit
            Fill: =RGBA(0, 0, 0, 0)
            Height: =801
            Width: =1366
            X: =0
            Y: =6
            ZIndex: =7

            ContainerQLK As groupContainer.manualLayoutContainer:
                Height: =420
                Visible: =showConfirmQLK=0
                Width: =1288
                X: =78
                Y: =4
                ZIndex: =1

                GalleryQLK As gallery.galleryVertical:
                    DelayItemLoading: =true
                    Height: =281
                    Items: =SortByColumns(tmpQLKCollect,"cr282_ma_dl",SortOrder.Ascending)
                    Layout: =Layout.Vertical
                    LoadingSpinner: =LoadingSpinner.Data
                    NavigationStep: =0
                    TemplateSize: =52
                    Width: =1273
                    X: =5
                    Y: =139
                    ZIndex: =1

                    IconXoaQLK As icon.Trash:
                        Color: =RGBA(233, 79, 76, 1)
                        Height: =40
                        Icon: =Icon.Trash
                        OnSelect: |-
                            =UpdateContext({
                                showConfirmQLK:1,
                                maDeleteQLK:ThisItem.cr282_ma_dl,
                                objDeleteQLK:ThisItem
                            });
                        Tooltip: ="Xóa"
                        Visible: =ThisItem.edited=0
                        Width: =37
                        X: =1218
                        Y: =6
                        ZIndex: =7

                    IconSuaQLK As icon.Edit:
                        Color: =RGBA(83, 144, 164, 1)
                        Height: =40
                        Icon: =Icon.Edit
                        OnSelect: |-
                            =If(
                                Or(maAddedQLK<>"",maUpdatedQLK<>""),
                                Notify("Có dữ liệu chưa được lưu",NotificationType.Warning,800),
                                UpdateIf(
                                    tmpQLKCollect,
                                    cr282_ma_dl=ThisItem.cr282_ma_dl,
                                    {
                                        edited:1
                                    }
                                );
                                UpdateContext({
                                    maUpdatedQLK:ThisItem.cr282_ma_dl
                                })
                            )
                        Tooltip: ="Sửa"
                        Visible: =ThisItem.edited=0
                        Width: =29
                        X: =1189
                        Y: =6
                        ZIndex: =14

                    IconLuuQLK As icon.Save:
                        Color: =RGBA(72, 163, 62, 1)
                        Height: =40
                        Icon: =Icon.Save
                        OnSelect: |
                            =If(
                                IsBlank(CbxNhomQLQLK.Selected.MA_NHOM_QL),
                                Notify("Bắt buộc nhập nhóm quyền lợi", NotificationType.Error,800),
                                IsBlank(TextMoTaQLK.Text),
                                Notify("Bắt buộc nhập mô tả", NotificationType.Error,800),
                                !IsBlank(LookUp(DL_SAN_PHAM_QL_KHACS,MA_NHOM_QL=CbxNhomQLQLK.Selected.MA_NHOM_QL && MA_SP=ThisItem.cr282_ma_sp)),
                                Notify("Đã tồn tại dữ liệu gắn với nhóm quyền lợi này", NotificationType.Error,800),
                                If(
                                    ThisItem.cr282_ma_dl=maAddedQLK,
                                    Patch(
                                        DL_SAN_PHAM_QL_KHACS,
                                        {
                                            MA_DL:ThisItem.cr282_ma_dl,
                                            MA_NHOM_QL:CbxNhomQLQLK.Selected.MA_NHOM_QL,
                                            MA_SP:ThisItem.cr282_ma_sp,
                                            MO_TA:TextMoTaQLK.Text
                                        }
                                    ),
                                    UpdateIf(
                                        DL_SAN_PHAM_QL_KHACS,
                                        MA_DL=ThisItem.cr282_ma_dl,
                                        {
                                            MA_NHOM_QL:CbxNhomQLQLK.Selected.MA_NHOM_QL,
                                            MA_SP:ThisItem.cr282_ma_sp,
                                            MO_TA:TextMoTaQLK.Text
                                        }
                                    )
                                );
                                UpdateIf(
                                    tmpQLKCollect,
                                    cr282_ma_dl=ThisItem.cr282_ma_dl,
                                    {
                                        cr282_ma_dl:ThisItem.cr282_ma_dl,
                                        cr282_ma_nhom_ql:CbxNhomQLQLK.Selected.MA_NHOM_QL,
                                        cr282_ma_sp:ThisItem.cr282_ma_sp,
                                        cr282_mo_ta:TextMoTaQLK.Text,
                                        edited:0
                                    }
                                );
                                Notify("Lưu dữ liệu thành công", NotificationType.Success,800);
                                ClearCollect(
                                    tmpQLKCollect,
                                    ShowColumns(
                                        AddColumns(
                                            SortByColumns(
                                                DL_SAN_PHAM_QL_KHACS,
                                                "cr282_ma_dl",
                                                SortOrder.Ascending
                                            ),
                                            "edited",
                                            0
                                        ),
                                        "cr282_ma_dl",
                                        "cr282_ma_sp",
                                        "cr282_ma_nhom_ql",
                                        "cr282_mo_ta",
                                        "edited"
                                    )
                                );
                                UpdateContext({
                                    maAddedQLK:"",
                                    maUpdatedQLK:""
                                });
                                Reset(CbxFilterQLK); Reset(CbxFilterValueQLK)
                            )
                        Tooltip: ="Lưu"
                        Visible: =ThisItem.edited=1
                        Width: =33
                        X: =1187
                        Y: =6
                        ZIndex: =15

                    IconHuyQLK As icon.CancelBadge:
                        Color: =RGBA(139, 154, 159, 1)
                        Height: =40
                        Icon: =Icon.CancelBadge
                        OnSelect: |-
                            =If(
                                ThisItem.cr282_ma_dl=maAddedQLK,
                                Remove(tmpQLKCollect,ThisItem),
                                UpdateIf(
                                    tmpQLKCollect,
                                    cr282_ma_dl=ThisItem.cr282_ma_dl,
                                    {
                                        edited:0
                                    }
                                )
                            );
                            UpdateContext({
                                maAddedQLK:"",
                                maUpdatedQLK:""
                            });
                        Tooltip: ="Hủy"
                        Visible: =ThisItem.edited=1
                        Width: =28
                        X: =1223
                        Y: =6
                        ZIndex: =16

                    CbxNhomQLQLK As combobox:
                        BorderColor: =RGBA(72, 163, 62, 1)
                        ChevronBackground: =RGBA(255, 255, 255, 1)
                        ChevronDisabledBackground: =RGBA(180, 214, 250, 1)
                        ChevronDisabledFill: =RGBA(255, 255, 255, 1)
                        ChevronFill: =RGBA(72, 163, 62, 1)
                        ChevronHoverBackground: =RGBA(255, 255, 255, 1)
                        ChevronHoverFill: =RGBA(72, 163, 62, 1)
                        DefaultSelectedItems: =Filter(DM_NHOM_QUYENLOIS,MA_NHOM_QL=ThisItem.cr282_ma_nhom_ql)
                        DisabledBorderColor: =RGBA(180, 214, 250, 1)
                        DisabledColor: =RGBA(0, 0, 0, 1)
                        DisabledFill: =RGBA(255, 255, 255, 1)
                        DisplayFields: =["cr282_ten_nhom_ql"]
                        DisplayMode: =If(ThisItem.edited=0,DisplayMode.Disabled,DisplayMode.Edit) 
                        Height: =50
                        HoverBorderColor: =RGBA(9, 33, 98, 1)
                        HoverFill: =RGBA(180, 214, 250, 1)
                        InputTextPlaceholder: ="Chọn nhóm quyền lợi"
                        IsSearchable: =false
                        Items: =SortByColumns(DM_NHOM_QUYENLOIS,"cr282_ma_nhom_ql",SortOrder.Ascending)
                        OnSelect: =Select(Parent)
                        PressedColor: =RGBA(72, 163, 62, 1)
                        PressedFill: =RGBA(255, 255, 255, 1)
                        SearchFields: =["cr282_ten_nhom_ql"]
                        SearchItems: =[]
                        SelectionColor: =RGBA(0, 0, 0, 1)
                        SelectionFill: =RGBA(214, 221, 224, 1)
                        SelectMultiple: =false
                        Width: =272
                        X: =13
                        ZIndex: =22

                    TextMoTaQLK As text:
                        BorderColor: =RGBA(72, 163, 62, 1)
                        Default: =ThisItem.cr282_mo_ta
                        DisabledBorderColor: =RGBA(180, 214, 250, 1)
                        DisabledColor: =RGBA(0, 0, 0, 1)
                        DisabledFill: =RGBA(255, 255, 255, 1)
                        DisplayMode: =If(ThisItem.edited=0,DisplayMode.Disabled,DisplayMode.Edit) 
                        Height: =50
                        MaxLength: =500
                        Mode: =TextMode.MultiLine
                        OnChange: =
                        OnSelect: =Select(Parent)
                        Width: =885
                        X: =291
                        ZIndex: =23

                BadgeCanvas1_15 As Badge:
                    BasePaletteColor: =
                    Content: =""
                    DisplayMode: =DisplayMode.Edit
                    FontColor: =
                    Height: =39
                    Width: =1175
                    X: =17
                    Y: =97
                    ZIndex: =2

                TextCanvas2_69 As Text:
                    DisplayMode: =DisplayMode.Edit
                    FontColor: =
                    Height: =38
                    Size: =14
                    Text: ="Nhóm quyền lợi"
                    Weight: ='TextCanvas.Weight'.Bold
                    Width: =121
                    X: =40
                    Y: =97
                    ZIndex: =4

                TextCanvas2_70 As Text:
                    DisplayMode: =DisplayMode.Edit
                    FontColor: =
                    Height: =38
                    Size: =14
                    Text: ="Mô tả"
                    Weight: ='TextCanvas.Weight'.Bold
                    Width: =151
                    X: =305
                    Y: =97
                    ZIndex: =5

                IconTaiLaiQLK As icon.Sync:
                    Color: =RGBA(83, 144, 164, 1)
                    Height: =36
                    Icon: =Icon.Sync
                    OnSelect: |-
                        =ClearCollect(
                            tmpQLKCollect,
                            ShowColumns(
                                AddColumns(
                                    SortByColumns(
                                        DL_SAN_PHAM_QL_KHACS,
                                        "cr282_ma_dl",
                                        SortOrder.Ascending
                                    ),
                                    "edited",
                                    0
                                ),
                                "cr282_ma_dl",
                                "cr282_ma_sp",
                                "cr282_ma_nhom_ql",
                                "cr282_mo_ta",
                                "edited"
                            )
                        );
                        UpdateContext({
                            maAddedQLK:"",
                            maUpdatedQLK:"",
                            showConfirmQLK:0
                        });
                        Reset(CbxFilterQLK);Reset(CbxFilterValueQLK)
                    Tooltip: ="Tải lại"
                    Width: =32
                    X: =40
                    Y: =44
                    ZIndex: =8

                IconThemQLK As icon.AddDocument:
                    Color: =RGBA(72, 163, 62, 1)
                    DisplayMode: =If(And(maAddedQLK="",maUpdatedQLK=""), DisplayMode.Edit,DisplayMode.Disabled)
                    Height: =42
                    Icon: =Icon.AddDocument
                    OnSelect: |
                        =If(
                            Or(maAddedQLK<>"",maUpdatedQLK<>""),
                            Notify("Có dữ liệu chưa được lưu",NotificationType.Warning,800),
                            UpdateContext({
                                idMaQLK:If(
                                    CountIf(DL_SAN_PHAM_QL_KHACS,true)=0,
                                    1000,
                                    Value(Last(SortByColumns(DL_SAN_PHAM_QL_KHACS,"cr282_ma_dl",SortOrder.Ascending)).MA_DL)+1
                                )
                            });
                            Collect(
                                tmpQLKCollect,
                                {
                                    cr282_ma_dl:Text(idMaQLK),
                                    cr282_ma_sp:"1001",
                                    cr282_ma_nhom_ql:Blank(),
                                    cr282_mo_ta:Blank(),
                                    edited:1
                                }
                            );
                            UpdateContext({maAddedQLK:Text(idMaQLK)})
                        )
                    Tooltip: ="Thêm mới"
                    Width: =40
                    X: =91
                    Y: =40
                    ZIndex: =9

                IconFilterQLK As icon.FilterFlat:
                    Color: =RGBA(71, 158, 245, 1)
                    DisplayMode: =If(Or(maAddedQLK<>"",maUpdatedQLK<>""),DisplayMode.Disabled,DisplayMode.Edit)
                    Height: =47
                    Icon: =Icon.FilterFlat
                    OnSelect: |-
                        =ClearCollect(
                            tmpQLKCollect,
                            ShowColumns(
                                AddColumns(
                                    SortByColumns(
                                        Filter(
                                            DL_SAN_PHAM_QL_KHACS,
                                            Or(
                                                IsBlank(CbxFilterValueQLK.Selected.MA_NHOM_QL),
                                                MA_NHOM_QL=CbxFilterValueQLK.Selected.MA_NHOM_QL
                                            )
                                        ),
                                        "cr282_ma_dl",
                                        SortOrder.Ascending
                                    ),
                                    "edited",
                                    0
                                ),
                                "cr282_ma_dl",
                                "cr282_ma_sp",
                                "cr282_ma_nhom_ql",
                                "cr282_mo_ta",
                                "edited"
                            )
                        );
                    Tooltip: ="Lọc"
                    Width: =32
                    X: =724
                    Y: =37
                    ZIndex: =10

                CbxFilterQLK As Combobox.pcfdataset:
                    DefaultSelectedItems: =Filter(["Nhóm quyền lợi"],Value="Nhóm quyền lợi")
                    DisplayMode: =DisplayMode.Edit
                    Height: =43
                    InputTextPlaceholder: ="Chọn chỉ tiêu lọc"
                    Items: =["Nhóm quyền lợi"]
                    OnChange: =
                    Width: =152
                    X: =348
                    Y: =37
                    ZIndex: =11

                CbxFilterValueQLK As Combobox.pcfdataset:
                    DisplayMode: =DisplayMode.Edit
                    Height: =43
                    InputTextPlaceholder: |+
                        ="Chọn nhóm quyền lợi"
                        
                        
                    Items: |+
                        =SortByColumns(DM_NHOM_QUYENLOIS,"cr282_ma_nhom_ql",SortOrder.Ascending)
                        
                    Visible: =true
                    Width: =204
                    X: =509
                    Y: =37
                    ZIndex: =13

                    MA_NHOM_QL1_5 As pcfDataField.textualColumn:
                        FieldDisplayName: ="MA_NHOM_QL"
                        FieldName: ="cr282_ma_nhom_ql"
                        FieldType: ="s"
                        FieldVariantName: ="textualColumn"
                        Order: =2
                        ZIndex: =20

                    TEN_NHOM_QL1_5 As pcfDataField.textualColumn:
                        FieldDisplayName: ="TEN_NHOM_QL"
                        FieldName: ="cr282_ten_nhom_ql"
                        FieldType: ="s"
                        FieldVariantName: ="textualColumn"
                        Order: =1
                        ZIndex: =21

                    GHI_CHU1_5 As pcfDataField.textualColumn:
                        FieldDisplayName: ="GHI_CHU"
                        FieldName: ="cr282_ghi_chu"
                        FieldType: ="s"
                        FieldVariantName: ="textualColumn"
                        Order: =3
                        ZIndex: =22

                TextCanvas1_3 As Text:
                    DisplayMode: =DisplayMode.Edit
                    FontColor: =
                    Height: =29
                    Size: =16
                    Text: ="Thông tin quyền lợi khác"
                    Weight: ='TextCanvas.Weight'.Bold
                    Width: =451
                    X: =17
                    Y: =0
                    ZIndex: =14

                ContainerConfirmQLK As groupContainer.manualLayoutContainer:
                    BorderColor: =RGBA(180, 214, 250, 1)
                    BorderThickness: =2
                    Fill: =Color.White
                    Height: =205
                    Visible: =showConfirmQLK=1
                    Width: =438
                    X: =467
                    Y: =215
                    ZIndex: =15

                    TextCanvas1 As Text:
                        DisplayMode: =DisplayMode.Edit
                        FontColor: =
                        Height: =31
                        Size: =16
                        Text: ="Bạn có chắc chắn muốn xóa?"
                        Weight: ='TextCanvas.Weight'.Bold
                        Width: =233
                        X: =108
                        Y: =52
                        ZIndex: =1

                    OKCFQLK As icon.Check:
                        Color: =RGBA(72, 163, 62, 1)
                        Height: =46
                        Icon: =Icon.Check
                        OnSelect: |-
                            =UpdateContext({
                                showConfirmQLK:0
                            });
                            If(
                                Or(maAddedQLK<>"",maUpdatedQLK<>""),
                                Notify("Có dữ liệu chưa được lưu",NotificationType.Warning,800),
                                Refresh(DL_SAN_PHAM_QL_KHACS);
                                RemoveIf(
                                    DL_SAN_PHAM_QL_KHACS,
                                    MA_DL=maDeleteQLK
                                );
                                Remove(tmpQLKCollect,objDeleteQLK);
                                Notify("Xóa dữ liệu thành công", NotificationType.Success,800)
                            )
                        Tooltip: ="OK"
                        Width: =47
                        X: =128
                        Y: =105
                        ZIndex: =2

                    CancelCFQLK As icon.CancelBadge:
                        Color: =RGBA(233, 79, 76, 1)
                        Height: =46
                        Icon: =Icon.CancelBadge
                        OnSelect: |-
                            =UpdateContext({
                                showConfirmQLK:0,
                                maDeleteQLK:Blank(),
                                objDeleteQLK:Blank()
                            })
                        Tooltip: ="Hủy"
                        Width: =41
                        X: =261
                        Y: =105
                        ZIndex: =3

    LeftNavigation_20 As LeftNavigation_9:
        NavItems: |-
            =Table(
                {
                    Title: "Hệ thống",
                    Screen: App.ActiveScreen,
                    Icon: Icon.Home,
                    MenuID: 1,
                    Subtable: Table(
                        {
                       Title: "Danh mục phạm vi địa lý",
                       Screen: DMPhamViDiaLy,
                       Icon: Icon.Home, 
                       MenuID: 1.1
            
                        },
                        {
                       Title: "Danh mục nhóm quyền lợi",
                       Screen: DMNhomQuyenLoi,
                       Icon: Icon.Home, 
                       MenuID: 1.2
            
                        },
                          {
                       Title: "Danh mục quyền lợi chi tiết",
                       Screen: DMQuyenLoiChiTiet,
                       Icon: Icon.Home, 
                       MenuID: 1.3
            
                        },
                          {
                       Title: "Danh mục độ tuổi",
                       Screen: DMDoTuoi,
                       Icon: Icon.Home, 
                       MenuID: 1.4
            
                        }
            			,
                          {
                       Title: "Danh mục giới tính",
                       Screen: DMGioiTinh,
                       Icon: Icon.Home, 
                       MenuID: 1.5
                        }
            			,
                          {
                       Title: "Cấu hình tham số sản phẩm",
                       Screen: DMCauHinhThamSoSP,
                       Icon: Icon.Home, 
                       MenuID: 1.6
                        }
                    )
                }, {
                    Title: "Sản phẩm",
                    Screen: App.ActiveScreen,
                    Icon: Icon.Shop,
                    MenuID: 2,
                    Subtable: Table(
            		   {
                       Title: "Tra cứu sản phẩm",
                       Screen: TraCuuSP,
                       Icon: Icon.Home, 
                       MenuID: 2.2
                        },
                        {
                       Title: "Thêm mới sản phẩm",
                       Screen: ThemMoi,
                       Icon: Icon.Home, 
                       MenuID: 2.1
            
                        }
                    
                    )
                }
            )
        Width: =LeftNavigation_20.MenuWidth
        ZIndex: =4

