Tracuubaogia As screen:

    danhsachnhom As gallery.variableTemplateHeightGallery:
        BorderThickness: =1
        DelayItemLoading: =true
        Height: =512
        Items: =tempSPKH
        Layout: =Layout.Vertical
        LoadingSpinner: =LoadingSpinner.Data
        TemplateSize: =121
        Width: =1123
        X: =140
        Y: =255
        ZIndex: =2

        Label12 As label:
            FontWeight: =FontWeight.Bold
            Height: =31
            OnSelect: =Select(Parent)
            Size: =11
            Text: =LookUp(DL_SAN_PHAM, MA_SAN_PHAM = ThisItem.MA_SAN_PHAM).TEN_SAN_PHAM & " - " & ThisItem.TEN_CHUONG_TRINH
            Width: =403
            X: =30
            ZIndex: =1

        Gallery6 As gallery.variableTemplateHeightGallery:
            BorderColor: =RGBA(0, 0, 0, 1)
            DelayItemLoading: =true
            Height: =84
            Items: =Filter( tempCTKH, MA_CHUONG_TRINH = ThisItem.MA_CHUONG_TRINH)
            Layout: =Layout.Vertical
            LoadingSpinner: =LoadingSpinner.Data
            TemplateSize: =36
            Width: =1076
            X: =30
            Y: =31
            ZIndex: =3

            Label13 As label:
                BorderColor: =RGBA(0, 0, 0, 1)
                BorderThickness: =1
                Height: =35
                OnSelect: =Select(Parent)
                Size: =11
                Text: =ThisItem.cr282_loai
                ZIndex: =1

            Checkbox2_1 As checkbox:
                BorderColor: =RGBA(0, 0, 0, 1)
                CheckboxBorderColor: |-
                    =RGBA(0, 0, 0, 1
                    )
                CheckboxSize: =20
                Default: |
                    =
                    If(ThisItem.cr282_loai = "Chính", true, false)
                DisabledColor: =RGBA(0, 0, 0, 1)
                DisabledFill: =RGBA(255, 255, 255, 1)
                DisplayMode: |
                    =
                    
                    If(ThisItem.cr282_loai = "Chính", DisplayMode.Disabled, DisplayMode.Edit)
                Height: =31
                HoverBorderColor: |
                    =
                HoverColor: =RGBA(255, 255, 255, 1)
                OnSelect: =Select(Parent)
                PaddingLeft: =8
                PressedBorderColor: =
                PressedColor: =RGBA(0, 0, 0, 0)
                PressedFill: |
                    =
                Size: =11
                Text: =""
                Underline: =true
                Width: =30
                X: =1011
                Y: =4
                ZIndex: =3

            Label16 As label:
                BorderColor: =RGBA(0, 0, 0, 1)
                BorderThickness: =1
                Height: =35
                OnSelect: =Select(Parent)
                Text: |-
                    =/*Max(
                        Filter (
                            DL_CHUONGTRINH_QLCTS,
                            MA_SAN_PHAM = ThisItem.MA_SP &&
                            MA_CHUONG_TRINH = ThisItem.MA_CHUONG_TRINH &&
                            MA_NHOM_QL = ThisItem.MA_NHOM_QL
                         
                        ),
                        GH_SOTIEN_NAM
                    )
                    */
                    LookUp(DL_SAN_PHAM_NHOMQLS, MA_SP=ThisItem.cr282_ma_sp && LOAI = ThisItem.cr282_loai ).TEN_HIEN_THI
                Width: =299
                X: =150
                ZIndex: =5

            Label20 As label:
                Height: =36
                OnSelect: =Select(Parent)
                Text: =//ThisItem.MA_CHUONG_TRINH
                Visible: =false
                X: =484
                ZIndex: =6

            Label22 As label:
                BorderThickness: =1
                Height: =35
                OnSelect: =Select(Parent)
                Text: =
                X: =449
                ZIndex: =8

        Checkbox2 As checkbox:
            BorderColor: =RGBA(0, 0, 0, 1)
            CheckboxBorderColor: =RGBA(0, 0, 0, 1)
            CheckboxSize: =20
            Height: =31
            OnSelect: =Select(Parent)
            PaddingLeft: =8
            Size: =11
            Text: =""
            Width: =30
            ZIndex: =4

    ButtonCanvas2 As Button:
        DisplayMode: =DisplayMode.Edit
        Height: =32
        OnSelect: |
            =ClearCollect(
                tempCTKH,
                ""
            );
            ClearCollect(
                tempQL,
                ""
            );
            Set(
                ConcatenatedResult,
                ""
            );
            ClearCollect(
                tempSPKH,
                Filter(
                    ' DL_SAN_PHAM_CT',
                    MA_SAN_PHAM = "PVICARE"
                )
            );
            ForAll(
                tempSPKH As sp,
                Collect(
                    tempCTKH,
                    GroupBy(
                        AddColumns(
                            Filter(
                                DL_SAN_PHAM_NHOMQLS,
                                MA_SP = sp.MA_SAN_PHAM && !IsBlank(
                                    Find(
                                        sp.MA_CHUONG_TRINH,
                                        CHUONGTRINH_APDUNG
                                    )
                                )
                            ),
                            "MA_CHUONG_TRINH",
                            sp.MA_CHUONG_TRINH
                        ),
                        "MA_CHUONG_TRINH",
                        "cr282_loai",
                        "cr282_ma_sp",
                        "GROUP"
                    )
                );
                
            );
            ForAll(
                tempCTKH As ct,
                ForAll(
                    ct.GROUP As gr,
                    Collect(
                        tempQL,
                        AddColumns(
                            gr,
                            "SO_TIEN",
                            "0",
                            "MA_CHUONG_TRINH",
                            ct.MA_CHUONG_TRINH
                        )
                    )
                )
            );
        Text: |+
            ="Tra cứu dữ liệu"
            
            
        Width: =166
        X: =1097
        Y: =183
        ZIndex: =3

